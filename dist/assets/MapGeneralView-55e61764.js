import{B as K,s as _,v as I,N as J,r as O,o as m,c as f,a as e,i,b as n,t as d,j as U,F as S,q as Q,A,_ as W,u as X,g as Y,w as N,x as G,h as L,d as P,p as ee,e as oe}from"./index-11fdd849.js";import{a as te,P as T,f as x,F as $,M as ne,T as ae,O as se,V as re,I as le,t as ce,b as ie,S as D,c as q,d as Z,e as B}from"./icon_tree_cg-e7704d93.js";const de={key:0},ue={class:"font-bold"},pe={class:"font-bold"},me={class:"font-bold"},fe={class:"font-bold"},_e={class:"font-bold"},ve={class:"font-bold"},ge={class:"font-bold"},be={class:"font-bold"},ye={class:"font-bold"},we={class:"font-bold"},he={__name:"RenderGeoMap",setup(v,{expose:g}){const l=K(),b=_(null),u=_(null),a=_(null);let s=null;const p=new te({features:[]});function V(){p.clear();const c=l.coordinatesPolygon;y(c)}g({onlyPerimeter:V});function y(c){if(c&&c.length>0){const o=c.map(M=>x(M)),r=new q([o]),t=new $({geometry:r});t.setStyle(new D({stroke:new Z({color:"green",width:2}),fill:new B({color:"rgba(0, 255, 0, 0.1)"})})),p.addFeature(t)}}I(()=>{h()}),J(()=>l.geoDataNew,()=>{w(),h()});function w(){const c=l.geoDataNew.map(o=>{const r=new T(x([o.lon,o.lat])),t=new $(r);return t.setProperties({codigo:o.codigo,nombre_comun:o.nombre_comun,nombre_cientifico:o.nombre_cientifico,numero_placa:o.numero_placa,coordenadas:o.coordenadas,departamento:o.departamento,municipio:o.municipio,vereda:o.vereda,nombre_del_predio:o.nombre_del_predio,resultado:o.resultado}),t});p.clear(),p.addFeatures(c)}function h(){if(l.geoDataNew.length>0){s&&(s.setTarget(null),s=null),w(),l.calculatePerimeterCoordinates();const c=l.coordinatesPolygon;k(c,p)}}function k(c,o){s=new ne({target:b.value,layers:[new ae({source:new se({opacity:.8})})],view:new re({center:x([c[0][0],c[0][1]]),zoom:9,minZoom:7,maxZoom:30})}),s.getViewport().style.cursor="pointer";const r=new le({src:ce,scale:.4,anchor:[.5,1]}),t=new ie({source:o,style:new D({image:r})}),M=c.map(F=>x(F)),j=new q([M]),R=new $({geometry:j});R.setStyle(new D({stroke:new Z({color:"green",width:2}),fill:new B({color:"rgba(0, 255, 0, 0.1)"})})),o.addFeature(R),s.addLayer(t),s.on("pointermove",F=>{s.getView().setZoom(s.getView().getZoom());const z=s.getEventPixel(F.originalEvent),E=s.forEachFeatureAtPixel(z,H=>H);E&&E.getGeometry()instanceof T?(s.getViewport().style.cursor="pointer",a.value=E,u.value&&(u.value.style.display="block")):(s.getViewport().style.cursor="",u.value&&(u.value.style.display="none"))})}return(c,o)=>{const r=O("font-awesome-icon");return m(),f(S,null,[e("div",{class:"map-container",ref_key:"mapContainer",ref:b},null,512),e("div",{class:"info-container",ref_key:"infoContainer",ref:u},[a.value?(m(),f("div",de,[e("p",null,[e("span",ue,[i(r,{icon:["fas","fingerprint"]}),n(" Código especie:")]),n(" "+d(a.value.getProperties().codigo),1)]),e("p",null,[e("span",pe,[i(r,{icon:["fab","glide"]}),n(" Nombre común:")]),n(" "+d(a.value.getProperties().nombre_comun),1)]),e("p",null,[e("span",me,[i(r,{icon:["fas","signature"]}),n(" Nombre científico:")]),n(" "+d(a.value.getProperties().nombre_cientifico),1)]),e("p",null,[e("span",fe,[i(r,{icon:["fas","hashtag"]}),n(" Número de placa:")]),n(" "+d(a.value.getProperties().numero_placa),1)]),e("p",null,[e("span",_e,[i(r,{icon:["fas","location-crosshairs"]}),n(" Coordenadas:")]),n(" "+d(a.value.getProperties().coordenadas),1)]),e("p",null,[e("span",ve,[i(r,{icon:["fab","squarespace"]}),n(" Departamento:")]),n(" "+d(a.value.getProperties().departamento),1)]),e("p",null,[e("span",ge,[i(r,{icon:["fab","squarespace"]}),n(" Municipio:")]),n(" "+d(a.value.getProperties().municipio),1)]),e("p",null,[e("span",be,[i(r,{icon:["fab","squarespace"]}),n(" Vereda:")]),n(" "+d(a.value.getProperties().vereda),1)]),e("p",null,[e("span",ye,[i(r,{icon:["fas","location-dot"]}),n(" Nombre del predio:")]),n(" "+d(a.value.getProperties().nombre_del_predio),1)]),e("p",null,[e("span",we,[i(r,{icon:["fas","star"]}),n(" Puntaje evaluación:")]),n(" "+d(a.value.getProperties().resultado),1)])])):U("",!0)],512)],64)}}},Pe=Q("locatesColombia",()=>{const v=_([]),g=_({});return I(async()=>{try{const b=(await A.getDepartments()).data.filter(a=>a.name==="Putumayo"||a.name==="Caquetá");v.value=b;const u=await A.getCities();g.value=u.data}catch(l){console.error("Error al obtener datos: ",l)}}),{departments:v,cities:g}});const C=v=>(ee("data-v-93daf4c2"),v=v(),oe(),v),xe={class:"shadow-lg bg-gray-50 p-2 rounded-lg mb-2 mt-2"},Se=C(()=>e("div",{class:"text-center"},[e("h1",{class:"font-bold text-lg my-auto mb-3"},"MAPA GENERAL DE LAS ESPECIES FORESTALES")],-1)),Ce={class:"space-y-4 mb-5"},Ve={class:"block text-black uppercase font-bold",for:"parametro"},ke={class:"flex custom-select"},Me=C(()=>e("option",{value:{code:"",name:""},disabled:""},"Seleccione un departamento...",-1)),Fe=["value"],Ee={key:0},Ne=C(()=>e("option",{value:"",disabled:"",selected:""},"Seleccione un municipio...",-1)),Ge=["value"],Le=C(()=>e("option",{value:"",selected:"",disabled:""},"Seleccione una especie...",-1)),$e=["value"],De={__name:"MapGeneralView",setup(v){const g=Pe(),l=K(),b=X(),u=_(null),a=_(""),s=_({code:"",name:""}),p=_("");I(async()=>{await l.fetchData()});function V(){u.value&&u.value.onlyPerimeter&&u.value.onlyPerimeter()}const y=()=>{l.filterGeo(s.value.name,p.value,a.value),l.calculatePerimeterCoordinates(s.value.name,p.value,a.value)},w=Y(()=>s.value.code?g.cities.filter(o=>o.department_id===s.value.code):[]);function h(){a.value="",s.value={code:"",name:""},p.value=""}function k(){h(),l.deleteFilterGeo()}return(c,o)=>{const r=O("font-awesome-icon");return m(),f("div",xe,[Se,e("div",Ce,[e("label",Ve,[i(r,{icon:["fas","filter"],class:"mr-2 ml-2"}),n(" Filtrar especie ")]),e("div",ke,[N(e("select",{class:"text-lg p-3 w-full rounded-lg focus:outline-none flex-1",id:"department","onUpdate:modelValue":o[0]||(o[0]=t=>s.value=t),onChange:y},[Me,(m(!0),f(S,null,L(P(g).departments,t=>(m(),f("option",{key:t.id,value:{code:t.code,name:t.name}},d(t.name),9,Fe))),128))],544),[[G,s.value]]),w.value.length>0?(m(),f("div",Ee,[N(e("select",{class:"text-lg p-3 w-full rounded-lg focus:outline-none flex-1",id:"city","onUpdate:modelValue":o[1]||(o[1]=t=>p.value=t),onChange:y},[Ne,(m(!0),f(S,null,L(w.value,t=>(m(),f("option",{key:t.id,value:t.name},d(t.name),9,Ge))),128))],544),[[G,p.value]])])):U("",!0),N(e("select",{id:"especie",class:"text-lg p-3 w-full rounded-lg focus:outline-none flex-1",onChange:y,"onUpdate:modelValue":o[2]||(o[2]=t=>a.value=t)},[Le,(m(!0),f(S,null,L(P(b).uniqueNomComunes,t=>(m(),f("option",{key:t.cod_especie,value:t.cod_especie},d(t.nom_comunes+" | "+t.nombre_cientifico),9,$e))),128))],544),[[G,a.value]]),e("button",{type:"submit",class:"btn-form-search-header cursor-pointer font-bold rounded-lg pl-2 pr-2 ml-3",onClick:k},[i(r,{icon:["fas","filter-circle-xmark"],class:"mr-2"}),n(" Eliminar filtro")]),e("button",{type:"submit",class:"btn-form-search-header cursor-pointer font-bold rounded-lg pl-2 pr-2 ml-3",onClick:o[3]||(o[3]=t=>P(l).exportToKML(P(l).coordinatesKML))},[i(r,{icon:["fas","arrows-to-eye"],class:"mr-2"}),n(" Exportar KML/KMZ")]),e("button",{type:"submit",class:"btn-form-search-header cursor-pointer font-bold rounded-lg pl-2 pr-2 ml-3",onClick:V},[i(r,{icon:["fas","draw-polygon"],class:"mr-2"}),n(" Perímetro")])])]),i(he,{ref_key:"renderGeoMapRef",ref:u},null,512)])}}},Ae=W(De,[["__scopeId","data-v-93daf4c2"]]);export{Ae as default};
