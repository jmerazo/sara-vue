var Ve=Object.defineProperty;var $e=(i,t,e)=>t in i?Ve(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var ft=(i,t,e)=>($e(i,typeof t!="symbol"?t+"":t,e),e),re=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var I=(i,t,e)=>(re(i,t,"read from private field"),e?e.call(i):t.get(i)),at=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},bt=(i,t,e,s)=>(re(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e);var ae=(i,t,e,s)=>({set _(n){bt(i,t,n,e)},get _(){return I(i,t,s)}}),ht=(i,t,e)=>(re(i,t,"access private method"),e);import{z as getAugmentedNamespace,A as commonjsGlobal,B as defineStore,r as ref,C as APIService,_ as _export_sfc,v as resolveComponent,b as openBlock,c as createElementBlock,d as createBaseVNode,q as createVNode,k as createTextVNode,m as createCommentVNode,F as Fragment,p as pushScopeId,e as popScopeId,t as toDisplayString,i as renderList,D as shallowRef,o as onMounted,E as watch,l as unref,j as normalizeStyle,n as normalizeClass,a as useRouter,h as computed,w as withDirectives,G as vShow,y as createBlock}from"./index-58a73ee5.js";import{g as getFullImageUrl}from"./index-8422d5f6.js";import{c as commonjsRequire,u as useGeoCandidateTrees}from"./candidate-bb7863ad.js";import{u as useConsultaStore}from"./consulta-e9495bee.js";import"./modal-07ceaae3.js";import{V as VectorSource,G as GeoJSON,a as VectorLayer,S as Style,b as Stroke,F as Fill,I as Icon,t as treeIconPath,c as treePalmIconGreenPath,d as treeIconGBIFPath,e as treePalmIconPinkPath,M as Map$1,T as TileLayer,O as OSM,f as View,g as fromLonLat,P as Point,h as Feature}from"./icon_tree_palm_pink-32875086.js";import{L as LoadingData}from"./LoadingData-b11b812f.js";import"./calendarMonitoring-65f3789f.js";import"./jspdf.plugin.autotable-7b5e9f4b.js";/* empty css                                                                    */var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(t,e){module.exports=e()})(globalThis,()=>(()=>{var __webpack_modules__=[,(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.UNSUPPORTED_FEATURES=t.TextRenderingMode=t.StreamType=t.RenderingIntentFlag=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FontType=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.AnnotationType=t.AnnotationStateModelType=t.AnnotationReviewState=t.AnnotationReplyType=t.AnnotationMode=t.AnnotationMarkedState=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.arrayByteLength=nt,t.arraysToBytes=dt,t.assert=E,t.bytesToString=L,t.createPromiseCapability=gt,t.createValidAbsoluteUrl=O,t.escapeString=kt,t.getModificationDate=rt,t.getVerbosityLevel=it,t.info=lt,t.isArrayBuffer=Ft,t.isArrayEqual=Zt,t.isAscii=Dt,t.objectFromMap=st,t.objectSize=ot,t.setVerbosityLevel=X,t.shadow=N,t.string32=et,t.stringToBytes=V,t.stringToPDFString=wt,t.stringToUTF16BEString=Rt,t.stringToUTF8String=$t,t.unreachable=z,t.utf8StringToString=Pt,t.warn=_t,e(2);const s=[1,0,0,1,0,0];t.IDENTITY_MATRIX=s;const n=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=n;const r=1.35;t.LINE_FACTOR=r;const a=.35;t.LINE_DESCENT_FACTOR=a;const o={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=o;const l={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=l;const c="pdfjs_internal_editor_";t.AnnotationEditorPrefix=c;const p={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};t.AnnotationEditorType=p;const m={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};t.AnnotationEditorParamsType=m;const _={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=_;const y={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=y;const b={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=b;const u={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=u;const g={MARKED:"Marked",REVIEW:"Review"};t.AnnotationStateModelType=g;const x={MARKED:"Marked",UNMARKED:"Unmarked"};t.AnnotationMarkedState=x;const P={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};t.AnnotationReviewState=P;const A={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=A;const h={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=h;const d={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=d;const f={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=f;const v={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=v;const w={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=w;const C={O:"PageOpen",C:"PageClose"};t.PageActionEventType=C;const k={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};t.StreamType=k;const R={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};t.FontType=R;const H={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=H;const Z={NONE:0,BINARY:1,STREAM:2};t.CMapCompressionType=Z;const K={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=K;const q={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};t.UNSUPPORTED_FEATURES=q;const W={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=W;let $=H.WARNINGS;function X(tt){Number.isInteger(tt)&&($=tt)}function it(){return $}function lt(tt){$>=H.INFOS&&console.log(`Info: ${tt}`)}function _t(tt){$>=H.WARNINGS&&console.log(`Warning: ${tt}`)}function z(tt){throw new Error(tt)}function E(tt,G){tt||z(G)}function T(tt){if(!tt)return!1;switch(tt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function O(tt,G=null,Y=null){if(!tt)return null;try{if(Y&&typeof tt=="string"){if(Y.addDefaultProtocol&&tt.startsWith("www.")){const yt=tt.match(/\./g);yt&&yt.length>=2&&(tt=`http://${tt}`)}if(Y.tryConvertEncoding)try{tt=$t(tt)}catch{}}const mt=G?new URL(tt,G):new URL(tt);if(T(mt))return mt}catch{}return null}function N(tt,G,Y){return Object.defineProperty(tt,G,{value:Y,enumerable:!0,configurable:!0,writable:!1}),Y}const j=function(){function G(Y,mt){this.constructor===G&&z("Cannot initialize BaseException."),this.message=Y,this.name=mt}return G.prototype=new Error,G.constructor=G,G}();t.BaseException=j;class U extends j{constructor(G,Y){super(G,"PasswordException"),this.code=Y}}t.PasswordException=U;class J extends j{constructor(G,Y){super(G,"UnknownErrorException"),this.details=Y}}t.UnknownErrorException=J;class Q extends j{constructor(G){super(G,"InvalidPDFException")}}t.InvalidPDFException=Q;class S extends j{constructor(G){super(G,"MissingPDFException")}}t.MissingPDFException=S;class M extends j{constructor(G,Y){super(G,"UnexpectedResponseException"),this.status=Y}}t.UnexpectedResponseException=M;class D extends j{constructor(G){super(G,"FormatError")}}t.FormatError=D;class F extends j{constructor(G){super(G,"AbortException")}}t.AbortException=F;function L(tt){(typeof tt!="object"||tt===null||tt.length===void 0)&&z("Invalid argument for bytesToString");const G=tt.length,Y=8192;if(G<Y)return String.fromCharCode.apply(null,tt);const mt=[];for(let yt=0;yt<G;yt+=Y){const vt=Math.min(yt+Y,G),St=tt.subarray(yt,vt);mt.push(String.fromCharCode.apply(null,St))}return mt.join("")}function V(tt){typeof tt!="string"&&z("Invalid argument for stringToBytes");const G=tt.length,Y=new Uint8Array(G);for(let mt=0;mt<G;++mt)Y[mt]=tt.charCodeAt(mt)&255;return Y}function nt(tt){if(tt.length!==void 0)return tt.length;if(tt.byteLength!==void 0)return tt.byteLength;z("Invalid argument for arrayByteLength")}function dt(tt){const G=tt.length;if(G===1&&tt[0]instanceof Uint8Array)return tt[0];let Y=0;for(let vt=0;vt<G;vt++)Y+=nt(tt[vt]);let mt=0;const yt=new Uint8Array(Y);for(let vt=0;vt<G;vt++){let St=tt[vt];St instanceof Uint8Array||(typeof St=="string"?St=V(St):St=new Uint8Array(St));const Tt=St.byteLength;yt.set(St,mt),mt+=Tt}return yt}function et(tt){return String.fromCharCode(tt>>24&255,tt>>16&255,tt>>8&255,tt&255)}function ot(tt){return Object.keys(tt).length}function st(tt){const G=Object.create(null);for(const[Y,mt]of tt)G[Y]=mt;return G}function ct(){const tt=new Uint8Array(4);return tt[0]=1,new Uint32Array(tt.buffer,0,1)[0]===1}function pt(){try{return new Function(""),!0}catch{return!1}}class B{static get isLittleEndian(){return N(this,"isLittleEndian",ct())}static get isEvalSupported(){return N(this,"isEvalSupported",pt())}static get isOffscreenCanvasSupported(){return N(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}t.FeatureTest=B;const ut=[...Array(256).keys()].map(tt=>tt.toString(16).padStart(2,"0"));class xt{static makeHexColor(G,Y,mt){return`#${ut[G]}${ut[Y]}${ut[mt]}`}static scaleMinMax(G,Y){let mt;G[0]?(G[0]<0&&(mt=Y[0],Y[0]=Y[1],Y[1]=mt),Y[0]*=G[0],Y[1]*=G[0],G[3]<0&&(mt=Y[2],Y[2]=Y[3],Y[3]=mt),Y[2]*=G[3],Y[3]*=G[3]):(mt=Y[0],Y[0]=Y[2],Y[2]=mt,mt=Y[1],Y[1]=Y[3],Y[3]=mt,G[1]<0&&(mt=Y[2],Y[2]=Y[3],Y[3]=mt),Y[2]*=G[1],Y[3]*=G[1],G[2]<0&&(mt=Y[0],Y[0]=Y[1],Y[1]=mt),Y[0]*=G[2],Y[1]*=G[2]),Y[0]+=G[4],Y[1]+=G[4],Y[2]+=G[5],Y[3]+=G[5]}static transform(G,Y){return[G[0]*Y[0]+G[2]*Y[1],G[1]*Y[0]+G[3]*Y[1],G[0]*Y[2]+G[2]*Y[3],G[1]*Y[2]+G[3]*Y[3],G[0]*Y[4]+G[2]*Y[5]+G[4],G[1]*Y[4]+G[3]*Y[5]+G[5]]}static applyTransform(G,Y){const mt=G[0]*Y[0]+G[1]*Y[2]+Y[4],yt=G[0]*Y[1]+G[1]*Y[3]+Y[5];return[mt,yt]}static applyInverseTransform(G,Y){const mt=Y[0]*Y[3]-Y[1]*Y[2],yt=(G[0]*Y[3]-G[1]*Y[2]+Y[2]*Y[5]-Y[4]*Y[3])/mt,vt=(-G[0]*Y[1]+G[1]*Y[0]+Y[4]*Y[1]-Y[5]*Y[0])/mt;return[yt,vt]}static getAxialAlignedBoundingBox(G,Y){const mt=xt.applyTransform(G,Y),yt=xt.applyTransform(G.slice(2,4),Y),vt=xt.applyTransform([G[0],G[3]],Y),St=xt.applyTransform([G[2],G[1]],Y);return[Math.min(mt[0],yt[0],vt[0],St[0]),Math.min(mt[1],yt[1],vt[1],St[1]),Math.max(mt[0],yt[0],vt[0],St[0]),Math.max(mt[1],yt[1],vt[1],St[1])]}static inverseTransform(G){const Y=G[0]*G[3]-G[1]*G[2];return[G[3]/Y,-G[1]/Y,-G[2]/Y,G[0]/Y,(G[2]*G[5]-G[4]*G[3])/Y,(G[4]*G[1]-G[5]*G[0])/Y]}static apply3dTransform(G,Y){return[G[0]*Y[0]+G[1]*Y[1]+G[2]*Y[2],G[3]*Y[0]+G[4]*Y[1]+G[5]*Y[2],G[6]*Y[0]+G[7]*Y[1]+G[8]*Y[2]]}static singularValueDecompose2dScale(G){const Y=[G[0],G[2],G[1],G[3]],mt=G[0]*Y[0]+G[1]*Y[2],yt=G[0]*Y[1]+G[1]*Y[3],vt=G[2]*Y[0]+G[3]*Y[2],St=G[2]*Y[1]+G[3]*Y[3],Tt=(mt+St)/2,Ot=Math.sqrt((mt+St)**2-4*(mt*St-vt*yt))/2,Mt=Tt+Ot||1,Ct=Tt-Ot||1;return[Math.sqrt(Mt),Math.sqrt(Ct)]}static normalizeRect(G){const Y=G.slice(0);return G[0]>G[2]&&(Y[0]=G[2],Y[2]=G[0]),G[1]>G[3]&&(Y[1]=G[3],Y[3]=G[1]),Y}static intersect(G,Y){const mt=Math.max(Math.min(G[0],G[2]),Math.min(Y[0],Y[2])),yt=Math.min(Math.max(G[0],G[2]),Math.max(Y[0],Y[2]));if(mt>yt)return null;const vt=Math.max(Math.min(G[1],G[3]),Math.min(Y[1],Y[3])),St=Math.min(Math.max(G[1],G[3]),Math.max(Y[1],Y[3]));return vt>St?null:[mt,vt,yt,St]}static bezierBoundingBox(G,Y,mt,yt,vt,St,Tt,Ot){const Mt=[],Ct=[[],[]];let Lt,It,jt,Et,Nt,zt,qt,Gt;for(let Xt=0;Xt<2;++Xt){if(Xt===0?(It=6*G-12*mt+6*vt,Lt=-3*G+9*mt-9*vt+3*Tt,jt=3*mt-3*G):(It=6*Y-12*yt+6*St,Lt=-3*Y+9*yt-9*St+3*Ot,jt=3*yt-3*Y),Math.abs(Lt)<1e-12){if(Math.abs(It)<1e-12)continue;Et=-jt/It,0<Et&&Et<1&&Mt.push(Et);continue}qt=It*It-4*jt*Lt,Gt=Math.sqrt(qt),!(qt<0)&&(Nt=(-It+Gt)/(2*Lt),0<Nt&&Nt<1&&Mt.push(Nt),zt=(-It-Gt)/(2*Lt),0<zt&&zt<1&&Mt.push(zt))}let Ht=Mt.length,Bt;const Ut=Ht;for(;Ht--;)Et=Mt[Ht],Bt=1-Et,Ct[0][Ht]=Bt*Bt*Bt*G+3*Bt*Bt*Et*mt+3*Bt*Et*Et*vt+Et*Et*Et*Tt,Ct[1][Ht]=Bt*Bt*Bt*Y+3*Bt*Bt*Et*yt+3*Bt*Et*Et*St+Et*Et*Et*Ot;return Ct[0][Ut]=G,Ct[1][Ut]=Y,Ct[0][Ut+1]=Tt,Ct[1][Ut+1]=Ot,Ct[0].length=Ct[1].length=Ut+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}t.Util=xt;const At=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function wt(tt){if(tt[0]>="ï"){let Y;if(tt[0]==="þ"&&tt[1]==="ÿ"?Y="utf-16be":tt[0]==="ÿ"&&tt[1]==="þ"?Y="utf-16le":tt[0]==="ï"&&tt[1]==="»"&&tt[2]==="¿"&&(Y="utf-8"),Y)try{const mt=new TextDecoder(Y,{fatal:!0}),yt=V(tt);return mt.decode(yt)}catch(mt){_t(`stringToPDFString: "${mt}".`)}}const G=[];for(let Y=0,mt=tt.length;Y<mt;Y++){const yt=At[tt.charCodeAt(Y)];G.push(yt?String.fromCharCode(yt):tt.charAt(Y))}return G.join("")}function kt(tt){return tt.replace(/([()\\\n\r])/g,G=>G===`
`?"\\n":G==="\r"?"\\r":`\\${G}`)}function Dt(tt){return/^[\x00-\x7F]*$/.test(tt)}function Rt(tt){const G=["þÿ"];for(let Y=0,mt=tt.length;Y<mt;Y++){const yt=tt.charCodeAt(Y);G.push(String.fromCharCode(yt>>8&255),String.fromCharCode(yt&255))}return G.join("")}function $t(tt){return decodeURIComponent(escape(tt))}function Pt(tt){return unescape(encodeURIComponent(tt))}function Ft(tt){return typeof tt=="object"&&tt!==null&&tt.byteLength!==void 0}function Zt(tt,G){if(tt.length!==G.length)return!1;for(let Y=0,mt=tt.length;Y<mt;Y++)if(tt[Y]!==G[Y])return!1;return!0}function rt(tt=new Date){return[tt.getUTCFullYear().toString(),(tt.getUTCMonth()+1).toString().padStart(2,"0"),tt.getUTCDate().toString().padStart(2,"0"),tt.getUTCHours().toString().padStart(2,"0"),tt.getUTCMinutes().toString().padStart(2,"0"),tt.getUTCSeconds().toString().padStart(2,"0")].join("")}function gt(){const tt=Object.create(null);let G=!1;return Object.defineProperty(tt,"settled",{get(){return G}}),tt.promise=new Promise(function(Y,mt){tt.resolve=function(yt){G=!0,Y(yt)},tt.reject=function(yt){G=!0,mt(yt)}}),tt}},(i,t,e)=>{e(3)},(i,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeJS=void 0;const e=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=e},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var i,e,s,n,r,a,o,l,c,oe,m,_;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:b,NodeCMapReaderFactory:u,NodeStandardFontDataFactory:g}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=b,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=u,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=g}let createPDFNetworkStream;function setPDFNetworkStreamFactory(b){createPDFNetworkStream=b}function getDocument(b){const u=new PDFDocumentLoadingTask;let g;if(typeof b=="string"||b instanceof URL)g={url:b};else if((0,_util.isArrayBuffer)(b))g={data:b};else if(b instanceof PDFDataRangeTransport)g={range:b};else{if(typeof b!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!b.url&&!b.data&&!b.range)throw new Error("Invalid parameter object: need either .data, .range or .url");g=b}const x=Object.create(null);let P=null,A=null;for(const d in g){const f=g[d];switch(d){case"url":if(typeof window<"u")try{x[d]=new URL(f,window.location).href;continue}catch(v){(0,_util.warn)(`Cannot create valid URL: "${v}".`)}else if(typeof f=="string"||f instanceof URL){x[d]=f.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":P=f;continue;case"worker":A=f;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&f instanceof Buffer)x[d]=new Uint8Array(f);else{if(f instanceof Uint8Array)break;if(typeof f=="string")x[d]=(0,_util.stringToBytes)(f);else if(typeof f=="object"&&f!==null&&!isNaN(f.length))x[d]=new Uint8Array(f);else if((0,_util.isArrayBuffer)(f))x[d]=new Uint8Array(f);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}x[d]=f}if(x.CMapReaderFactory=x.CMapReaderFactory||DefaultCMapReaderFactory,x.StandardFontDataFactory=x.StandardFontDataFactory||DefaultStandardFontDataFactory,x.ignoreErrors=x.stopAtErrors!==!0,x.fontExtraProperties=x.fontExtraProperties===!0,x.pdfBug=x.pdfBug===!0,x.enableXfa=x.enableXfa===!0,(!Number.isInteger(x.rangeChunkSize)||x.rangeChunkSize<1)&&(x.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof x.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(x.docBaseUrl))&&(x.docBaseUrl=null),(!Number.isInteger(x.maxImageSize)||x.maxImageSize<-1)&&(x.maxImageSize=-1),typeof x.cMapUrl!="string"&&(x.cMapUrl=null),typeof x.standardFontDataUrl!="string"&&(x.standardFontDataUrl=null),typeof x.useWorkerFetch!="boolean"&&(x.useWorkerFetch=x.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&x.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof x.isEvalSupported!="boolean"&&(x.isEvalSupported=!0),typeof x.disableFontFace!="boolean"&&(x.disableFontFace=_is_node.isNodeJS),typeof x.useSystemFonts!="boolean"&&(x.useSystemFonts=!_is_node.isNodeJS&&!x.disableFontFace),(typeof x.ownerDocument!="object"||x.ownerDocument===null)&&(x.ownerDocument=globalThis.document),typeof x.disableRange!="boolean"&&(x.disableRange=!1),typeof x.disableStream!="boolean"&&(x.disableStream=!1),typeof x.disableAutoFetch!="boolean"&&(x.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(x.verbosity),!A){const d={verbosity:x.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};A=d.port?PDFWorker.fromPort(d):new PDFWorker(d),u._worker=A}const h=u.docId;return A.promise.then(function(){if(u.destroyed)throw new Error("Loading aborted");const d=_fetchDocument(A,x,P,h),f=new Promise(function(v){let w;P?w=new _transport_stream.PDFDataTransportStream({length:x.length,initialData:x.initialData,progressiveDone:x.progressiveDone,contentDispositionFilename:x.contentDispositionFilename,disableRange:x.disableRange,disableStream:x.disableStream},P):x.data||(w=createPDFNetworkStream({url:x.url,length:x.length,httpHeaders:x.httpHeaders,withCredentials:x.withCredentials,rangeChunkSize:x.rangeChunkSize,disableRange:x.disableRange,disableStream:x.disableStream})),v(w)});return Promise.all([d,f]).then(function([v,w]){if(u.destroyed)throw new Error("Loading aborted");const C=new _message_handler.MessageHandler(h,v,A.port),k=new WorkerTransport(C,u,w,x);u._transport=k,C.send("Ready",null)})}).catch(u._capability.reject),u}async function _fetchDocument(b,u,g,x){if(b.destroyed)throw new Error("Worker was destroyed");g&&(u.length=g.length,u.initialData=g.initialData,u.progressiveDone=g.progressiveDone,u.contentDispositionFilename=g.contentDispositionFilename);const P=await b.messageHandler.sendWithPromise("GetDocRequest",{docId:x,apiVersion:"2.16.105",source:{data:u.data,url:u.url,password:u.password,disableAutoFetch:u.disableAutoFetch,rangeChunkSize:u.rangeChunkSize,length:u.length},maxImageSize:u.maxImageSize,disableFontFace:u.disableFontFace,docBaseUrl:u.docBaseUrl,ignoreErrors:u.ignoreErrors,isEvalSupported:u.isEvalSupported,fontExtraProperties:u.fontExtraProperties,enableXfa:u.enableXfa,useSystemFonts:u.useSystemFonts,cMapUrl:u.useWorkerFetch?u.cMapUrl:null,standardFontDataUrl:u.useWorkerFetch?u.standardFontDataUrl:null});if(u.data&&(u.data=null),b.destroyed)throw new Error("Worker was destroyed");return P}const t=class t{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ae(t,i)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var u;this.destroyed=!0,await((u=this._transport)==null?void 0:u.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};i=new WeakMap,at(t,i,0);let PDFDocumentLoadingTask=t;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(u,g,x=!1,P=null){this.length=u,this.initialData=g,this.progressiveDone=x,this.contentDispositionFilename=P,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(u){this._rangeListeners.push(u)}addProgressListener(u){this._progressListeners.push(u)}addProgressiveReadListener(u){this._progressiveReadListeners.push(u)}addProgressiveDoneListener(u){this._progressiveDoneListeners.push(u)}onDataRange(u,g){for(const x of this._rangeListeners)x(u,g)}onDataProgress(u,g){this._readyCapability.promise.then(()=>{for(const x of this._progressListeners)x(u,g)})}onDataProgressiveRead(u){this._readyCapability.promise.then(()=>{for(const g of this._progressiveReadListeners)g(u)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const u of this._progressiveDoneListeners)u()})}transportReady(){this._readyCapability.resolve()}requestDataRange(u,g){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(u,g){this._pdfInfo=u,this._transport=g,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(u){return this._transport.getPage(u)}getPageIndex(u){return this._transport.getPageIndex(u)}getDestinations(){return this._transport.getDestinations()}getDestination(u){return this._transport.getDestination(u)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(u=!1){return this._transport.startCleanup(u||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(u,g,x,P,A=!1){this._pageIndex=u,this._pageInfo=g,this._ownerDocument=P,this._transport=x,this._stats=A?new _display_utils.StatTimer:null,this._pdfBug=A,this.commonObjs=x.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:u,rotation:g=this.rotate,offsetX:x=0,offsetY:P=0,dontFlip:A=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:u,rotation:g,offsetX:x,offsetY:P,dontFlip:A})}getAnnotations({intent:u="display"}={}){const g=this._transport.getRenderingIntent(u);let x=this._annotationPromises.get(g.cacheKey);return x||(x=this._transport.getAnnotations(this._pageIndex,g.renderingIntent),this._annotationPromises.set(g.cacheKey,x),x=x.then(P=>{for(const A of P)A.titleObj!==void 0&&Object.defineProperty(A,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),A.titleObj.str}}),A.contentsObj!==void 0&&Object.defineProperty(A,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),A.contentsObj.str}});return P})),x}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var u;return((u=this._transport._htmlForXfa)==null?void 0:u.children[this._pageIndex])||null}render({canvasContext:u,viewport:g,intent:x="display",annotationMode:P=_util.AnnotationMode.ENABLE,transform:A=null,imageLayer:h=null,canvasFactory:d=null,background:f=null,optionalContentConfigPromise:v=null,annotationCanvasMap:w=null,pageColors:C=null,printAnnotationStorage:k=null}){var X,it;((X=arguments[0])==null?void 0:X.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&P===_util.AnnotationMode.ENABLE&&(P=_util.AnnotationMode.ENABLE_FORMS)),((it=arguments[0])==null?void 0:it.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&P===_util.AnnotationMode.ENABLE&&(P=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const R=this._transport.getRenderingIntent(x,P,k);this.pendingCleanup=!1,v||(v=this._transport.getOptionalContentConfig());let H=this._intentStates.get(R.cacheKey);H||(H=Object.create(null),this._intentStates.set(R.cacheKey,H)),H.streamReaderCancelTimeout&&(clearTimeout(H.streamReaderCancelTimeout),H.streamReaderCancelTimeout=null);const Z=d||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),K=!!(R.renderingIntent&_util.RenderingIntentFlag.PRINT);H.displayReadyCapability||(H.displayReadyCapability=(0,_util.createPromiseCapability)(),H.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(R));const q=lt=>{H.renderTasks.delete(W),(this.cleanupAfterRender||K)&&(this.pendingCleanup=!0),this._tryCleanup(),lt?(W.capability.reject(lt),this._abortOperatorList({intentState:H,reason:lt instanceof Error?lt:new Error(lt)})):W.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},W=new InternalRenderTask({callback:q,params:{canvasContext:u,viewport:g,transform:A,imageLayer:h,background:f},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:w,operatorList:H.operatorList,pageIndex:this._pageIndex,canvasFactory:Z,useRequestAnimationFrame:!K,pdfBug:this._pdfBug,pageColors:C});(H.renderTasks||(H.renderTasks=new Set)).add(W);const $=W.task;return Promise.all([H.displayReadyCapability.promise,v]).then(([lt,_t])=>{if(this.pendingCleanup){q();return}this._stats&&this._stats.time("Rendering"),W.initializeGraphics({transparency:lt,optionalContentConfig:_t}),W.operatorListChanged()}).catch(q),$}getOperatorList({intent:u="display",annotationMode:g=_util.AnnotationMode.ENABLE,printAnnotationStorage:x=null}={}){function P(){h.operatorList.lastChunk&&(h.opListReadCapability.resolve(h.operatorList),h.renderTasks.delete(d))}const A=this._transport.getRenderingIntent(u,g,x,!0);let h=this._intentStates.get(A.cacheKey);h||(h=Object.create(null),this._intentStates.set(A.cacheKey,h));let d;return h.opListReadCapability||(d=Object.create(null),d.operatorListChanged=P,h.opListReadCapability=(0,_util.createPromiseCapability)(),(h.renderTasks||(h.renderTasks=new Set)).add(d),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(A)),h.opListReadCapability.promise}streamTextContent({disableCombineTextItems:u=!1,includeMarkedContent:g=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:u!==!0,includeMarkedContent:g===!0},{highWaterMark:100,size(P){return P.items.length}})}getTextContent(u={}){if(this._transport._htmlForXfa)return this.getXfa().then(x=>_xfa_text.XfaText.textContent(x));const g=this.streamTextContent(u);return new Promise(function(x,P){function A(){h.read().then(function({value:f,done:v}){if(v){x(d);return}Object.assign(d.styles,f.styles),d.items.push(...f.items),A()},P)}const h=g.getReader(),d={items:[],styles:Object.create(null)};A()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const u=[];for(const g of this._intentStates.values())if(this._abortOperatorList({intentState:g,reason:new Error("Page was destroyed."),force:!0}),!g.opListReadCapability)for(const x of g.renderTasks)u.push(x.completed),x.cancel();this.objs.clear();for(const g of this._bitmaps)g.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(u)}cleanup(u=!1){return this.pendingCleanup=!0,this._tryCleanup(u)}_tryCleanup(u=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:g,operatorList:x}of this._intentStates.values())if(g.size>0||!x.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,u&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const g of this._bitmaps)g.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(u,g){const x=this._intentStates.get(g);x&&(this._stats&&this._stats.timeEnd("Page Request"),x.displayReadyCapability&&x.displayReadyCapability.resolve(u))}_renderPageChunk(u,g){for(let x=0,P=u.length;x<P;x++)g.operatorList.fnArray.push(u.fnArray[x]),g.operatorList.argsArray.push(u.argsArray[x]);g.operatorList.lastChunk=u.lastChunk,g.operatorList.separateAnnots=u.separateAnnots;for(const x of g.renderTasks)x.operatorListChanged();u.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:u,cacheKey:g,annotationStorageMap:x}){const A=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:u,cacheKey:g,annotationStorage:x}).getReader(),h=this._intentStates.get(g);h.streamReader=A;const d=()=>{A.read().then(({value:f,done:v})=>{if(v){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,h),d())},f=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const v of h.renderTasks)v.operatorListChanged();this._tryCleanup()}if(h.displayReadyCapability)h.displayReadyCapability.reject(f);else if(h.opListReadCapability)h.opListReadCapability.reject(f);else throw f}})};d()}_abortOperatorList({intentState:u,reason:g,force:x=!1}){if(u.streamReader){if(!x){if(u.renderTasks.size>0)return;if(g instanceof _display_utils.RenderingCancelledException){u.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:u,reason:g,force:!0}),u.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(u.streamReader.cancel(new _util.AbortException(g.message)).catch(()=>{}),u.streamReader=null,!this._transport.destroyed){for(const[P,A]of this._intentStates)if(A===u){this._intentStates.delete(P);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(u,g){const x={data:structuredClone(u,g)};this._deferred.then(()=>{for(const P of this._listeners)P.call(this,x)})}addEventListener(u,g){this._listeners.push(g)}removeEventListener(u,g){const x=this._listeners.indexOf(g);this._listeners.splice(x,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const b=(e=document==null?void 0:document.currentScript)==null?void 0:e.src;b&&(PDFWorkerUtil.fallbackWorkerSrc=b.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(b,u){let g;try{if(g=new URL(b),!g.origin||g.origin==="null")return!1}catch{return!1}const x=new URL(u,g);return g.origin===x.origin},PDFWorkerUtil.createCDNWrapper=function(b){const u=`importScripts("${b}");`;return URL.createObjectURL(new Blob([u]))}}const _PDFWorker=class _PDFWorker{constructor({name:b=null,port:u=null,verbosity:g=(0,_util.getVerbosityLevel)()}={}){if(u&&I(_PDFWorker,s).has(u))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=b,this.destroyed=!1,this.verbosity=g,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,u){I(_PDFWorker,s).set(u,this),this._initializeFromPort(u);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(b){this._port=b,this._messageHandler=new _message_handler.MessageHandler("main","worker",b),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:b}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,b)||(b=PDFWorkerUtil.createCDNWrapper(new URL(b,window.location).href));const u=new Worker(b),g=new _message_handler.MessageHandler("main","worker",u),x=()=>{u.removeEventListener("error",P),g.destroy(),u.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},P=()=>{this._webWorker||x()};u.addEventListener("error",P),g.on("test",h=>{if(u.removeEventListener("error",P),this.destroyed){x();return}h?(this._messageHandler=g,this._port=u,this._webWorker=u,this._readyCapability.resolve(),g.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),g.destroy(),u.terminate())}),g.on("ready",h=>{if(u.removeEventListener("error",P),this.destroyed){x();return}try{A()}catch{this._setupFakeWorker()}});const A=()=>{const h=new Uint8Array;g.send("test",h,[h.buffer])};A();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(b=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const u=new LoopbackPort;this._port=u;const g=`fake${PDFWorkerUtil.fakeWorkerId++}`,x=new _message_handler.MessageHandler(g+"_worker",g,u);b.setup(x,u);const P=new _message_handler.MessageHandler(g,g+"_worker",u);this._messageHandler=P,this._readyCapability.resolve(),P.send("configure",{verbosity:this.verbosity})}).catch(b=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${b.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),I(_PDFWorker,s).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(b){if(!(b!=null&&b.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return I(this,s).has(b.port)?I(this,s).get(b.port):new _PDFWorker(b)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var b;try{return((b=globalThis.pdfjsWorker)==null?void 0:b.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};s=new WeakMap,at(_PDFWorker,s,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(u,g,x,P){at(this,n,null);at(this,r,new Map);at(this,a,new Map);at(this,o,null);this.messageHandler=u,this.loadingTask=g,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:g.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:P.ownerDocument,styleElement:P.styleElement}),this._params=P,P.useWorkerFetch||(this.CMapReaderFactory=new P.CMapReaderFactory({baseUrl:P.cMapUrl,isCompressed:P.cMapPacked}),this.StandardFontDataFactory=new P.StandardFontDataFactory({baseUrl:P.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=x,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return I(this,n)}getRenderingIntent(u,g=_util.AnnotationMode.ENABLE,x=null,P=!1){let A=_util.RenderingIntentFlag.DISPLAY,h=null;switch(u){case"any":A=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":A=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${u}`)}switch(g){case _util.AnnotationMode.DISABLE:A+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:A+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:A+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,h=(A&_util.RenderingIntentFlag.PRINT&&x instanceof _annotation_storage.PrintAnnotationStorage?x:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${g}`)}return P&&(A+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:A,cacheKey:`${A}_${_annotation_storage.AnnotationStorage.getHash(h)}`,annotationStorageMap:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const u=[];for(const x of I(this,r).values())u.push(x._destroy());I(this,r).clear(),I(this,a).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const g=this.messageHandler.sendWithPromise("Terminate",null);return u.push(g),Promise.all(u).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),bt(this,o,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:u,loadingTask:g}=this;u.on("GetReader",(x,P)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=A=>{this._lastProgress={loaded:A.loaded,total:A.total}},P.onPull=()=>{this._fullReader.read().then(function({value:A,done:h}){if(h){P.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(A),"GetReader - expected an ArrayBuffer."),P.enqueue(new Uint8Array(A),1,[A])}).catch(A=>{P.error(A)})},P.onCancel=A=>{this._fullReader.cancel(A),P.ready.catch(h=>{if(!this.destroyed)throw h})}}),u.on("ReaderHeadersReady",x=>{const P=(0,_util.createPromiseCapability)(),A=this._fullReader;return A.headersReady.then(()=>{var h;(!A.isStreamingSupported||!A.isRangeSupported)&&(this._lastProgress&&((h=g.onProgress)==null||h.call(g,this._lastProgress)),A.onProgress=d=>{var f;(f=g.onProgress)==null||f.call(g,{loaded:d.loaded,total:d.total})}),P.resolve({isStreamingSupported:A.isStreamingSupported,isRangeSupported:A.isRangeSupported,contentLength:A.contentLength})},P.reject),P.promise}),u.on("GetRangeReader",(x,P)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const A=this._networkStream.getRangeReader(x.begin,x.end);if(!A){P.close();return}P.onPull=()=>{A.read().then(function({value:h,done:d}){if(d){P.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(h),"GetRangeReader - expected an ArrayBuffer."),P.enqueue(new Uint8Array(h),1,[h])}).catch(h=>{P.error(h)})},P.onCancel=h=>{A.cancel(h),P.ready.catch(d=>{if(!this.destroyed)throw d})}}),u.on("GetDoc",({pdfInfo:x})=>{this._numPages=x.numPages,this._htmlForXfa=x.htmlForXfa,delete x.htmlForXfa,g._capability.resolve(new PDFDocumentProxy(x,this))}),u.on("DocException",function(x){let P;switch(x.name){case"PasswordException":P=new _util.PasswordException(x.message,x.code);break;case"InvalidPDFException":P=new _util.InvalidPDFException(x.message);break;case"MissingPDFException":P=new _util.MissingPDFException(x.message);break;case"UnexpectedResponseException":P=new _util.UnexpectedResponseException(x.message,x.status);break;case"UnknownErrorException":P=new _util.UnknownErrorException(x.message,x.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}g._capability.reject(P)}),u.on("PasswordRequest",x=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),g.onPassword){const P=A=>{A instanceof Error?this._passwordCapability.reject(A):this._passwordCapability.resolve({password:A})};try{g.onPassword(P,x.code)}catch(A){this._passwordCapability.reject(A)}}else this._passwordCapability.reject(new _util.PasswordException(x.message,x.code));return this._passwordCapability.promise}),u.on("DataLoaded",x=>{var P;(P=g.onProgress)==null||P.call(g,{loaded:x.length,total:x.length}),this.downloadInfoCapability.resolve(x)}),u.on("StartRenderPage",x=>{if(this.destroyed)return;I(this,r).get(x.pageIndex)._startRenderPage(x.transparency,x.cacheKey)}),u.on("commonobj",([x,P,A])=>{var h;if(!this.destroyed&&!this.commonObjs.has(x))switch(P){case"Font":const d=this._params;if("error"in A){const w=A.error;(0,_util.warn)(`Error during font loading: ${w}`),this.commonObjs.resolve(x,w);break}let f=null;d.pdfBug&&((h=globalThis.FontInspector)!=null&&h.enabled)&&(f={registerFont(w,C){globalThis.FontInspector.fontAdded(w,C)}});const v=new _font_loader.FontFaceObject(A,{isEvalSupported:d.isEvalSupported,disableFontFace:d.disableFontFace,ignoreErrors:d.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:f});this.fontLoader.bind(v).catch(w=>u.sendWithPromise("FontFallback",{id:x})).finally(()=>{!d.fontExtraProperties&&v.data&&(v.data=null),this.commonObjs.resolve(x,v)});break;case"FontPath":case"Image":this.commonObjs.resolve(x,A);break;default:throw new Error(`Got unknown common object type ${P}`)}}),u.on("obj",([x,P,A,h])=>{var f;if(this.destroyed)return;const d=I(this,r).get(P);if(!d.objs.has(x))switch(A){case"Image":d.objs.resolve(x,h);const v=8e6;if(h){let w;if(h.bitmap){const{bitmap:C,width:k,height:R}=h;w=k*R*4,d._bitmaps.add(C)}else w=((f=h.data)==null?void 0:f.length)||0;w>v&&(d.cleanupAfterRender=!0)}break;case"Pattern":d.objs.resolve(x,h);break;default:throw new Error(`Got unknown object type ${A}`)}}),u.on("DocProgress",x=>{var P;this.destroyed||(P=g.onProgress)==null||P.call(g,{loaded:x.loaded,total:x.total})}),u.on("DocStats",x=>{this.destroyed||bt(this,n,Object.freeze({streamTypes:Object.freeze(x.streamTypes),fontTypes:Object.freeze(x.fontTypes)}))}),u.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),u.on("FetchBuiltInCMap",x=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(x):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),u.on("FetchStandardFontData",x=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(x):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:u}){var g,x;this.destroyed||(x=(g=this.loadingTask).onUnsupportedFeature)==null||x.call(g,u)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(u){if(!Number.isInteger(u)||u<=0||u>this._numPages)return Promise.reject(new Error("Invalid page request."));const g=u-1,x=I(this,a).get(g);if(x)return x;const P=this.messageHandler.sendWithPromise("GetPage",{pageIndex:g}).then(A=>{if(this.destroyed)throw new Error("Transport destroyed");const h=new PDFPageProxy(g,A,this,this._params.ownerDocument,this._params.pdfBug);return I(this,r).set(g,h),h});return I(this,a).set(g,P),P}getPageIndex(u){return typeof u!="object"||u===null||!Number.isInteger(u.num)||u.num<0||!Number.isInteger(u.gen)||u.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:u.num,gen:u.gen})}getAnnotations(u,g){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:u,intent:g})}saveDocument(){var u;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((u=this._fullReader)==null?void 0:u.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(u){return typeof u!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:u})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(u){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:u})}getStructTree(u){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:u})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(u=>new _optional_content_config.OptionalContentConfig(u))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return I(this,o)||bt(this,o,this.messageHandler.sendWithPromise("GetMetadata",null).then(u=>{var g,x;return{info:u[0],metadata:u[1]?new _metadata.Metadata(u[1]):null,contentDispositionFilename:((g=this._fullReader)==null?void 0:g.filename)??null,contentLength:((x=this._fullReader)==null?void 0:x.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(u=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const g of I(this,r).values())if(!g.cleanup())throw new Error(`startCleanup: Page ${g.pageNumber} is currently rendering.`);this.commonObjs.clear(),u||this.fontLoader.clear(),bt(this,o,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const u=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:u.disableAutoFetch,enableXfa:u.enableXfa})}}n=new WeakMap,r=new WeakMap,a=new WeakMap,o=new WeakMap;class PDFObjects{constructor(){at(this,c);at(this,l,Object.create(null))}get(u,g=null){if(g){const P=ht(this,c,oe).call(this,u);return P.capability.promise.then(()=>g(P.data)),null}const x=I(this,l)[u];if(!(x!=null&&x.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${u}.`);return x.data}has(u){const g=I(this,l)[u];return(g==null?void 0:g.capability.settled)||!1}resolve(u,g=null){const x=ht(this,c,oe).call(this,u);x.data=g,x.capability.resolve()}clear(){bt(this,l,Object.create(null))}}l=new WeakMap,c=new WeakSet,oe=function(u){const g=I(this,l)[u];return g||(I(this,l)[u]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(u){at(this,m,null);bt(this,m,u),this.onContinue=null}get promise(){return I(this,m).capability.promise}cancel(){I(this,m).cancel()}get separateAnnots(){const{separateAnnots:u}=I(this,m).operatorList;if(!u)return!1;const{annotationCanvasMap:g}=I(this,m);return u.form||u.canvas&&(g==null?void 0:g.size)>0}}m=new WeakMap,exports.RenderTask=RenderTask;const y=class y{constructor({callback:u,params:g,objs:x,commonObjs:P,annotationCanvasMap:A,operatorList:h,pageIndex:d,canvasFactory:f,useRequestAnimationFrame:v=!1,pdfBug:w=!1,pageColors:C=null}){this.callback=u,this.params=g,this.objs=x,this.commonObjs=P,this.annotationCanvasMap=A,this.operatorListIdx=null,this.operatorList=h,this._pageIndex=d,this.canvasFactory=f,this._pdfBug=w,this.pageColors=C,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=v===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=g.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:u=!1,optionalContentConfig:g}){var f;if(this.cancelled)return;if(this._canvas){if(I(y,_).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");I(y,_).add(this._canvas)}this._pdfBug&&((f=globalThis.StepperManager)!=null&&f.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:x,viewport:P,transform:A,imageLayer:h,background:d}=this.params;this.gfx=new _canvas.CanvasGraphics(x,this.commonObjs,this.objs,this.canvasFactory,h,g,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:A,viewport:P,transparency:u,background:d}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(u=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&I(y,_).delete(this._canvas),this.callback(u||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&I(y,_).delete(this._canvas),this.callback())))}};_=new WeakMap,at(y,_,new WeakSet);let InternalRenderTask=y;const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(i,t,e)=>{var l,we,p;Object.defineProperty(t,"__esModule",{value:!0}),t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var s=e(1),n=e(6),r=e(10);class a{constructor(){at(this,l);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(_,y){const b=this._storage.get(_);return b===void 0?y:Object.assign(y,b)}getRawValue(_){return this._storage.get(_)}remove(_){if(this._storage.delete(_),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const y of this._storage.values())if(y instanceof n.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(_,y){const b=this._storage.get(_);let u=!1;if(b!==void 0)for(const[g,x]of Object.entries(y))b[g]!==x&&(u=!0,b[g]=x);else u=!0,this._storage.set(_,y);u&&ht(this,l,we).call(this),y instanceof n.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(y.constructor._type)}has(_){return this._storage.has(_)}getAll(){return this._storage.size>0?(0,s.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new o(this)}get serializable(){if(this._storage.size===0)return null;const _=new Map;for(const[y,b]of this._storage){const u=b instanceof n.AnnotationEditor?b.serialize():b;u&&_.set(y,u)}return _}static getHash(_){if(!_)return"";const y=new r.MurmurHash3_64;for(const[b,u]of _)y.update(`${b}:${JSON.stringify(u)}`);return y.hexdigest()}}l=new WeakSet,we=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},t.AnnotationStorage=a;class o extends a{constructor(y){super();at(this,p,null);bt(this,p,structuredClone(y.serializable))}get print(){(0,s.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return I(this,p)}}p=new WeakMap,t.PrintAnnotationStorage=o},(i,t,e)=>{var a,o,l,c,p,m;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var s=e(7),n=e(1);const _=class _{constructor(b){at(this,a,this.focusin.bind(this));at(this,o,this.focusout.bind(this));at(this,l,!1);at(this,c,!1);at(this,p,!1);at(this,m,_._zIndex++);this.constructor===_&&(0,n.unreachable)("Cannot initialize AnnotationEditor."),this.parent=b.parent,this.id=b.id,this.width=this.height=null,this.pageIndex=b.parent.pageIndex,this.name=b.name,this.div=null;const[u,g]=this.parent.viewportBaseDimensions;this.x=b.x/u,this.y=b.y/g,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,n.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=I(this,m)}focusin(b){I(this,l)?bt(this,l,!1):this.parent.setSelected(this)}focusout(b){if(!this.isAttachedToDOM)return;const u=b.relatedTarget;u!=null&&u.closest(`#${this.id}`)||(b.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(b){const u=this.parent.div.getBoundingClientRect();this.startX=b.clientX-u.x,this.startY=b.clientY-u.y,b.dataTransfer.setData("text/plain",this.id),b.dataTransfer.effectAllowed="move"}setAt(b,u,g,x){const[P,A]=this.parent.viewportBaseDimensions;[g,x]=this.screenToPageTranslation(g,x),this.x=(b+g)/P,this.y=(u+x)/A,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(b,u){const[g,x]=this.parent.viewportBaseDimensions;[b,u]=this.screenToPageTranslation(b,u),this.x+=b/g,this.y+=u/x,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(b,u){const{rotation:g}=this.parent.viewport;switch(g){case 90:return[u,-b];case 180:return[-b,-u];case 270:return[-u,b];default:return[b,u]}}setDims(b,u){const[g,x]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*b/g}%`,this.div.style.height=`${100*u/x}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",I(this,a)),this.div.addEventListener("focusout",I(this,o));const[b,u]=this.getInitialTranslation();return this.translate(b,u),(0,s.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(b){const u=s.KeyboardManager.platform.isMac;if(b.button!==0||b.ctrlKey&&u){b.preventDefault();return}b.ctrlKey&&!u||b.shiftKey||b.metaKey&&u?this.parent.toggleSelected(this):this.parent.setSelected(this),bt(this,l,!0)}getRect(b,u){const[g,x]=this.parent.viewportBaseDimensions,[P,A]=this.parent.pageDimensions,h=P*b/g,d=A*u/x,f=this.x*P,v=this.y*A,w=this.width*P,C=this.height*A;switch(this.rotation){case 0:return[f+h,A-v-d-C,f+h+w,A-v-d];case 90:return[f+d,A-v+h,f+d+C,A-v+h+w];case 180:return[f-h-w,A-v+d,f-h,A-v+d+C];case 270:return[f-d-C,A-v-h-w,f-d,A-v-h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(b,u){const[g,x,P,A]=b,h=P-g,d=A-x;switch(this.rotation){case 0:return[g,u-A,h,d];case 90:return[g,u-x,d,h];case 180:return[P,u-x,h,d];case 270:return[P,u-A,d,h];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){bt(this,p,!0)}disableEditMode(){bt(this,p,!1)}isInEditMode(){return I(this,p)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var b;(b=this.div)==null||b.addEventListener("focusin",I(this,a))}serialize(){(0,n.unreachable)("An editor must be serializable")}static deserialize(b,u){const g=new this.prototype.constructor({parent:u,id:u.getNextId()});g.rotation=b.rotation;const[x,P]=u.pageDimensions,[A,h,d,f]=g.getRectInCurrentCoords(b.rect,P);return g.x=A/x,g.y=h/P,g.width=d/x,g.height=f/P,g}remove(){this.div.removeEventListener("focusin",I(this,a)),this.div.removeEventListener("focusout",I(this,o)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var b;(b=this.div)==null||b.classList.add("selectedEditor")}unselect(){var b;(b=this.div)==null||b.classList.remove("selectedEditor")}updateParams(b,u){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return I(this,c)}set isEditing(b){bt(this,c,b),b?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};a=new WeakMap,o=new WeakMap,l=new WeakMap,c=new WeakMap,p=new WeakMap,m=new WeakMap,ft(_,"_colorManager",new s.ColorManager),ft(_,"_zIndex",1);let r=_;t.AnnotationEditor=r},(i,t,e)=>{var y,b,u,g,x,P,Pe,d,v,w,C,k,R,H,Z,K,q,W,$,X,it,lt,_t,z,E,T,Ce,N,le,U,Wt,Q,Jt,M,ke,F,Te,V,ce,dt,Qt,ot,te;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=r,t.opacityToHex=a;var s=e(1),n=e(8);function r(pt,B,ut){for(const xt of ut)B.addEventListener(xt,pt[xt].bind(pt))}function a(pt){return Math.round(Math.min(255,Math.max(1,255*pt))).toString(16).padStart(2,"0")}class o{constructor(){at(this,y,0)}getId(){return`${s.AnnotationEditorPrefix}${ae(this,y)._++}`}}y=new WeakMap;class l{constructor(B=128){at(this,b,[]);at(this,u,!1);at(this,g,void 0);at(this,x,-1);bt(this,g,B)}add({cmd:B,undo:ut,mustExec:xt,type:At=NaN,overwriteIfSameType:wt=!1,keepUndo:kt=!1}){if(xt&&B(),I(this,u))return;const Dt={cmd:B,undo:ut,type:At};if(I(this,x)===-1){I(this,b).length>0&&(I(this,b).length=0),bt(this,x,0),I(this,b).push(Dt);return}if(wt&&I(this,b)[I(this,x)].type===At){kt&&(Dt.undo=I(this,b)[I(this,x)].undo),I(this,b)[I(this,x)]=Dt;return}const Rt=I(this,x)+1;Rt===I(this,g)?I(this,b).splice(0,1):(bt(this,x,Rt),Rt<I(this,b).length&&I(this,b).splice(Rt)),I(this,b).push(Dt)}undo(){I(this,x)!==-1&&(bt(this,u,!0),I(this,b)[I(this,x)].undo(),bt(this,u,!1),bt(this,x,I(this,x)-1))}redo(){I(this,x)<I(this,b).length-1&&(bt(this,x,I(this,x)+1),bt(this,u,!0),I(this,b)[I(this,x)].cmd(),bt(this,u,!1))}hasSomethingToUndo(){return I(this,x)!==-1}hasSomethingToRedo(){return I(this,x)<I(this,b).length-1}destroy(){bt(this,b,null)}}b=new WeakMap,u=new WeakMap,g=new WeakMap,x=new WeakMap,t.CommandManager=l;const h=class h{constructor(B){at(this,P);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const ut=h.platform.isMac;for(const[xt,At]of B)for(const wt of xt){const kt=wt.startsWith("mac+");ut&&kt?(this.callbacks.set(wt.slice(4),At),this.allKeys.add(wt.split("+").at(-1))):!ut&&!kt&&(this.callbacks.set(wt,At),this.allKeys.add(wt.split("+").at(-1)))}}static get platform(){const B=typeof navigator<"u"?navigator.platform:"";return(0,s.shadow)(this,"platform",{isWin:B.includes("Win"),isMac:B.includes("Mac")})}exec(B,ut){if(!this.allKeys.has(ut.key))return;const xt=this.callbacks.get(ht(this,P,Pe).call(this,ut));xt&&(xt.bind(B)(),ut.stopPropagation(),ut.preventDefault())}};P=new WeakSet,Pe=function(B){B.altKey&&this.buffer.push("alt"),B.ctrlKey&&this.buffer.push("ctrl"),B.metaKey&&this.buffer.push("meta"),B.shiftKey&&this.buffer.push("shift"),this.buffer.push(B.key);const ut=this.buffer.join("+");return this.buffer.length=0,ut};let c=h;t.KeyboardManager=c;class p{constructor(){at(this,d,null)}copy(B){B&&(Array.isArray(B)?bt(this,d,B.map(ut=>ut.serialize())):bt(this,d,[B.serialize()]),bt(this,d,I(this,d).filter(ut=>!!ut)),I(this,d).length===0&&bt(this,d,null))}paste(){return I(this,d)}isEmpty(){return I(this,d)===null}destroy(){bt(this,d,null)}}d=new WeakMap;const f=class f{get _colors(){const B=new Map([["CanvasText",null],["Canvas",null]]);return(0,n.getColorValues)(B),(0,s.shadow)(this,"_colors",B)}convert(B){const ut=(0,n.getRGB)(B);if(!window.matchMedia("(forced-colors: active)").matches)return ut;for(const[xt,At]of this._colors)if(At.every((wt,kt)=>wt===ut[kt]))return f._colorsMapping.get(xt);return ut}getHexCode(B){const ut=this._colors.get(B);return ut?s.Util.makeHexColor(...ut):B}};ft(f,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let m=f;t.ColorManager=m;const ct=class ct{constructor(B,ut){at(this,T);at(this,N);at(this,U);at(this,Q);at(this,M);at(this,F);at(this,V);at(this,dt);at(this,ot);at(this,v,null);at(this,w,new Map);at(this,C,new Map);at(this,k,new p);at(this,R,new l);at(this,H,0);at(this,Z,null);at(this,K,null);at(this,q,new o);at(this,W,!1);at(this,$,s.AnnotationEditorType.NONE);at(this,X,new Set);at(this,it,this.keydown.bind(this));at(this,lt,this.onEditingAction.bind(this));at(this,_t,this.onPageChanging.bind(this));at(this,z,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});at(this,E,null);bt(this,E,B),bt(this,K,ut),I(this,K)._on("editingaction",I(this,lt)),I(this,K)._on("pagechanging",I(this,_t))}destroy(){ht(this,N,le).call(this),I(this,K)._off("editingaction",I(this,lt)),I(this,K)._off("pagechanging",I(this,_t));for(const B of I(this,C).values())B.destroy();I(this,C).clear(),I(this,w).clear(),bt(this,v,null),I(this,X).clear(),I(this,k).destroy(),I(this,R).destroy()}onPageChanging({pageNumber:B}){bt(this,H,B-1)}focusMainContainer(){I(this,E).focus()}keydown(B){var ut;(ut=this.getActive())!=null&&ut.shouldGetKeyboardEvents()||ct._keyboardManager.exec(this,B)}onEditingAction(B){["undo","redo","cut","copy","paste","delete","selectAll"].includes(B.name)&&this[B.name]()}setEditingState(B){B?(ht(this,T,Ce).call(this),ht(this,U,Wt).call(this,{isEditing:I(this,$)!==s.AnnotationEditorType.NONE,isEmpty:ht(this,dt,Qt).call(this),hasSomethingToUndo:I(this,R).hasSomethingToUndo(),hasSomethingToRedo:I(this,R).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:I(this,k).isEmpty()})):(ht(this,N,le).call(this),ht(this,U,Wt).call(this,{isEditing:!1}))}registerEditorTypes(B){bt(this,Z,B);for(const ut of I(this,Z))ht(this,Q,Jt).call(this,ut.defaultPropertiesToUpdate)}getId(){return I(this,q).getId()}addLayer(B){I(this,C).set(B.pageIndex,B),I(this,W)?B.enable():B.disable()}removeLayer(B){I(this,C).delete(B.pageIndex)}updateMode(B){if(bt(this,$,B),B===s.AnnotationEditorType.NONE)this.setEditingState(!1),ht(this,F,Te).call(this);else{this.setEditingState(!0),ht(this,M,ke).call(this);for(const ut of I(this,C).values())ut.updateMode(B)}}updateToolbar(B){B!==I(this,$)&&I(this,K).dispatch("switchannotationeditormode",{source:this,mode:B})}updateParams(B,ut){for(const xt of I(this,X))xt.updateParams(B,ut);for(const xt of I(this,Z))xt.updateDefaultParams(B,ut)}getEditors(B){const ut=[];for(const xt of I(this,w).values())xt.pageIndex===B&&ut.push(xt);return ut}getEditor(B){return I(this,w).get(B)}addEditor(B){I(this,w).set(B.id,B)}removeEditor(B){I(this,w).delete(B.id),this.unselect(B)}setActiveEditor(B){I(this,v)!==B&&(bt(this,v,B),B&&ht(this,Q,Jt).call(this,B.propertiesToUpdate))}toggleSelected(B){if(I(this,X).has(B)){I(this,X).delete(B),B.unselect(),ht(this,U,Wt).call(this,{hasSelectedEditor:this.hasSelection});return}I(this,X).add(B),B.select(),ht(this,Q,Jt).call(this,B.propertiesToUpdate),ht(this,U,Wt).call(this,{hasSelectedEditor:!0})}setSelected(B){for(const ut of I(this,X))ut!==B&&ut.unselect();I(this,X).clear(),I(this,X).add(B),B.select(),ht(this,Q,Jt).call(this,B.propertiesToUpdate),ht(this,U,Wt).call(this,{hasSelectedEditor:!0})}isSelected(B){return I(this,X).has(B)}unselect(B){B.unselect(),I(this,X).delete(B),ht(this,U,Wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return I(this,X).size!==0}undo(){I(this,R).undo(),ht(this,U,Wt).call(this,{hasSomethingToUndo:I(this,R).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ht(this,dt,Qt).call(this)})}redo(){I(this,R).redo(),ht(this,U,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:I(this,R).hasSomethingToRedo(),isEmpty:ht(this,dt,Qt).call(this)})}addCommands(B){I(this,R).add(B),ht(this,U,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ht(this,dt,Qt).call(this)})}delete(){if(I(this,v)&&I(this,v).commitOrRemove(),!this.hasSelection)return;const B=[...I(this,X)],ut=()=>{for(const At of B)At.remove()},xt=()=>{for(const At of B)ht(this,V,ce).call(this,At)};this.addCommands({cmd:ut,undo:xt,mustExec:!0})}copy(){if(I(this,v)&&I(this,v).commitOrRemove(),this.hasSelection){const B=[];for(const ut of I(this,X))ut.isEmpty()||B.push(ut);if(B.length===0)return;I(this,k).copy(B),ht(this,U,Wt).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(I(this,k).isEmpty())return;this.unselectAll();const B=I(this,C).get(I(this,H)),ut=I(this,k).paste().map(wt=>B.deserialize(wt)),xt=()=>{for(const wt of ut)ht(this,V,ce).call(this,wt);ht(this,ot,te).call(this,ut)},At=()=>{for(const wt of ut)wt.remove()};this.addCommands({cmd:xt,undo:At,mustExec:!0})}selectAll(){for(const B of I(this,X))B.commit();ht(this,ot,te).call(this,I(this,w).values())}unselectAll(){if(I(this,v)){I(this,v).commitOrRemove();return}if(ht(this,ot,te).size!==0){for(const B of I(this,X))B.unselect();I(this,X).clear(),ht(this,U,Wt).call(this,{hasSelectedEditor:!1})}}isActive(B){return I(this,v)===B}getActive(){return I(this,v)}getMode(){return I(this,$)}};v=new WeakMap,w=new WeakMap,C=new WeakMap,k=new WeakMap,R=new WeakMap,H=new WeakMap,Z=new WeakMap,K=new WeakMap,q=new WeakMap,W=new WeakMap,$=new WeakMap,X=new WeakMap,it=new WeakMap,lt=new WeakMap,_t=new WeakMap,z=new WeakMap,E=new WeakMap,T=new WeakSet,Ce=function(){I(this,E).addEventListener("keydown",I(this,it))},N=new WeakSet,le=function(){I(this,E).removeEventListener("keydown",I(this,it))},U=new WeakSet,Wt=function(B){Object.entries(B).some(([xt,At])=>I(this,z)[xt]!==At)&&I(this,K).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(I(this,z),B)})},Q=new WeakSet,Jt=function(B){I(this,K).dispatch("annotationeditorparamschanged",{source:this,details:B})},M=new WeakSet,ke=function(){if(!I(this,W)){bt(this,W,!0);for(const B of I(this,C).values())B.enable()}},F=new WeakSet,Te=function(){if(this.unselectAll(),I(this,W)){bt(this,W,!1);for(const B of I(this,C).values())B.disable()}},V=new WeakSet,ce=function(B){const ut=I(this,C).get(B.pageIndex);ut?ut.addOrRebuild(B):this.addEditor(B)},dt=new WeakSet,Qt=function(){if(I(this,w).size===0)return!0;if(I(this,w).size===1)for(const B of I(this,w).values())return B.isEmpty();return!1},ot=new WeakSet,te=function(B){I(this,X).clear();for(const ut of B)ut.isEmpty()||(I(this,X).add(ut),ut.select());ht(this,U,Wt).call(this,{hasSelectedEditor:!0})},ft(ct,"_keyboardManager",new c([[["ctrl+a","mac+meta+a"],ct.prototype.selectAll],[["ctrl+c","mac+meta+c"],ct.prototype.copy],[["ctrl+v","mac+meta+v"],ct.prototype.paste],[["ctrl+x","mac+meta+x"],ct.prototype.cut],[["ctrl+z","mac+meta+z"],ct.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],ct.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],ct.prototype.delete],[["Escape","mac+Escape"],ct.prototype.unselectAll]]));let _=ct;t.AnnotationEditorUIManager=_},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=t.AnnotationPrefix=void 0,t.deprecated=f,t.getColorValues=R,t.getCurrentTransform=H,t.getCurrentTransformInverse=Z,t.getFilenameFromUrl=x,t.getPdfFilenameFromUrl=P,t.getRGB=k,t.getXfaPageViewport=C,t.isDataScheme=u,t.isPdfFile=g,t.isValidFetchUrl=h,t.loadScript=d;var s=e(9),n=e(1);const r="http://www.w3.org/2000/svg",a="pdfjs_internal_id_";t.AnnotationPrefix=a;const K=class K{};ft(K,"CSS",96),ft(K,"PDF",72),ft(K,"PDF_TO_CSS_UNITS",K.CSS/K.PDF);let o=K;t.PixelsPerInch=o;class l extends s.BaseCanvasFactory{constructor({ownerDocument:W=globalThis.document}={}){super(),this._document=W}_createCanvas(W,$){const X=this._document.createElement("canvas");return X.width=W,X.height=$,X}}t.DOMCanvasFactory=l;async function c(q,W=!1){if(h(q,document.baseURI)){const $=await fetch(q);if(!$.ok)throw new Error($.statusText);return W?new Uint8Array(await $.arrayBuffer()):(0,n.stringToBytes)(await $.text())}return new Promise(($,X)=>{const it=new XMLHttpRequest;it.open("GET",q,!0),W&&(it.responseType="arraybuffer"),it.onreadystatechange=()=>{if(it.readyState===XMLHttpRequest.DONE){if(it.status===200||it.status===0){let lt;if(W&&it.response?lt=new Uint8Array(it.response):!W&&it.responseText&&(lt=(0,n.stringToBytes)(it.responseText)),lt){$(lt);return}}X(new Error(it.statusText))}},it.send(null)})}class p extends s.BaseCMapReaderFactory{_fetchData(W,$){return c(W,this.isCompressed).then(X=>({cMapData:X,compressionType:$}))}}t.DOMCMapReaderFactory=p;class m extends s.BaseStandardFontDataFactory{_fetchData(W){return c(W,!0)}}t.DOMStandardFontDataFactory=m;class _ extends s.BaseSVGFactory{_createSVG(W){return document.createElementNS(r,W)}}t.DOMSVGFactory=_;class y{constructor({viewBox:W,scale:$,rotation:X,offsetX:it=0,offsetY:lt=0,dontFlip:_t=!1}){this.viewBox=W,this.scale=$,this.rotation=X,this.offsetX=it,this.offsetY=lt;const z=(W[2]+W[0])/2,E=(W[3]+W[1])/2;let T,O,N,j;switch(X%=360,X<0&&(X+=360),X){case 180:T=-1,O=0,N=0,j=1;break;case 90:T=0,O=1,N=1,j=0;break;case 270:T=0,O=-1,N=-1,j=0;break;case 0:T=1,O=0,N=0,j=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}_t&&(N=-N,j=-j);let U,J,Q,S;T===0?(U=Math.abs(E-W[1])*$+it,J=Math.abs(z-W[0])*$+lt,Q=Math.abs(W[3]-W[1])*$,S=Math.abs(W[2]-W[0])*$):(U=Math.abs(z-W[0])*$+it,J=Math.abs(E-W[1])*$+lt,Q=Math.abs(W[2]-W[0])*$,S=Math.abs(W[3]-W[1])*$),this.transform=[T*$,O*$,N*$,j*$,U-T*$*z-N*$*E,J-O*$*z-j*$*E],this.width=Q,this.height=S}clone({scale:W=this.scale,rotation:$=this.rotation,offsetX:X=this.offsetX,offsetY:it=this.offsetY,dontFlip:lt=!1}={}){return new y({viewBox:this.viewBox.slice(),scale:W,rotation:$,offsetX:X,offsetY:it,dontFlip:lt})}convertToViewportPoint(W,$){return n.Util.applyTransform([W,$],this.transform)}convertToViewportRectangle(W){const $=n.Util.applyTransform([W[0],W[1]],this.transform),X=n.Util.applyTransform([W[2],W[3]],this.transform);return[$[0],$[1],X[0],X[1]]}convertToPdfPoint(W,$){return n.Util.applyInverseTransform([W,$],this.transform)}}t.PageViewport=y;class b extends n.BaseException{constructor(W,$){super(W,"RenderingCancelledException"),this.type=$}}t.RenderingCancelledException=b;function u(q){const W=q.length;let $=0;for(;$<W&&q[$].trim()==="";)$++;return q.substring($,$+5).toLowerCase()==="data:"}function g(q){return typeof q=="string"&&/\.pdf$/i.test(q)}function x(q){const W=q.indexOf("#"),$=q.indexOf("?"),X=Math.min(W>0?W:q.length,$>0?$:q.length);return q.substring(q.lastIndexOf("/",X)+1,X)}function P(q,W="document.pdf"){if(typeof q!="string")return W;if(u(q))return(0,n.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),W;const $=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,X=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,it=$.exec(q);let lt=X.exec(it[1])||X.exec(it[2])||X.exec(it[3]);if(lt&&(lt=lt[0],lt.includes("%")))try{lt=X.exec(decodeURIComponent(lt))[0]}catch{}return lt||W}class A{constructor(){this.started=Object.create(null),this.times=[]}time(W){W in this.started&&(0,n.warn)(`Timer is already running for ${W}`),this.started[W]=Date.now()}timeEnd(W){W in this.started||(0,n.warn)(`Timer has not been started for ${W}`),this.times.push({name:W,start:this.started[W],end:Date.now()}),delete this.started[W]}toString(){const W=[];let $=0;for(const X of this.times){const it=X.name;it.length>$&&($=it.length)}for(const X of this.times){const it=X.end-X.start;W.push(`${X.name.padEnd($)} ${it}ms
`)}return W.join("")}}t.StatTimer=A;function h(q,W){try{const{protocol:$}=W?new URL(q,W):new URL(q);return $==="http:"||$==="https:"}catch{return!1}}function d(q,W=!1){return new Promise(($,X)=>{const it=document.createElement("script");it.src=q,it.onload=function(lt){W&&it.remove(),$(lt)},it.onerror=function(){X(new Error(`Cannot load script at: ${it.src}`))},(document.head||document.documentElement).append(it)})}function f(q){console.log("Deprecated API usage: "+q)}let v;class w{static toDateObject(W){if(!W||typeof W!="string")return null;v||(v=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const $=v.exec(W);if(!$)return null;const X=parseInt($[1],10);let it=parseInt($[2],10);it=it>=1&&it<=12?it-1:0;let lt=parseInt($[3],10);lt=lt>=1&&lt<=31?lt:1;let _t=parseInt($[4],10);_t=_t>=0&&_t<=23?_t:0;let z=parseInt($[5],10);z=z>=0&&z<=59?z:0;let E=parseInt($[6],10);E=E>=0&&E<=59?E:0;const T=$[7]||"Z";let O=parseInt($[8],10);O=O>=0&&O<=23?O:0;let N=parseInt($[9],10)||0;return N=N>=0&&N<=59?N:0,T==="-"?(_t+=O,z+=N):T==="+"&&(_t-=O,z-=N),new Date(Date.UTC(X,it,lt,_t,z,E))}}t.PDFDateString=w;function C(q,{scale:W=1,rotation:$=0}){const{width:X,height:it}=q.attributes.style,lt=[0,0,parseInt(X),parseInt(it)];return new y({viewBox:lt,scale:W,rotation:$})}function k(q){if(q.startsWith("#")){const W=parseInt(q.slice(1),16);return[(W&16711680)>>16,(W&65280)>>8,W&255]}return q.startsWith("rgb(")?q.slice(4,-1).split(",").map(W=>parseInt(W)):q.startsWith("rgba(")?q.slice(5,-1).split(",").map(W=>parseInt(W)).slice(0,3):((0,n.warn)(`Not a valid color format: "${q}"`),[0,0,0])}function R(q){const W=document.createElement("span");W.style.visibility="hidden",document.body.append(W);for(const $ of q.keys()){W.style.color=$;const X=window.getComputedStyle(W).color;q.set($,k(X))}W.remove()}function H(q){const{a:W,b:$,c:X,d:it,e:lt,f:_t}=q.getTransform();return[W,$,X,it,lt,_t]}function Z(q){const{a:W,b:$,c:X,d:it,e:lt,f:_t}=q.getTransform().invertSelf();return[W,$,X,it,lt,_t]}},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var s=e(1);class n{constructor(){this.constructor===n&&(0,s.unreachable)("Cannot initialize BaseCanvasFactory.")}create(c,p){if(c<=0||p<=0)throw new Error("Invalid canvas size");const m=this._createCanvas(c,p);return{canvas:m,context:m.getContext("2d")}}reset(c,p,m){if(!c.canvas)throw new Error("Canvas is not specified");if(p<=0||m<=0)throw new Error("Invalid canvas size");c.canvas.width=p,c.canvas.height=m}destroy(c){if(!c.canvas)throw new Error("Canvas is not specified");c.canvas.width=0,c.canvas.height=0,c.canvas=null,c.context=null}_createCanvas(c,p){(0,s.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=n;class r{constructor({baseUrl:c=null,isCompressed:p=!1}){this.constructor===r&&(0,s.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=c,this.isCompressed=p}async fetch({name:c}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!c)throw new Error("CMap name must be specified.");const p=this.baseUrl+c+(this.isCompressed?".bcmap":""),m=this.isCompressed?s.CMapCompressionType.BINARY:s.CMapCompressionType.NONE;return this._fetchData(p,m).catch(_=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${p}`)})}_fetchData(c,p){(0,s.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=r;class a{constructor({baseUrl:c=null}){this.constructor===a&&(0,s.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=c}async fetch({filename:c}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!c)throw new Error("Font filename must be specified.");const p=`${this.baseUrl}${c}`;return this._fetchData(p).catch(m=>{throw new Error(`Unable to load font data at: ${p}`)})}_fetchData(c){(0,s.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=a;class o{constructor(){this.constructor===o&&(0,s.unreachable)("Cannot initialize BaseSVGFactory.")}create(c,p,m=!1){if(c<=0||p<=0)throw new Error("Invalid SVG dimensions");const _=this._createSVG("svg:svg");return _.setAttribute("version","1.1"),m||(_.setAttribute("width",`${c}px`),_.setAttribute("height",`${p}px`)),_.setAttribute("preserveAspectRatio","none"),_.setAttribute("viewBox",`0 0 ${c} ${p}`),_}createElement(c){if(typeof c!="string")throw new Error("Invalid SVG element type");return this._createSVG(c)}_createSVG(c){(0,s.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=o},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var s=e(1);const n=3285377520,r=4294901760,a=65535;class o{constructor(c){this.h1=c?c&4294967295:n,this.h2=c?c&4294967295:n}update(c){let p,m;if(typeof c=="string"){p=new Uint8Array(c.length*2),m=0;for(let v=0,w=c.length;v<w;v++){const C=c.charCodeAt(v);C<=255?p[m++]=C:(p[m++]=C>>>8,p[m++]=C&255)}}else if((0,s.isArrayBuffer)(c))p=c.slice(),m=p.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const _=m>>2,y=m-_*4,b=new Uint32Array(p.buffer,0,_);let u=0,g=0,x=this.h1,P=this.h2;const A=3432918353,h=461845907,d=A&a,f=h&a;for(let v=0;v<_;v++)v&1?(u=b[v],u=u*A&r|u*d&a,u=u<<15|u>>>17,u=u*h&r|u*f&a,x^=u,x=x<<13|x>>>19,x=x*5+3864292196):(g=b[v],g=g*A&r|g*d&a,g=g<<15|g>>>17,g=g*h&r|g*f&a,P^=g,P=P<<13|P>>>19,P=P*5+3864292196);switch(u=0,y){case 3:u^=p[_*4+2]<<16;case 2:u^=p[_*4+1]<<8;case 1:u^=p[_*4],u=u*A&r|u*d&a,u=u<<15|u>>>17,u=u*h&r|u*f&a,_&1?x^=u:P^=u}this.h1=x,this.h2=P}hexdigest(){let c=this.h1,p=this.h2;c^=p>>>1,c=c*3981806797&r|c*36045&a,p=p*4283543511&r|((p<<16|c>>>16)*2950163797&r)>>>16,c^=p>>>1,c=c*444984403&r|c*60499&a,p=p*3301882366&r|((p<<16|c>>>16)*3120437893&r)>>>16,c^=p>>>1;const m=(c>>>0).toString(16),_=(p>>>0).toString(16);return m.padStart(8,"0")+_.padStart(8,"0")}}t.MurmurHash3_64=o},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var s=e(1);class n{constructor({docId:l,onUnsupportedFeature:c,ownerDocument:p=globalThis.document,styleElement:m=null}){this.constructor===n&&(0,s.unreachable)("Cannot initialize BaseFontLoader."),this.docId=l,this._onUnsupportedFeature=c,this._document=p,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(l){this.nativeFontFaces.push(l),this._document.fonts.add(l)}insertRule(l){let c=this.styleElement;c||(c=this.styleElement=this._document.createElement("style"),c.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(c));const p=c.sheet;p.insertRule(l,p.cssRules.length)}clear(){for(const l of this.nativeFontFaces)this._document.fonts.delete(l);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(l){if(l.attached||l.missingFile)return;if(l.attached=!0,this.isFontLoadingAPISupported){const p=l.createNativeFontFace();if(p){this.addNativeFontFace(p);try{await p.loaded}catch(m){throw this._onUnsupportedFeature({featureId:s.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,s.warn)(`Failed to load font '${p.family}': '${m}'.`),l.disableFontFace=!0,m}}return}const c=l.createFontFaceRule();if(c){if(this.insertRule(c),this.isSyncFontLoadingSupported)return;await new Promise(p=>{const m=this._queueLoadingCallback(p);this._prepareFontLoadEvent([c],[l],m)})}}_queueLoadingCallback(l){(0,s.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var c;const l=!!((c=this._document)!=null&&c.fonts);return(0,s.shadow)(this,"isFontLoadingAPISupported",l)}get isSyncFontLoadingSupported(){(0,s.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,s.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(l,c,p){(0,s.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let r;t.FontLoader=r,t.FontLoader=r=class extends n{constructor(l){super(l),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let l=!1;if(typeof navigator>"u")l=!0;else{const c=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(c==null?void 0:c[1])>=14&&(l=!0)}return(0,s.shadow)(this,"isSyncFontLoadingSupported",l)}_queueLoadingCallback(l){function c(){for((0,s.assert)(!m.done,"completeRequest() cannot be called twice."),m.done=!0;p.requests.length>0&&p.requests[0].done;){const _=p.requests.shift();setTimeout(_.callback,0)}}const p=this.loadingContext,m={id:`pdfjs-font-loading-${p.nextRequestId++}`,done:!1,complete:c,callback:l};return p.requests.push(m),m}get _loadTestFont(){const l=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,s.shadow)(this,"_loadTestFont",l())}_prepareFontLoadEvent(l,c,p){function m(Z,K){return Z.charCodeAt(K)<<24|Z.charCodeAt(K+1)<<16|Z.charCodeAt(K+2)<<8|Z.charCodeAt(K+3)&255}function _(Z,K,q,W){const $=Z.substring(0,K),X=Z.substring(K+q);return $+W+X}let y,b;const u=this._document.createElement("canvas");u.width=1,u.height=1;const g=u.getContext("2d");let x=0;function P(Z,K){if(x++,x>30){(0,s.warn)("Load test font never loaded."),K();return}if(g.font="30px "+Z,g.fillText(".",0,20),g.getImageData(0,0,1,1).data[3]>0){K();return}setTimeout(P.bind(null,Z,K))}const A=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=_(h,976,A.length,A);const f=16,v=1482184792;let w=m(h,f);for(y=0,b=A.length-3;y<b;y+=4)w=w-v+m(A,y)|0;y<A.length&&(w=w-v+m(A+"XXX",y)|0),h=_(h,f,4,(0,s.string32)(w));const C=`url(data:font/opentype;base64,${btoa(h)});`,k=`@font-face {font-family:"${A}";src:${C}}`;this.insertRule(k);const R=[];for(const Z of c)R.push(Z.loadedName);R.push(A);const H=this._document.createElement("div");H.style.visibility="hidden",H.style.width=H.style.height="10px",H.style.position="absolute",H.style.top=H.style.left="0px";for(const Z of R){const K=this._document.createElement("span");K.textContent="Hi",K.style.fontFamily=Z,H.append(K)}this._document.body.append(H),P(A,()=>{H.remove(),p.complete()})}};class a{constructor(l,{isEvalSupported:c=!0,disableFontFace:p=!1,ignoreErrors:m=!1,onUnsupportedFeature:_,fontRegistry:y=null}){this.compiledGlyphs=Object.create(null);for(const b in l)this[b]=l[b];this.isEvalSupported=c!==!1,this.disableFontFace=p===!0,this.ignoreErrors=m===!0,this._onUnsupportedFeature=_,this.fontRegistry=y}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let l;if(!this.cssFontInfo)l=new FontFace(this.loadedName,this.data,{});else{const c={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(c.style=`oblique ${this.cssFontInfo.italicAngle}deg`),l=new FontFace(this.cssFontInfo.fontFamily,this.data,c)}return this.fontRegistry&&this.fontRegistry.registerFont(this),l}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const l=(0,s.bytesToString)(this.data),c=`url(data:${this.mimetype};base64,${btoa(l)});`;let p;if(!this.cssFontInfo)p=`@font-face {font-family:"${this.loadedName}";src:${c}}`;else{let m=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(m+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),p=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${m}src:${c}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,c),p}getPathGenerator(l,c){if(this.compiledGlyphs[c]!==void 0)return this.compiledGlyphs[c];let p;try{p=l.get(this.loadedName+"_path_"+c)}catch(m){if(!this.ignoreErrors)throw m;return this._onUnsupportedFeature({featureId:s.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,s.warn)(`getPathGenerator - ignoring character: "${m}".`),this.compiledGlyphs[c]=function(_,y){}}if(this.isEvalSupported&&s.FeatureTest.isEvalSupported){const m=[];for(const _ of p){const y=_.args!==void 0?_.args.join(","):"";m.push("c.",_.cmd,"(",y,`);
`)}return this.compiledGlyphs[c]=new Function("c","size",m.join(""))}return this.compiledGlyphs[c]=function(m,_){for(const y of p)y.cmd==="scale"&&(y.args=[_,-_]),m[y.cmd].apply(m,y.args)}}}t.FontFaceObject=a},(i,t,e)=>{var it,he;Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var s=e(8),n=e(1),r=e(13),a=e(14),o=e(3);const l=16,c=100,p=4096,m=15,_=10,y=o.isNodeJS&&typeof Path2D>"u"?-1:1e3,b=16;function u(z,E){if(z._removeMirroring)throw new Error("Context is already forwarding operations.");z.__originalSave=z.save,z.__originalRestore=z.restore,z.__originalRotate=z.rotate,z.__originalScale=z.scale,z.__originalTranslate=z.translate,z.__originalTransform=z.transform,z.__originalSetTransform=z.setTransform,z.__originalResetTransform=z.resetTransform,z.__originalClip=z.clip,z.__originalMoveTo=z.moveTo,z.__originalLineTo=z.lineTo,z.__originalBezierCurveTo=z.bezierCurveTo,z.__originalRect=z.rect,z.__originalClosePath=z.closePath,z.__originalBeginPath=z.beginPath,z._removeMirroring=()=>{z.save=z.__originalSave,z.restore=z.__originalRestore,z.rotate=z.__originalRotate,z.scale=z.__originalScale,z.translate=z.__originalTranslate,z.transform=z.__originalTransform,z.setTransform=z.__originalSetTransform,z.resetTransform=z.__originalResetTransform,z.clip=z.__originalClip,z.moveTo=z.__originalMoveTo,z.lineTo=z.__originalLineTo,z.bezierCurveTo=z.__originalBezierCurveTo,z.rect=z.__originalRect,z.closePath=z.__originalClosePath,z.beginPath=z.__originalBeginPath,delete z._removeMirroring},z.save=function(){E.save(),this.__originalSave()},z.restore=function(){E.restore(),this.__originalRestore()},z.translate=function(O,N){E.translate(O,N),this.__originalTranslate(O,N)},z.scale=function(O,N){E.scale(O,N),this.__originalScale(O,N)},z.transform=function(O,N,j,U,J,Q){E.transform(O,N,j,U,J,Q),this.__originalTransform(O,N,j,U,J,Q)},z.setTransform=function(O,N,j,U,J,Q){E.setTransform(O,N,j,U,J,Q),this.__originalSetTransform(O,N,j,U,J,Q)},z.resetTransform=function(){E.resetTransform(),this.__originalResetTransform()},z.rotate=function(O){E.rotate(O),this.__originalRotate(O)},z.clip=function(O){E.clip(O),this.__originalClip(O)},z.moveTo=function(T,O){E.moveTo(T,O),this.__originalMoveTo(T,O)},z.lineTo=function(T,O){E.lineTo(T,O),this.__originalLineTo(T,O)},z.bezierCurveTo=function(T,O,N,j,U,J){E.bezierCurveTo(T,O,N,j,U,J),this.__originalBezierCurveTo(T,O,N,j,U,J)},z.rect=function(T,O,N,j){E.rect(T,O,N,j),this.__originalRect(T,O,N,j)},z.closePath=function(){E.closePath(),this.__originalClosePath()},z.beginPath=function(){E.beginPath(),this.__originalBeginPath()}}class g{constructor(E){this.canvasFactory=E,this.cache=Object.create(null)}getCanvas(E,T,O){let N;return this.cache[E]!==void 0?(N=this.cache[E],this.canvasFactory.reset(N,T,O)):(N=this.canvasFactory.create(T,O),this.cache[E]=N),N}delete(E){delete this.cache[E]}clear(){for(const E in this.cache){const T=this.cache[E];this.canvasFactory.destroy(T),delete this.cache[E]}}}function x(z,E,T,O,N,j,U,J,Q,S){const[M,D,F,L,V,nt]=(0,s.getCurrentTransform)(z);if(D===0&&F===0){const ot=U*M+V,st=Math.round(ot),ct=J*L+nt,pt=Math.round(ct),B=(U+Q)*M+V,ut=Math.abs(Math.round(B)-st)||1,xt=(J+S)*L+nt,At=Math.abs(Math.round(xt)-pt)||1;return z.setTransform(Math.sign(M),0,0,Math.sign(L),st,pt),z.drawImage(E,T,O,N,j,0,0,ut,At),z.setTransform(M,D,F,L,V,nt),[ut,At]}if(M===0&&L===0){const ot=J*F+V,st=Math.round(ot),ct=U*D+nt,pt=Math.round(ct),B=(J+S)*F+V,ut=Math.abs(Math.round(B)-st)||1,xt=(U+Q)*D+nt,At=Math.abs(Math.round(xt)-pt)||1;return z.setTransform(0,Math.sign(D),Math.sign(F),0,st,pt),z.drawImage(E,T,O,N,j,0,0,At,ut),z.setTransform(M,D,F,L,V,nt),[At,ut]}z.drawImage(E,T,O,N,j,U,J,Q,S);const dt=Math.hypot(M,D),et=Math.hypot(F,L);return[dt*Q,et*S]}function P(z){const{width:E,height:T}=z;if(E>y||T>y)return null;const O=1e3,N=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),j=E+1;let U=new Uint8Array(j*(T+1)),J,Q,S;const M=E+7&-8;let D=new Uint8Array(M*T),F=0;for(const et of z.data){let ot=128;for(;ot>0;)D[F++]=et&ot?0:255,ot>>=1}let L=0;for(F=0,D[F]!==0&&(U[0]=1,++L),Q=1;Q<E;Q++)D[F]!==D[F+1]&&(U[Q]=D[F]?2:1,++L),F++;for(D[F]!==0&&(U[Q]=2,++L),J=1;J<T;J++){F=J*M,S=J*j,D[F-M]!==D[F]&&(U[S]=D[F]?1:8,++L);let et=(D[F]?4:0)+(D[F-M]?8:0);for(Q=1;Q<E;Q++)et=(et>>2)+(D[F+1]?4:0)+(D[F-M+1]?8:0),N[et]&&(U[S+Q]=N[et],++L),F++;if(D[F-M]!==D[F]&&(U[S+Q]=D[F]?2:4,++L),L>O)return null}for(F=M*(T-1),S=J*j,D[F]!==0&&(U[S]=8,++L),Q=1;Q<E;Q++)D[F]!==D[F+1]&&(U[S+Q]=D[F]?4:8,++L),F++;if(D[F]!==0&&(U[S+Q]=4,++L),L>O)return null;const V=new Int32Array([0,j,-1,0,-j,0,0,0,1]),nt=new Path2D;for(J=0;L&&J<=T;J++){let et=J*j;const ot=et+E;for(;et<ot&&!U[et];)et++;if(et===ot)continue;nt.moveTo(et%j,J);const st=et;let ct=U[et];do{const pt=V[ct];do et+=pt;while(!U[et]);const B=U[et];B!==5&&B!==10?(ct=B,U[et]=0):(ct=B&51*ct>>4,U[et]&=ct>>2|ct<<2),nt.lineTo(et%j,et/j|0),U[et]||--L}while(st!==et);--J}return D=null,U=null,function(et){et.save(),et.scale(1/E,-1/T),et.translate(0,-T),et.fill(nt),et.beginPath(),et.restore()}}class A{constructor(E,T){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,E,T])}clone(){const E=Object.create(this);return E.clipBox=this.clipBox.slice(),E}setCurrentPoint(E,T){this.x=E,this.y=T}updatePathMinMax(E,T,O){[T,O]=n.Util.applyTransform([T,O],E),this.minX=Math.min(this.minX,T),this.minY=Math.min(this.minY,O),this.maxX=Math.max(this.maxX,T),this.maxY=Math.max(this.maxY,O)}updateRectMinMax(E,T){const O=n.Util.applyTransform(T,E),N=n.Util.applyTransform(T.slice(2),E);this.minX=Math.min(this.minX,O[0],N[0]),this.minY=Math.min(this.minY,O[1],N[1]),this.maxX=Math.max(this.maxX,O[0],N[0]),this.maxY=Math.max(this.maxY,O[1],N[1])}updateScalingPathMinMax(E,T){n.Util.scaleMinMax(E,T),this.minX=Math.min(this.minX,T[0]),this.maxX=Math.max(this.maxX,T[1]),this.minY=Math.min(this.minY,T[2]),this.maxY=Math.max(this.maxY,T[3])}updateCurvePathMinMax(E,T,O,N,j,U,J,Q,S,M){const D=n.Util.bezierBoundingBox(T,O,N,j,U,J,Q,S);if(M){M[0]=Math.min(M[0],D[0],D[2]),M[1]=Math.max(M[1],D[0],D[2]),M[2]=Math.min(M[2],D[1],D[3]),M[3]=Math.max(M[3],D[1],D[3]);return}this.updateRectMinMax(E,D)}getPathBoundingBox(E=r.PathType.FILL,T=null){const O=[this.minX,this.minY,this.maxX,this.maxY];if(E===r.PathType.STROKE){T||(0,n.unreachable)("Stroke bounding box must include transform.");const N=n.Util.singularValueDecompose2dScale(T),j=N[0]*this.lineWidth/2,U=N[1]*this.lineWidth/2;O[0]-=j,O[1]-=U,O[2]+=j,O[3]+=U}return O}updateClipFromPath(){const E=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(E||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(E){this.clipBox=E,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(E=r.PathType.FILL,T=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(E,T))}}function h(z,E,T=null){if(typeof ImageData<"u"&&E instanceof ImageData){z.putImageData(E,0,0);return}const O=E.height,N=E.width,j=O%b,U=(O-j)/b,J=j===0?U:U+1,Q=z.createImageData(N,b);let S=0,M;const D=E.data,F=Q.data;let L,V,nt,dt,et,ot,st,ct;if(T)switch(T.length){case 1:et=T[0],ot=T[0],st=T[0],ct=T[0];break;case 4:et=T[0],ot=T[1],st=T[2],ct=T[3];break}if(E.kind===n.ImageKind.GRAYSCALE_1BPP){const pt=D.byteLength,B=new Uint32Array(F.buffer,0,F.byteLength>>2),ut=B.length,xt=N+7>>3;let At=4294967295,wt=n.FeatureTest.isLittleEndian?4278190080:255;for(ct&&ct[0]===255&&ct[255]===0&&([At,wt]=[wt,At]),L=0;L<J;L++){for(nt=L<U?b:j,M=0,V=0;V<nt;V++){const kt=pt-S;let Dt=0;const Rt=kt>xt?N:kt*8-7,$t=Rt&-8;let Pt=0,Ft=0;for(;Dt<$t;Dt+=8)Ft=D[S++],B[M++]=Ft&128?At:wt,B[M++]=Ft&64?At:wt,B[M++]=Ft&32?At:wt,B[M++]=Ft&16?At:wt,B[M++]=Ft&8?At:wt,B[M++]=Ft&4?At:wt,B[M++]=Ft&2?At:wt,B[M++]=Ft&1?At:wt;for(;Dt<Rt;Dt++)Pt===0&&(Ft=D[S++],Pt=128),B[M++]=Ft&Pt?At:wt,Pt>>=1}for(;M<ut;)B[M++]=0;z.putImageData(Q,0,L*b)}}else if(E.kind===n.ImageKind.RGBA_32BPP){const pt=!!(et||ot||st);for(V=0,dt=N*b*4,L=0;L<U;L++){if(F.set(D.subarray(S,S+dt)),S+=dt,pt)for(let B=0;B<dt;B+=4)et&&(F[B+0]=et[F[B+0]]),ot&&(F[B+1]=ot[F[B+1]]),st&&(F[B+2]=st[F[B+2]]);z.putImageData(Q,0,V),V+=b}if(L<J){if(dt=N*j*4,F.set(D.subarray(S,S+dt)),pt)for(let B=0;B<dt;B+=4)et&&(F[B+0]=et[F[B+0]]),ot&&(F[B+1]=ot[F[B+1]]),st&&(F[B+2]=st[F[B+2]]);z.putImageData(Q,0,V)}}else if(E.kind===n.ImageKind.RGB_24BPP){const pt=!!(et||ot||st);for(nt=b,dt=N*nt,L=0;L<J;L++){for(L>=U&&(nt=j,dt=N*nt),M=0,V=dt;V--;)F[M++]=D[S++],F[M++]=D[S++],F[M++]=D[S++],F[M++]=255;if(pt)for(let B=0;B<M;B+=4)et&&(F[B+0]=et[F[B+0]]),ot&&(F[B+1]=ot[F[B+1]]),st&&(F[B+2]=st[F[B+2]]);z.putImageData(Q,0,L*b)}}else throw new Error(`bad image kind: ${E.kind}`)}function d(z,E){if(E.bitmap){z.drawImage(E.bitmap,0,0);return}const T=E.height,O=E.width,N=T%b,j=(T-N)/b,U=N===0?j:j+1,J=z.createImageData(O,b);let Q=0;const S=E.data,M=J.data;for(let D=0;D<U;D++){const F=D<j?b:N;({srcPos:Q}=(0,a.applyMaskImageData)({src:S,srcPos:Q,dest:M,width:O,height:F})),z.putImageData(J,0,D*b)}}function f(z,E){const T=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let O=0,N=T.length;O<N;O++){const j=T[O];z[j]!==void 0&&(E[j]=z[j])}z.setLineDash!==void 0&&(E.setLineDash(z.getLineDash()),E.lineDashOffset=z.lineDashOffset)}function v(z,E){z.strokeStyle=z.fillStyle=E||"#000000",z.fillRule="nonzero",z.globalAlpha=1,z.lineWidth=1,z.lineCap="butt",z.lineJoin="miter",z.miterLimit=10,z.globalCompositeOperation="source-over",z.font="10px sans-serif",z.setLineDash!==void 0&&(z.setLineDash([]),z.lineDashOffset=0)}function w(z,E,T,O){const N=z.length;for(let j=3;j<N;j+=4){const U=z[j];if(U===0)z[j-3]=E,z[j-2]=T,z[j-1]=O;else if(U<255){const J=255-U;z[j-3]=z[j-3]*U+E*J>>8,z[j-2]=z[j-2]*U+T*J>>8,z[j-1]=z[j-1]*U+O*J>>8}}}function C(z,E,T){const O=z.length,N=1/255;for(let j=3;j<O;j+=4){const U=T?T[z[j]]:z[j];E[j]=E[j]*U*N|0}}function k(z,E,T){const O=z.length;for(let N=3;N<O;N+=4){const j=z[N-3]*77+z[N-2]*152+z[N-1]*28;E[N]=T?E[N]*T[j>>8]>>8:E[N]*j>>16}}function R(z,E,T,O,N,j,U,J,Q,S,M){const D=!!j,F=D?j[0]:0,L=D?j[1]:0,V=D?j[2]:0;let nt;N==="Luminosity"?nt=k:nt=C;const et=Math.min(O,Math.ceil(1048576/T));for(let ot=0;ot<O;ot+=et){const st=Math.min(et,O-ot),ct=z.getImageData(J-S,ot+(Q-M),T,st),pt=E.getImageData(J,ot+Q,T,st);D&&w(ct.data,F,L,V),nt(ct.data,pt.data,U),E.putImageData(pt,J,ot+Q)}}function H(z,E,T,O){const N=O[0],j=O[1],U=O[2]-N,J=O[3]-j;U===0||J===0||(R(E.context,T,U,J,E.subtype,E.backdrop,E.transferMap,N,j,E.offsetX,E.offsetY),z.save(),z.globalAlpha=1,z.globalCompositeOperation="source-over",z.setTransform(1,0,0,1,0,0),z.drawImage(T.canvas,0,0),z.restore())}function Z(z,E){const T=n.Util.singularValueDecompose2dScale(z);T[0]=Math.fround(T[0]),T[1]=Math.fround(T[1]);const O=Math.fround((globalThis.devicePixelRatio||1)*s.PixelsPerInch.PDF_TO_CSS_UNITS);return E!==void 0?E:T[0]<=O||T[1]<=O}const K=["butt","round","square"],q=["miter","round","bevel"],W={},$={},_t=class _t{constructor(E,T,O,N,j,U,J,Q){at(this,it);this.ctx=E,this.current=new A(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=T,this.objs=O,this.canvasFactory=N,this.imageLayer=j,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=U,this.cachedCanvases=new g(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=J,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(Q==null?void 0:Q.background)||null,this.foregroundColor=(Q==null?void 0:Q.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(E,T=null){return typeof E=="string"?E.startsWith("g_")?this.commonObjs.get(E):this.objs.get(E):T}beginDrawing({transform:E,viewport:T,transparency:O=!1,background:N=null}){const j=this.ctx.canvas.width,U=this.ctx.canvas.height,J=N||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const Q=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const S=this.backgroundColor=this.ctx.fillStyle;let M=!0,D=J;if(this.ctx.fillStyle=J,D=this.ctx.fillStyle,M=typeof D=="string"&&/^#[0-9A-Fa-f]{6}$/.test(D),Q==="#000000"&&S==="#ffffff"||Q===S||!M)this.foregroundColor=this.backgroundColor=null;else{const[F,L,V]=(0,s.getRGB)(D),nt=et=>(et/=255,et<=.03928?et/12.92:((et+.055)/1.055)**2.4),dt=Math.round(.2126*nt(F)+.7152*nt(L)+.0722*nt(V));this.selectColor=(et,ot,st)=>{const ct=.2126*nt(et)+.7152*nt(ot)+.0722*nt(st);return Math.round(ct)===dt?S:Q}}}if(this.ctx.fillStyle=this.backgroundColor||J,this.ctx.fillRect(0,0,j,U),this.ctx.restore(),O){const Q=this.cachedCanvases.getCanvas("transparent",j,U);this.compositeCtx=this.ctx,this.transparentCanvas=Q.canvas,this.ctx=Q.context,this.ctx.save(),this.ctx.transform(...(0,s.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),v(this.ctx,this.foregroundColor),E&&(this.ctx.transform(...E),this.outputScaleX=E[0],this.outputScaleY=E[0]),this.ctx.transform(...T.transform),this.viewportScale=T.scale,this.baseTransform=(0,s.getCurrentTransform)(this.ctx),this.imageLayer&&((0,s.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(E,T,O,N){const j=E.argsArray,U=E.fnArray;let J=T||0;const Q=j.length;if(Q===J)return J;const S=Q-J>_&&typeof O=="function",M=S?Date.now()+m:0;let D=0;const F=this.commonObjs,L=this.objs;let V;for(;;){if(N!==void 0&&J===N.nextBreakPoint)return N.breakIt(J,O),J;if(V=U[J],V!==n.OPS.dependency)this[V].apply(this,j[J]);else for(const nt of j[J]){const dt=nt.startsWith("g_")?F:L;if(!dt.has(nt))return dt.get(nt,O),J}if(J++,J===Q)return J;if(S&&++D>_){if(Date.now()>M)return O(),J;D=0}}}endDrawing(){ht(this,it,he).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const E of this._cachedBitmapsMap.values()){for(const T of E.values())typeof HTMLCanvasElement<"u"&&T instanceof HTMLCanvasElement&&(T.width=T.height=0);E.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(E,T){const O=E.width,N=E.height;let j=Math.max(Math.hypot(T[0],T[1]),1),U=Math.max(Math.hypot(T[2],T[3]),1),J=O,Q=N,S="prescale1",M,D;for(;j>2&&J>1||U>2&&Q>1;){let F=J,L=Q;j>2&&J>1&&(F=Math.ceil(J/2),j/=J/F),U>2&&Q>1&&(L=Math.ceil(Q/2),U/=Q/L),M=this.cachedCanvases.getCanvas(S,F,L),D=M.context,D.clearRect(0,0,F,L),D.drawImage(E,0,0,J,Q,0,0,F,L),E=M.canvas,J=F,Q=L,S=S==="prescale1"?"prescale2":"prescale1"}return{img:E,paintWidth:J,paintHeight:Q}}_createMaskCanvas(E){const T=this.ctx,{width:O,height:N}=E,j=this.current.fillColor,U=this.current.patternFill,J=(0,s.getCurrentTransform)(T);let Q,S,M,D;if((E.bitmap||E.data)&&E.count>1){const ut=E.bitmap||E.data.buffer,xt=J.slice(0,4);S=JSON.stringify(U?xt:[xt,j]),Q=this._cachedBitmapsMap.get(ut),Q||(Q=new Map,this._cachedBitmapsMap.set(ut,Q));const At=Q.get(S);if(At&&!U){const wt=Math.round(Math.min(J[0],J[2])+J[4]),kt=Math.round(Math.min(J[1],J[3])+J[5]);return{canvas:At,offsetX:wt,offsetY:kt}}M=At}M||(D=this.cachedCanvases.getCanvas("maskCanvas",O,N),d(D.context,E));let F=n.Util.transform(J,[1/O,0,0,-1/N,0,0]);F=n.Util.transform(F,[1,0,0,1,0,-N]);const L=n.Util.applyTransform([0,0],F),V=n.Util.applyTransform([O,N],F),nt=n.Util.normalizeRect([L[0],L[1],V[0],V[1]]),dt=Math.round(nt[2]-nt[0])||1,et=Math.round(nt[3]-nt[1])||1,ot=this.cachedCanvases.getCanvas("fillCanvas",dt,et),st=ot.context,ct=Math.min(L[0],V[0]),pt=Math.min(L[1],V[1]);st.translate(-ct,-pt),st.transform(...F),M||(M=this._scaleImage(D.canvas,(0,s.getCurrentTransformInverse)(st)),M=M.img,Q&&U&&Q.set(S,M)),st.imageSmoothingEnabled=Z((0,s.getCurrentTransform)(st),E.interpolate),x(st,M,0,0,M.width,M.height,0,0,O,N),st.globalCompositeOperation="source-in";const B=n.Util.transform((0,s.getCurrentTransformInverse)(st),[1,0,0,1,-ct,-pt]);return st.fillStyle=U?j.getPattern(T,this,B,r.PathType.FILL):j,st.fillRect(0,0,O,N),Q&&!U&&(this.cachedCanvases.delete("fillCanvas"),Q.set(S,ot.canvas)),{canvas:ot.canvas,offsetX:Math.round(ct),offsetY:Math.round(pt)}}setLineWidth(E){E!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=E,this.ctx.lineWidth=E}setLineCap(E){this.ctx.lineCap=K[E]}setLineJoin(E){this.ctx.lineJoin=q[E]}setMiterLimit(E){this.ctx.miterLimit=E}setDash(E,T){const O=this.ctx;O.setLineDash!==void 0&&(O.setLineDash(E),O.lineDashOffset=T)}setRenderingIntent(E){}setFlatness(E){}setGState(E){for(let T=0,O=E.length;T<O;T++){const N=E[T],j=N[0],U=N[1];switch(j){case"LW":this.setLineWidth(U);break;case"LC":this.setLineCap(U);break;case"LJ":this.setLineJoin(U);break;case"ML":this.setMiterLimit(U);break;case"D":this.setDash(U[0],U[1]);break;case"RI":this.setRenderingIntent(U);break;case"FL":this.setFlatness(U);break;case"Font":this.setFont(U[0],U[1]);break;case"CA":this.current.strokeAlpha=N[1];break;case"ca":this.current.fillAlpha=N[1],this.ctx.globalAlpha=N[1];break;case"BM":this.ctx.globalCompositeOperation=U;break;case"SMask":this.current.activeSMask=U?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=U}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const E=this.inSMaskMode;this.current.activeSMask&&!E?this.beginSMaskMode():!this.current.activeSMask&&E&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const E=this.ctx.canvas.width,T=this.ctx.canvas.height,O="smaskGroupAt"+this.groupLevel,N=this.cachedCanvases.getCanvas(O,E,T);this.suspendedCtx=this.ctx,this.ctx=N.context;const j=this.ctx;j.setTransform(...(0,s.getCurrentTransform)(this.suspendedCtx)),f(this.suspendedCtx,j),u(j,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),f(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(E){if(!this.current.activeSMask)return;E?(E[0]=Math.floor(E[0]),E[1]=Math.floor(E[1]),E[2]=Math.ceil(E[2]),E[3]=Math.ceil(E[3])):E=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const T=this.current.activeSMask,O=this.suspendedCtx;H(O,T,this.ctx,E),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(f(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const E=this.current;this.stateStack.push(E),this.current=E.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),f(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(E,T,O,N,j,U){this.ctx.transform(E,T,O,N,j,U),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(E,T,O){const N=this.ctx,j=this.current;let U=j.x,J=j.y,Q,S;const M=(0,s.getCurrentTransform)(N),D=M[0]===0&&M[3]===0||M[1]===0&&M[2]===0,F=D?O.slice(0):null;for(let L=0,V=0,nt=E.length;L<nt;L++)switch(E[L]|0){case n.OPS.rectangle:U=T[V++],J=T[V++];const dt=T[V++],et=T[V++],ot=U+dt,st=J+et;N.moveTo(U,J),dt===0||et===0?N.lineTo(ot,st):(N.lineTo(ot,J),N.lineTo(ot,st),N.lineTo(U,st)),D||j.updateRectMinMax(M,[U,J,ot,st]),N.closePath();break;case n.OPS.moveTo:U=T[V++],J=T[V++],N.moveTo(U,J),D||j.updatePathMinMax(M,U,J);break;case n.OPS.lineTo:U=T[V++],J=T[V++],N.lineTo(U,J),D||j.updatePathMinMax(M,U,J);break;case n.OPS.curveTo:Q=U,S=J,U=T[V+4],J=T[V+5],N.bezierCurveTo(T[V],T[V+1],T[V+2],T[V+3],U,J),j.updateCurvePathMinMax(M,Q,S,T[V],T[V+1],T[V+2],T[V+3],U,J,F),V+=6;break;case n.OPS.curveTo2:Q=U,S=J,N.bezierCurveTo(U,J,T[V],T[V+1],T[V+2],T[V+3]),j.updateCurvePathMinMax(M,Q,S,U,J,T[V],T[V+1],T[V+2],T[V+3],F),U=T[V+2],J=T[V+3],V+=4;break;case n.OPS.curveTo3:Q=U,S=J,U=T[V+2],J=T[V+3],N.bezierCurveTo(T[V],T[V+1],U,J,U,J),j.updateCurvePathMinMax(M,Q,S,T[V],T[V+1],U,J,U,J,F),V+=4;break;case n.OPS.closePath:N.closePath();break}D&&j.updateScalingPathMinMax(M,F),j.setCurrentPoint(U,J)}closePath(){this.ctx.closePath()}stroke(E){E=typeof E<"u"?E:!0;const T=this.ctx,O=this.current.strokeColor;T.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof O=="object"&&(O!=null&&O.getPattern)?(T.save(),T.strokeStyle=O.getPattern(T,this,(0,s.getCurrentTransformInverse)(T),r.PathType.STROKE),this.rescaleAndStroke(!1),T.restore()):this.rescaleAndStroke(!0)),E&&this.consumePath(this.current.getClippedPathBoundingBox()),T.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(E){E=typeof E<"u"?E:!0;const T=this.ctx,O=this.current.fillColor,N=this.current.patternFill;let j=!1;N&&(T.save(),T.fillStyle=O.getPattern(T,this,(0,s.getCurrentTransformInverse)(T),r.PathType.FILL),j=!0);const U=this.current.getClippedPathBoundingBox();this.contentVisible&&U!==null&&(this.pendingEOFill?(T.fill("evenodd"),this.pendingEOFill=!1):T.fill()),j&&T.restore(),E&&this.consumePath(U)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=W}eoClip(){this.pendingClip=$}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const E=this.pendingTextPaths,T=this.ctx;if(E===void 0){T.beginPath();return}T.save(),T.beginPath();for(const O of E)T.setTransform(...O.transform),T.translate(O.x,O.y),O.addToPath(T,O.fontSize);T.restore(),T.clip(),T.beginPath(),delete this.pendingTextPaths}setCharSpacing(E){this.current.charSpacing=E}setWordSpacing(E){this.current.wordSpacing=E}setHScale(E){this.current.textHScale=E/100}setLeading(E){this.current.leading=-E}setFont(E,T){const O=this.commonObjs.get(E),N=this.current;if(!O)throw new Error(`Can't find font for ${E}`);if(N.fontMatrix=O.fontMatrix||n.FONT_IDENTITY_MATRIX,(N.fontMatrix[0]===0||N.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+E),T<0?(T=-T,N.fontDirection=-1):N.fontDirection=1,this.current.font=O,this.current.fontSize=T,O.isType3Font)return;const j=O.loadedName||"sans-serif";let U="normal";O.black?U="900":O.bold&&(U="bold");const J=O.italic?"italic":"normal",Q=`"${j}", ${O.fallbackName}`;let S=T;T<l?S=l:T>c&&(S=c),this.current.fontSizeScale=T/S,this.ctx.font=`${J} ${U} ${S}px ${Q}`}setTextRenderingMode(E){this.current.textRenderingMode=E}setTextRise(E){this.current.textRise=E}moveText(E,T){this.current.x=this.current.lineX+=E,this.current.y=this.current.lineY+=T}setLeadingMoveText(E,T){this.setLeading(-T),this.moveText(E,T)}setTextMatrix(E,T,O,N,j,U){this.current.textMatrix=[E,T,O,N,j,U],this.current.textMatrixScale=Math.hypot(E,T),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(E,T,O,N){const j=this.ctx,U=this.current,J=U.font,Q=U.textRenderingMode,S=U.fontSize/U.fontSizeScale,M=Q&n.TextRenderingMode.FILL_STROKE_MASK,D=!!(Q&n.TextRenderingMode.ADD_TO_PATH_FLAG),F=U.patternFill&&!J.missingFile;let L;(J.disableFontFace||D||F)&&(L=J.getPathGenerator(this.commonObjs,E)),J.disableFontFace||F?(j.save(),j.translate(T,O),j.beginPath(),L(j,S),N&&j.setTransform(...N),(M===n.TextRenderingMode.FILL||M===n.TextRenderingMode.FILL_STROKE)&&j.fill(),(M===n.TextRenderingMode.STROKE||M===n.TextRenderingMode.FILL_STROKE)&&j.stroke(),j.restore()):((M===n.TextRenderingMode.FILL||M===n.TextRenderingMode.FILL_STROKE)&&j.fillText(E,T,O),(M===n.TextRenderingMode.STROKE||M===n.TextRenderingMode.FILL_STROKE)&&j.strokeText(E,T,O)),D&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,s.getCurrentTransform)(j),x:T,y:O,fontSize:S,addToPath:L})}get isFontSubpixelAAEnabled(){const{context:E}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);E.scale(1.5,1),E.fillText("I",0,10);const T=E.getImageData(0,0,10,10).data;let O=!1;for(let N=3;N<T.length;N+=4)if(T[N]>0&&T[N]<255){O=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",O)}showText(E){const T=this.current,O=T.font;if(O.isType3Font)return this.showType3Text(E);const N=T.fontSize;if(N===0)return;const j=this.ctx,U=T.fontSizeScale,J=T.charSpacing,Q=T.wordSpacing,S=T.fontDirection,M=T.textHScale*S,D=E.length,F=O.vertical,L=F?1:-1,V=O.defaultVMetrics,nt=N*T.fontMatrix[0],dt=T.textRenderingMode===n.TextRenderingMode.FILL&&!O.disableFontFace&&!T.patternFill;j.save(),j.transform(...T.textMatrix),j.translate(T.x,T.y+T.textRise),S>0?j.scale(M,-1):j.scale(M,1);let et;if(T.patternFill){j.save();const B=T.fillColor.getPattern(j,this,(0,s.getCurrentTransformInverse)(j),r.PathType.FILL);et=(0,s.getCurrentTransform)(j),j.restore(),j.fillStyle=B}let ot=T.lineWidth;const st=T.textMatrixScale;if(st===0||ot===0){const B=T.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(B===n.TextRenderingMode.STROKE||B===n.TextRenderingMode.FILL_STROKE)&&(ot=this.getSinglePixelWidth())}else ot/=st;U!==1&&(j.scale(U,U),ot/=U),j.lineWidth=ot;let ct=0,pt;for(pt=0;pt<D;++pt){const B=E[pt];if(typeof B=="number"){ct+=L*B*N/1e3;continue}let ut=!1;const xt=(B.isSpace?Q:0)+J,At=B.fontChar,wt=B.accent;let kt,Dt,Rt=B.width;if(F){const Pt=B.vmetric||V,Ft=-(B.vmetric?Pt[1]:Rt*.5)*nt,Zt=Pt[2]*nt;Rt=Pt?-Pt[0]:Rt,kt=Ft/U,Dt=(ct+Zt)/U}else kt=ct/U,Dt=0;if(O.remeasure&&Rt>0){const Pt=j.measureText(At).width*1e3/N*U;if(Rt<Pt&&this.isFontSubpixelAAEnabled){const Ft=Rt/Pt;ut=!0,j.save(),j.scale(Ft,1),kt/=Ft}else Rt!==Pt&&(kt+=(Rt-Pt)/2e3*N/U)}if(this.contentVisible&&(B.isInFont||O.missingFile)){if(dt&&!wt)j.fillText(At,kt,Dt);else if(this.paintChar(At,kt,Dt,et),wt){const Pt=kt+N*wt.offset.x/U,Ft=Dt-N*wt.offset.y/U;this.paintChar(wt.fontChar,Pt,Ft,et)}}let $t;F?$t=Rt*nt-xt*S:$t=Rt*nt+xt*S,ct+=$t,ut&&j.restore()}F?T.y-=ct:T.x+=ct*M,j.restore(),this.compose()}showType3Text(E){const T=this.ctx,O=this.current,N=O.font,j=O.fontSize,U=O.fontDirection,J=N.vertical?1:-1,Q=O.charSpacing,S=O.wordSpacing,M=O.textHScale*U,D=O.fontMatrix||n.FONT_IDENTITY_MATRIX,F=E.length,L=O.textRenderingMode===n.TextRenderingMode.INVISIBLE;let V,nt,dt,et;if(!(L||j===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,T.save(),T.transform(...O.textMatrix),T.translate(O.x,O.y),T.scale(M,U),V=0;V<F;++V){if(nt=E[V],typeof nt=="number"){et=J*nt*j/1e3,this.ctx.translate(et,0),O.x+=et*M;continue}const ot=(nt.isSpace?S:0)+Q,st=N.charProcOperatorList[nt.operatorListId];if(!st){(0,n.warn)(`Type3 character "${nt.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=nt,this.save(),T.scale(j,j),T.transform(...D),this.executeOperatorList(st),this.restore()),dt=n.Util.applyTransform([nt.width,0],D)[0]*j+ot,T.translate(dt,0),O.x+=dt*M}T.restore(),this.processingType3=null}}setCharWidth(E,T){}setCharWidthAndBounds(E,T,O,N,j,U){this.ctx.rect(O,N,j-O,U-N),this.ctx.clip(),this.endPath()}getColorN_Pattern(E){let T;if(E[0]==="TilingPattern"){const O=E[1],N=this.baseTransform||(0,s.getCurrentTransform)(this.ctx),j={createCanvasGraphics:U=>new _t(U,this.commonObjs,this.objs,this.canvasFactory)};T=new r.TilingPattern(E,O,this.ctx,j,N)}else T=this._getPattern(E[1],E[2]);return T}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(E,T,O){var j;const N=((j=this.selectColor)==null?void 0:j.call(this,E,T,O))||n.Util.makeHexColor(E,T,O);this.ctx.strokeStyle=N,this.current.strokeColor=N}setFillRGBColor(E,T,O){var j;const N=((j=this.selectColor)==null?void 0:j.call(this,E,T,O))||n.Util.makeHexColor(E,T,O);this.ctx.fillStyle=N,this.current.fillColor=N,this.current.patternFill=!1}_getPattern(E,T=null){let O;return this.cachedPatterns.has(E)?O=this.cachedPatterns.get(E):(O=(0,r.getShadingPattern)(this.objs.get(E)),this.cachedPatterns.set(E,O)),T&&(O.matrix=T),O}shadingFill(E){if(!this.contentVisible)return;const T=this.ctx;this.save();const O=this._getPattern(E);T.fillStyle=O.getPattern(T,this,(0,s.getCurrentTransformInverse)(T),r.PathType.SHADING);const N=(0,s.getCurrentTransformInverse)(T);if(N){const j=T.canvas,U=j.width,J=j.height,Q=n.Util.applyTransform([0,0],N),S=n.Util.applyTransform([0,J],N),M=n.Util.applyTransform([U,0],N),D=n.Util.applyTransform([U,J],N),F=Math.min(Q[0],S[0],M[0],D[0]),L=Math.min(Q[1],S[1],M[1],D[1]),V=Math.max(Q[0],S[0],M[0],D[0]),nt=Math.max(Q[1],S[1],M[1],D[1]);this.ctx.fillRect(F,L,V-F,nt-L)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(E,T){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(E)&&E.length===6&&this.transform(...E),this.baseTransform=(0,s.getCurrentTransform)(this.ctx),T)){const O=T[2]-T[0],N=T[3]-T[1];this.ctx.rect(T[0],T[1],O,N),this.current.updateRectMinMax((0,s.getCurrentTransform)(this.ctx),T),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(E){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const T=this.ctx;E.isolated||(0,n.info)("TODO: Support non-isolated groups."),E.knockout&&(0,n.warn)("Knockout groups not supported.");const O=(0,s.getCurrentTransform)(T);if(E.matrix&&T.transform(...E.matrix),!E.bbox)throw new Error("Bounding box is required.");let N=n.Util.getAxialAlignedBoundingBox(E.bbox,(0,s.getCurrentTransform)(T));const j=[0,0,T.canvas.width,T.canvas.height];N=n.Util.intersect(N,j)||[0,0,0,0];const U=Math.floor(N[0]),J=Math.floor(N[1]);let Q=Math.max(Math.ceil(N[2])-U,1),S=Math.max(Math.ceil(N[3])-J,1),M=1,D=1;Q>p&&(M=Q/p,Q=p),S>p&&(D=S/p,S=p),this.current.startNewPathAndClipBox([0,0,Q,S]);let F="groupAt"+this.groupLevel;E.smask&&(F+="_smask_"+this.smaskCounter++%2);const L=this.cachedCanvases.getCanvas(F,Q,S),V=L.context;V.scale(1/M,1/D),V.translate(-U,-J),V.transform(...O),E.smask?this.smaskStack.push({canvas:L.canvas,context:V,offsetX:U,offsetY:J,scaleX:M,scaleY:D,subtype:E.smask.subtype,backdrop:E.smask.backdrop,transferMap:E.smask.transferMap||null,startTransformInverse:null}):(T.setTransform(1,0,0,1,0,0),T.translate(U,J),T.scale(M,D),T.save()),f(T,V),this.ctx=V,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(T),this.groupLevel++}endGroup(E){if(!this.contentVisible)return;this.groupLevel--;const T=this.ctx,O=this.groupStack.pop();if(this.ctx=O,this.ctx.imageSmoothingEnabled=!1,E.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const N=(0,s.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...N);const j=n.Util.getAxialAlignedBoundingBox([0,0,T.canvas.width,T.canvas.height],N);this.ctx.drawImage(T.canvas,0,0),this.ctx.restore(),this.compose(j)}}beginAnnotation(E,T,O,N,j){if(ht(this,it,he).call(this),v(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(T)&&T.length===4){const U=T[2]-T[0],J=T[3]-T[1];if(j&&this.annotationCanvasMap){O=O.slice(),O[4]-=T[0],O[5]-=T[1],T=T.slice(),T[0]=T[1]=0,T[2]=U,T[3]=J;const[Q,S]=n.Util.singularValueDecompose2dScale((0,s.getCurrentTransform)(this.ctx)),{viewportScale:M}=this,D=Math.ceil(U*this.outputScaleX*M),F=Math.ceil(J*this.outputScaleY*M);this.annotationCanvas=this.canvasFactory.create(D,F);const{canvas:L,context:V}=this.annotationCanvas;this.annotationCanvasMap.set(E,L),this.annotationCanvas.savedCtx=this.ctx,this.ctx=V,this.ctx.setTransform(Q,0,0,-S,0,J*S),v(this.ctx,this.foregroundColor)}else v(this.ctx,this.foregroundColor),this.ctx.rect(T[0],T[1],U,J),this.ctx.clip(),this.endPath()}this.current=new A(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...O),this.transform(...N)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(E){if(!this.contentVisible)return;const T=E.count;E=this.getObject(E.data,E),E.count=T;const O=this.ctx,N=this.processingType3;if(N&&(N.compiled===void 0&&(N.compiled=P(E)),N.compiled)){N.compiled(O);return}const j=this._createMaskCanvas(E),U=j.canvas;O.save(),O.setTransform(1,0,0,1,0,0),O.drawImage(U,j.offsetX,j.offsetY),O.restore(),this.compose()}paintImageMaskXObjectRepeat(E,T,O=0,N=0,j,U){if(!this.contentVisible)return;E=this.getObject(E.data,E);const J=this.ctx;J.save();const Q=(0,s.getCurrentTransform)(J);J.transform(T,O,N,j,0,0);const S=this._createMaskCanvas(E);J.setTransform(1,0,0,1,0,0);for(let M=0,D=U.length;M<D;M+=2){const F=n.Util.transform(Q,[T,O,N,j,U[M],U[M+1]]),[L,V]=n.Util.applyTransform([0,0],F);J.drawImage(S.canvas,L,V)}J.restore(),this.compose()}paintImageMaskXObjectGroup(E){if(!this.contentVisible)return;const T=this.ctx,O=this.current.fillColor,N=this.current.patternFill;for(const j of E){const{data:U,width:J,height:Q,transform:S}=j,M=this.cachedCanvases.getCanvas("maskCanvas",J,Q),D=M.context;D.save();const F=this.getObject(U,j);d(D,F),D.globalCompositeOperation="source-in",D.fillStyle=N?O.getPattern(D,this,(0,s.getCurrentTransformInverse)(T),r.PathType.FILL):O,D.fillRect(0,0,J,Q),D.restore(),T.save(),T.transform(...S),T.scale(1,-1),x(T,M.canvas,0,0,J,Q,0,-1,1,1),T.restore()}this.compose()}paintImageXObject(E){if(!this.contentVisible)return;const T=this.getObject(E);if(!T){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(T)}paintImageXObjectRepeat(E,T,O,N){if(!this.contentVisible)return;const j=this.getObject(E);if(!j){(0,n.warn)("Dependent image isn't ready yet");return}const U=j.width,J=j.height,Q=[];for(let S=0,M=N.length;S<M;S+=2)Q.push({transform:[T,0,0,O,N[S],N[S+1]],x:0,y:0,w:U,h:J});this.paintInlineImageXObjectGroup(j,Q)}paintInlineImageXObject(E){if(!this.contentVisible)return;const T=E.width,O=E.height,N=this.ctx;this.save(),N.scale(1/T,-1/O);let j;if(typeof HTMLElement=="function"&&E instanceof HTMLElement||!E.data)j=E;else{const S=this.cachedCanvases.getCanvas("inlineImage",T,O),M=S.context;h(M,E,this.current.transferMaps),j=S.canvas}const U=this._scaleImage(j,(0,s.getCurrentTransformInverse)(N));N.imageSmoothingEnabled=Z((0,s.getCurrentTransform)(N),E.interpolate);const[J,Q]=x(N,U.img,0,0,U.paintWidth,U.paintHeight,0,-O,T,O);if(this.imageLayer){const[S,M]=n.Util.applyTransform([0,-O],(0,s.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:E,left:S,top:M,width:J,height:Q})}this.compose(),this.restore()}paintInlineImageXObjectGroup(E,T){if(!this.contentVisible)return;const O=this.ctx,N=E.width,j=E.height,U=this.cachedCanvases.getCanvas("inlineImage",N,j),J=U.context;h(J,E,this.current.transferMaps);for(const Q of T){if(O.save(),O.transform(...Q.transform),O.scale(1,-1),x(O,U.canvas,Q.x,Q.y,Q.w,Q.h,0,-1,1,1),this.imageLayer){const[S,M]=n.Util.applyTransform([Q.x,Q.y],(0,s.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:E,left:S,top:M,width:N,height:j})}O.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(E){}markPointProps(E,T){}beginMarkedContent(E){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(E,T){E==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(T)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(E){const T=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(E);const O=this.ctx;this.pendingClip&&(T||(this.pendingClip===$?O.clip("evenodd"):O.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),O.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const E=(0,s.getCurrentTransform)(this.ctx);if(E[1]===0&&E[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(E[0]),Math.abs(E[3]));else{const T=Math.abs(E[0]*E[3]-E[2]*E[1]),O=Math.hypot(E[0],E[2]),N=Math.hypot(E[1],E[3]);this._cachedGetSinglePixelWidth=Math.max(O,N)/T}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:E}=this.current,T=(0,s.getCurrentTransform)(this.ctx);let O,N;if(T[1]===0&&T[2]===0){const j=Math.abs(T[0]),U=Math.abs(T[3]);if(E===0)O=1/j,N=1/U;else{const J=j*E,Q=U*E;O=J<1?1/J:1,N=Q<1?1/Q:1}}else{const j=Math.abs(T[0]*T[3]-T[2]*T[1]),U=Math.hypot(T[0],T[1]),J=Math.hypot(T[2],T[3]);if(E===0)O=J/j,N=U/j;else{const Q=E*j;O=J>Q?J/Q:1,N=U>Q?U/Q:1}}this._cachedScaleForStroking=[O,N]}return this._cachedScaleForStroking}rescaleAndStroke(E){const{ctx:T}=this,{lineWidth:O}=this.current,[N,j]=this.getScaleForStroking();if(T.lineWidth=O||1,N===1&&j===1){T.stroke();return}let U,J,Q;E&&(U=(0,s.getCurrentTransform)(T),J=T.getLineDash().slice(),Q=T.lineDashOffset),T.scale(N,j);const S=Math.max(N,j);T.setLineDash(T.getLineDash().map(M=>M/S)),T.lineDashOffset/=S,T.stroke(),E&&(T.setTransform(...U),T.setLineDash(J),T.lineDashOffset=Q)}isContentVisible(){for(let E=this.markedContentStack.length-1;E>=0;E--)if(!this.markedContentStack[E].visible)return!1;return!0}};it=new WeakSet,he=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let X=_t;t.CanvasGraphics=X;for(const z in n.OPS)X.prototype[z]!==void 0&&(X.prototype[n.OPS[z]]=X.prototype[z])},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=b;var s=e(1),n=e(8),r=e(3);const a={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=a;function o(x,P){if(!P||r.isNodeJS)return;const A=P[2]-P[0],h=P[3]-P[1],d=new Path2D;d.rect(P[0],P[1],A,h),x.clip(d)}class l{constructor(){this.constructor===l&&(0,s.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,s.unreachable)("Abstract method `getPattern` called.")}}class c extends l{constructor(P){super(),this._type=P[1],this._bbox=P[2],this._colorStops=P[3],this._p0=P[4],this._p1=P[5],this._r0=P[6],this._r1=P[7],this.matrix=null}_createGradient(P){let A;this._type==="axial"?A=P.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(A=P.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const h of this._colorStops)A.addColorStop(h[0],h[1]);return A}getPattern(P,A,h,d){let f;if(d===a.STROKE||d===a.FILL){const v=A.current.getClippedPathBoundingBox(d,(0,n.getCurrentTransform)(P))||[0,0,0,0],w=Math.ceil(v[2]-v[0])||1,C=Math.ceil(v[3]-v[1])||1,k=A.cachedCanvases.getCanvas("pattern",w,C,!0),R=k.context;R.clearRect(0,0,R.canvas.width,R.canvas.height),R.beginPath(),R.rect(0,0,R.canvas.width,R.canvas.height),R.translate(-v[0],-v[1]),h=s.Util.transform(h,[1,0,0,1,v[0],v[1]]),R.transform(...A.baseTransform),this.matrix&&R.transform(...this.matrix),o(R,this._bbox),R.fillStyle=this._createGradient(R),R.fill(),f=P.createPattern(k.canvas,"no-repeat");const H=new DOMMatrix(h);try{f.setTransform(H)}catch(Z){(0,s.warn)(`RadialAxialShadingPattern.getPattern: "${Z==null?void 0:Z.message}".`)}}else o(P,this._bbox),f=this._createGradient(P);return f}}function p(x,P,A,h,d,f,v,w){const C=P.coords,k=P.colors,R=x.data,H=x.width*4;let Z;C[A+1]>C[h+1]&&(Z=A,A=h,h=Z,Z=f,f=v,v=Z),C[h+1]>C[d+1]&&(Z=h,h=d,d=Z,Z=v,v=w,w=Z),C[A+1]>C[h+1]&&(Z=A,A=h,h=Z,Z=f,f=v,v=Z);const K=(C[A]+P.offsetX)*P.scaleX,q=(C[A+1]+P.offsetY)*P.scaleY,W=(C[h]+P.offsetX)*P.scaleX,$=(C[h+1]+P.offsetY)*P.scaleY,X=(C[d]+P.offsetX)*P.scaleX,it=(C[d+1]+P.offsetY)*P.scaleY;if(q>=it)return;const lt=k[f],_t=k[f+1],z=k[f+2],E=k[v],T=k[v+1],O=k[v+2],N=k[w],j=k[w+1],U=k[w+2],J=Math.round(q),Q=Math.round(it);let S,M,D,F,L,V,nt,dt;for(let et=J;et<=Q;et++){if(et<$){let B;et<q?B=0:B=(q-et)/(q-$),S=K-(K-W)*B,M=lt-(lt-E)*B,D=_t-(_t-T)*B,F=z-(z-O)*B}else{let B;et>it?B=1:$===it?B=0:B=($-et)/($-it),S=W-(W-X)*B,M=E-(E-N)*B,D=T-(T-j)*B,F=O-(O-U)*B}let ot;et<q?ot=0:et>it?ot=1:ot=(q-et)/(q-it),L=K-(K-X)*ot,V=lt-(lt-N)*ot,nt=_t-(_t-j)*ot,dt=z-(z-U)*ot;const st=Math.round(Math.min(S,L)),ct=Math.round(Math.max(S,L));let pt=H*et+st*4;for(let B=st;B<=ct;B++)ot=(S-B)/(S-L),ot<0?ot=0:ot>1&&(ot=1),R[pt++]=M-(M-V)*ot|0,R[pt++]=D-(D-nt)*ot|0,R[pt++]=F-(F-dt)*ot|0,R[pt++]=255}}function m(x,P,A){const h=P.coords,d=P.colors;let f,v;switch(P.type){case"lattice":const w=P.verticesPerRow,C=Math.floor(h.length/w)-1,k=w-1;for(f=0;f<C;f++){let R=f*w;for(let H=0;H<k;H++,R++)p(x,A,h[R],h[R+1],h[R+w],d[R],d[R+1],d[R+w]),p(x,A,h[R+w+1],h[R+1],h[R+w],d[R+w+1],d[R+1],d[R+w])}break;case"triangles":for(f=0,v=h.length;f<v;f+=3)p(x,A,h[f],h[f+1],h[f+2],d[f],d[f+1],d[f+2]);break;default:throw new Error("illegal figure")}}class _ extends l{constructor(P){super(),this._coords=P[2],this._colors=P[3],this._figures=P[4],this._bounds=P[5],this._bbox=P[7],this._background=P[8],this.matrix=null}_createMeshCanvas(P,A,h){const w=Math.floor(this._bounds[0]),C=Math.floor(this._bounds[1]),k=Math.ceil(this._bounds[2])-w,R=Math.ceil(this._bounds[3])-C,H=Math.min(Math.ceil(Math.abs(k*P[0]*1.1)),3e3),Z=Math.min(Math.ceil(Math.abs(R*P[1]*1.1)),3e3),K=k/H,q=R/Z,W={coords:this._coords,colors:this._colors,offsetX:-w,offsetY:-C,scaleX:1/K,scaleY:1/q},$=H+2*2,X=Z+2*2,it=h.getCanvas("mesh",$,X,!1),lt=it.context,_t=lt.createImageData(H,Z);if(A){const E=_t.data;for(let T=0,O=E.length;T<O;T+=4)E[T]=A[0],E[T+1]=A[1],E[T+2]=A[2],E[T+3]=255}for(const E of this._figures)m(_t,E,W);return lt.putImageData(_t,2,2),{canvas:it.canvas,offsetX:w-2*K,offsetY:C-2*q,scaleX:K,scaleY:q}}getPattern(P,A,h,d){o(P,this._bbox);let f;if(d===a.SHADING)f=s.Util.singularValueDecompose2dScale((0,n.getCurrentTransform)(P));else if(f=s.Util.singularValueDecompose2dScale(A.baseTransform),this.matrix){const w=s.Util.singularValueDecompose2dScale(this.matrix);f=[f[0]*w[0],f[1]*w[1]]}const v=this._createMeshCanvas(f,d===a.SHADING?null:this._background,A.cachedCanvases);return d!==a.SHADING&&(P.setTransform(...A.baseTransform),this.matrix&&P.transform(...this.matrix)),P.translate(v.offsetX,v.offsetY),P.scale(v.scaleX,v.scaleY),P.createPattern(v.canvas,"no-repeat")}}class y extends l{getPattern(){return"hotpink"}}function b(x){switch(x[0]){case"RadialAxial":return new c(x);case"Mesh":return new _(x);case"Dummy":return new y}throw new Error(`Unknown IR type: ${x[0]}`)}const u={COLORED:1,UNCOLORED:2};class g{static get MAX_PATTERN_SIZE(){return(0,s.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(P,A,h,d,f){this.operatorList=P[2],this.matrix=P[3]||[1,0,0,1,0,0],this.bbox=P[4],this.xstep=P[5],this.ystep=P[6],this.paintType=P[7],this.tilingType=P[8],this.color=A,this.ctx=h,this.canvasGraphicsFactory=d,this.baseTransform=f}createPatternCanvas(P){const A=this.operatorList,h=this.bbox,d=this.xstep,f=this.ystep,v=this.paintType,w=this.tilingType,C=this.color,k=this.canvasGraphicsFactory;(0,s.info)("TilingType: "+w);const R=h[0],H=h[1],Z=h[2],K=h[3],q=s.Util.singularValueDecompose2dScale(this.matrix),W=s.Util.singularValueDecompose2dScale(this.baseTransform),$=[q[0]*W[0],q[1]*W[1]],X=this.getSizeAndScale(d,this.ctx.canvas.width,$[0]),it=this.getSizeAndScale(f,this.ctx.canvas.height,$[1]),lt=P.cachedCanvases.getCanvas("pattern",X.size,it.size,!0),_t=lt.context,z=k.createCanvasGraphics(_t);z.groupLevel=P.groupLevel,this.setFillAndStrokeStyleToContext(z,v,C);let E=R,T=H,O=Z,N=K;return R<0&&(E=0,O+=Math.abs(R)),H<0&&(T=0,N+=Math.abs(H)),_t.translate(-(X.scale*E),-(it.scale*T)),z.transform(X.scale,0,0,it.scale,0,0),_t.save(),this.clipBbox(z,E,T,O,N),z.baseTransform=(0,n.getCurrentTransform)(z.ctx),z.executeOperatorList(A),z.endDrawing(),{canvas:lt.canvas,scaleX:X.scale,scaleY:it.scale,offsetX:E,offsetY:T}}getSizeAndScale(P,A,h){P=Math.abs(P);const d=Math.max(g.MAX_PATTERN_SIZE,A);let f=Math.ceil(P*h);return f>=d?f=d:h=f/P,{scale:h,size:f}}clipBbox(P,A,h,d,f){const v=d-A,w=f-h;P.ctx.rect(A,h,v,w),P.current.updateRectMinMax((0,n.getCurrentTransform)(P.ctx),[A,h,d,f]),P.clip(),P.endPath()}setFillAndStrokeStyleToContext(P,A,h){const d=P.ctx,f=P.current;switch(A){case u.COLORED:const v=this.ctx;d.fillStyle=v.fillStyle,d.strokeStyle=v.strokeStyle,f.fillColor=v.fillStyle,f.strokeColor=v.strokeStyle;break;case u.UNCOLORED:const w=s.Util.makeHexColor(h[0],h[1],h[2]);d.fillStyle=w,d.strokeStyle=w,f.fillColor=w,f.strokeColor=w;break;default:throw new s.FormatError(`Unsupported paint type: ${A}`)}}getPattern(P,A,h,d){let f=h;d!==a.SHADING&&(f=s.Util.transform(f,A.baseTransform),this.matrix&&(f=s.Util.transform(f,this.matrix)));const v=this.createPatternCanvas(A);let w=new DOMMatrix(f);w=w.translate(v.offsetX,v.offsetY),w=w.scale(1/v.scaleX,1/v.scaleY);const C=P.createPattern(v.canvas,"repeat");try{C.setTransform(w)}catch(k){(0,s.warn)(`TilingPattern.getPattern: "${k==null?void 0:k.message}".`)}return C}}t.TilingPattern=g},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyMaskImageData=n;var s=e(1);function n({src:r,srcPos:a=0,dest:o,destPos:l=0,width:c,height:p,inverseDecode:m=!1}){const _=s.FeatureTest.isLittleEndian?4278190080:255,[y,b]=m?[0,_]:[_,0],u=c>>3,g=c&7,x=r.length;o=new Uint32Array(o.buffer);for(let P=0;P<p;P++){for(const h=a+u;a<h;a++){const d=a<x?r[a]:255;o[l++]=d&128?b:y,o[l++]=d&64?b:y,o[l++]=d&32?b:y,o[l++]=d&16?b:y,o[l++]=d&8?b:y,o[l++]=d&4?b:y,o[l++]=d&2?b:y,o[l++]=d&1?b:y}if(g===0)continue;const A=a<x?r[a++]:255;for(let h=0;h<g;h++)o[l++]=A&1<<7-h?b:y}return{srcPos:a,destPos:l}}},(i,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const e=Object.create(null);t.GlobalWorkerOptions=e,e.workerPort=e.workerPort===void 0?null:e.workerPort,e.workerSrc=e.workerSrc===void 0?"":e.workerSrc},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var s=e(1);const n={UNKNOWN:0,DATA:1,ERROR:2},r={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function a(l){switch(l instanceof Error||typeof l=="object"&&l!==null||(0,s.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),l.name){case"AbortException":return new s.AbortException(l.message);case"MissingPDFException":return new s.MissingPDFException(l.message);case"PasswordException":return new s.PasswordException(l.message,l.code);case"UnexpectedResponseException":return new s.UnexpectedResponseException(l.message,l.status);case"UnknownErrorException":return new s.UnknownErrorException(l.message,l.details);default:return new s.UnknownErrorException(l.message,l.toString())}}class o{constructor(c,p,m){this.sourceName=c,this.targetName=p,this.comObj=m,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=_=>{const y=_.data;if(y.targetName!==this.sourceName)return;if(y.stream){this._processStreamMessage(y);return}if(y.callback){const u=y.callbackId,g=this.callbackCapabilities[u];if(!g)throw new Error(`Cannot resolve callback ${u}`);if(delete this.callbackCapabilities[u],y.callback===n.DATA)g.resolve(y.data);else if(y.callback===n.ERROR)g.reject(a(y.reason));else throw new Error("Unexpected callback case");return}const b=this.actionHandler[y.action];if(!b)throw new Error(`Unknown action from worker: ${y.action}`);if(y.callbackId){const u=this.sourceName,g=y.sourceName;new Promise(function(x){x(b(y.data))}).then(function(x){m.postMessage({sourceName:u,targetName:g,callback:n.DATA,callbackId:y.callbackId,data:x})},function(x){m.postMessage({sourceName:u,targetName:g,callback:n.ERROR,callbackId:y.callbackId,reason:a(x)})});return}if(y.streamId){this._createStreamSink(y);return}b(y.data)},m.addEventListener("message",this._onComObjOnMessage)}on(c,p){const m=this.actionHandler;if(m[c])throw new Error(`There is already an actionName called "${c}"`);m[c]=p}send(c,p,m){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:c,data:p},m)}sendWithPromise(c,p,m){const _=this.callbackId++,y=(0,s.createPromiseCapability)();this.callbackCapabilities[_]=y;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:c,callbackId:_,data:p},m)}catch(b){y.reject(b)}return y.promise}sendWithStream(c,p,m,_){const y=this.streamId++,b=this.sourceName,u=this.targetName,g=this.comObj;return new ReadableStream({start:x=>{const P=(0,s.createPromiseCapability)();return this.streamControllers[y]={controller:x,startCall:P,pullCall:null,cancelCall:null,isClosed:!1},g.postMessage({sourceName:b,targetName:u,action:c,streamId:y,data:p,desiredSize:x.desiredSize},_),P.promise},pull:x=>{const P=(0,s.createPromiseCapability)();return this.streamControllers[y].pullCall=P,g.postMessage({sourceName:b,targetName:u,stream:r.PULL,streamId:y,desiredSize:x.desiredSize}),P.promise},cancel:x=>{(0,s.assert)(x instanceof Error,"cancel must have a valid reason");const P=(0,s.createPromiseCapability)();return this.streamControllers[y].cancelCall=P,this.streamControllers[y].isClosed=!0,g.postMessage({sourceName:b,targetName:u,stream:r.CANCEL,streamId:y,reason:a(x)}),P.promise}},m)}_createStreamSink(c){const p=c.streamId,m=this.sourceName,_=c.sourceName,y=this.comObj,b=this,u=this.actionHandler[c.action],g={enqueue(x,P=1,A){if(this.isCancelled)return;const h=this.desiredSize;this.desiredSize-=P,h>0&&this.desiredSize<=0&&(this.sinkCapability=(0,s.createPromiseCapability)(),this.ready=this.sinkCapability.promise),y.postMessage({sourceName:m,targetName:_,stream:r.ENQUEUE,streamId:p,chunk:x},A)},close(){this.isCancelled||(this.isCancelled=!0,y.postMessage({sourceName:m,targetName:_,stream:r.CLOSE,streamId:p}),delete b.streamSinks[p])},error(x){(0,s.assert)(x instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,y.postMessage({sourceName:m,targetName:_,stream:r.ERROR,streamId:p,reason:a(x)}))},sinkCapability:(0,s.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:c.desiredSize,ready:null};g.sinkCapability.resolve(),g.ready=g.sinkCapability.promise,this.streamSinks[p]=g,new Promise(function(x){x(u(c.data,g))}).then(function(){y.postMessage({sourceName:m,targetName:_,stream:r.START_COMPLETE,streamId:p,success:!0})},function(x){y.postMessage({sourceName:m,targetName:_,stream:r.START_COMPLETE,streamId:p,reason:a(x)})})}_processStreamMessage(c){const p=c.streamId,m=this.sourceName,_=c.sourceName,y=this.comObj,b=this.streamControllers[p],u=this.streamSinks[p];switch(c.stream){case r.START_COMPLETE:c.success?b.startCall.resolve():b.startCall.reject(a(c.reason));break;case r.PULL_COMPLETE:c.success?b.pullCall.resolve():b.pullCall.reject(a(c.reason));break;case r.PULL:if(!u){y.postMessage({sourceName:m,targetName:_,stream:r.PULL_COMPLETE,streamId:p,success:!0});break}u.desiredSize<=0&&c.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=c.desiredSize,new Promise(function(g){g(u.onPull&&u.onPull())}).then(function(){y.postMessage({sourceName:m,targetName:_,stream:r.PULL_COMPLETE,streamId:p,success:!0})},function(g){y.postMessage({sourceName:m,targetName:_,stream:r.PULL_COMPLETE,streamId:p,reason:a(g)})});break;case r.ENQUEUE:if((0,s.assert)(b,"enqueue should have stream controller"),b.isClosed)break;b.controller.enqueue(c.chunk);break;case r.CLOSE:if((0,s.assert)(b,"close should have stream controller"),b.isClosed)break;b.isClosed=!0,b.controller.close(),this._deleteStreamController(b,p);break;case r.ERROR:(0,s.assert)(b,"error should have stream controller"),b.controller.error(a(c.reason)),this._deleteStreamController(b,p);break;case r.CANCEL_COMPLETE:c.success?b.cancelCall.resolve():b.cancelCall.reject(a(c.reason)),this._deleteStreamController(b,p);break;case r.CANCEL:if(!u)break;new Promise(function(g){g(u.onCancel&&u.onCancel(a(c.reason)))}).then(function(){y.postMessage({sourceName:m,targetName:_,stream:r.CANCEL_COMPLETE,streamId:p,success:!0})},function(g){y.postMessage({sourceName:m,targetName:_,stream:r.CANCEL_COMPLETE,streamId:p,reason:a(g)})}),u.sinkCapability.reject(a(c.reason)),u.isCancelled=!0,delete this.streamSinks[p];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(c,p){await Promise.allSettled([c.startCall&&c.startCall.promise,c.pullCall&&c.pullCall.promise,c.cancelCall&&c.cancelCall.promise]),delete this.streamControllers[p]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}t.MessageHandler=o},(i,t,e)=>{var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var s=e(1);class n{constructor({parsedData:l,rawData:c}){at(this,r,void 0);at(this,a,void 0);bt(this,r,l),bt(this,a,c)}getRaw(){return I(this,a)}get(l){return I(this,r).get(l)??null}getAll(){return(0,s.objectFromMap)(I(this,r))}has(l){return I(this,r).has(l)}}r=new WeakMap,a=new WeakMap,t.Metadata=n},(i,t,e)=>{var o,l,c,p,m,_,de;Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var s=e(1);const n=Symbol("INTERNAL");class r{constructor(u,g){at(this,o,!0);this.name=u,this.intent=g}get visible(){return I(this,o)}_setVisible(u,g){u!==n&&(0,s.unreachable)("Internal method `_setVisible` called."),bt(this,o,g)}}o=new WeakMap;class a{constructor(u){at(this,_);at(this,l,!0);at(this,c,new Map);at(this,p,null);at(this,m,null);if(this.name=null,this.creator=null,u!==null){this.name=u.name,this.creator=u.creator,bt(this,m,u.order);for(const g of u.groups)I(this,c).set(g.id,new r(g.name,g.intent));if(u.baseState==="OFF")for(const g of I(this,c).values())g._setVisible(n,!1);for(const g of u.on)I(this,c).get(g)._setVisible(n,!0);for(const g of u.off)I(this,c).get(g)._setVisible(n,!1);bt(this,p,new Map);for(const[g,x]of I(this,c))I(this,p).set(g,x.visible)}}isVisible(u){if(I(this,c).size===0)return!0;if(!u)return(0,s.warn)("Optional content group not defined."),!0;if(u.type==="OCG")return I(this,c).has(u.id)?I(this,c).get(u.id).visible:((0,s.warn)(`Optional content group not found: ${u.id}`),!0);if(u.type==="OCMD"){if(u.expression)return ht(this,_,de).call(this,u.expression);if(!u.policy||u.policy==="AnyOn"){for(const g of u.ids){if(!I(this,c).has(g))return(0,s.warn)(`Optional content group not found: ${g}`),!0;if(I(this,c).get(g).visible)return!0}return!1}else if(u.policy==="AllOn"){for(const g of u.ids){if(!I(this,c).has(g))return(0,s.warn)(`Optional content group not found: ${g}`),!0;if(!I(this,c).get(g).visible)return!1}return!0}else if(u.policy==="AnyOff"){for(const g of u.ids){if(!I(this,c).has(g))return(0,s.warn)(`Optional content group not found: ${g}`),!0;if(!I(this,c).get(g).visible)return!0}return!1}else if(u.policy==="AllOff"){for(const g of u.ids){if(!I(this,c).has(g))return(0,s.warn)(`Optional content group not found: ${g}`),!0;if(I(this,c).get(g).visible)return!1}return!0}return(0,s.warn)(`Unknown optional content policy ${u.policy}.`),!0}return(0,s.warn)(`Unknown group type ${u.type}.`),!0}setVisibility(u,g=!0){if(!I(this,c).has(u)){(0,s.warn)(`Optional content group not found: ${u}`);return}I(this,c).get(u)._setVisible(n,!!g),bt(this,l,null)}get hasInitialVisibility(){if(I(this,l)!==null)return I(this,l);for(const[u,g]of I(this,c)){const x=I(this,p).get(u);if(g.visible!==x)return bt(this,l,!1)}return bt(this,l,!0)}getOrder(){return I(this,c).size?I(this,m)?I(this,m).slice():[...I(this,c).keys()]:null}getGroups(){return I(this,c).size>0?(0,s.objectFromMap)(I(this,c)):null}getGroup(u){return I(this,c).get(u)||null}}l=new WeakMap,c=new WeakMap,p=new WeakMap,m=new WeakMap,_=new WeakSet,de=function(u){const g=u.length;if(g<2)return!0;const x=u[0];for(let P=1;P<g;P++){const A=u[P];let h;if(Array.isArray(A))h=ht(this,_,de).call(this,A);else if(I(this,c).has(A))h=I(this,c).get(A).visible;else return(0,s.warn)(`Optional content group not found: ${A}`),!0;switch(x){case"And":if(!h)return!1;break;case"Or":if(h)return!0;break;case"Not":return!h;default:return!0}}return x==="And"},t.OptionalContentConfig=a},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var s=e(1),n=e(8);class r{constructor(c,p){(0,s.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=c.progressiveDone||!1,this._contentDispositionFilename=c.contentDispositionFilename||null;const m=c.initialData;if((m==null?void 0:m.length)>0){const _=new Uint8Array(m).buffer;this._queuedChunks.push(_)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!c.disableStream,this._isRangeSupported=!c.disableRange,this._contentLength=c.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((_,y)=>{this._onReceiveData({begin:_,chunk:y})}),this._pdfDataRangeTransport.addProgressListener((_,y)=>{this._onProgress({loaded:_,total:y})}),this._pdfDataRangeTransport.addProgressiveReadListener(_=>{this._onReceiveData({chunk:_})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(c){const p=new Uint8Array(c.chunk).buffer;if(c.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(p):this._queuedChunks.push(p);else{const m=this._rangeReaders.some(function(_){return _._begin!==c.begin?!1:(_._enqueue(p),!0)});(0,s.assert)(m,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var c;return((c=this._fullRequestReader)==null?void 0:c._loaded)??0}_onProgress(c){if(c.total===void 0){const p=this._rangeReaders[0];p!=null&&p.onProgress&&p.onProgress({loaded:c.loaded})}else{const p=this._fullRequestReader;p!=null&&p.onProgress&&p.onProgress({loaded:c.loaded,total:c.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(c){const p=this._rangeReaders.indexOf(c);p>=0&&this._rangeReaders.splice(p,1)}getFullReader(){(0,s.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const c=this._queuedChunks;return this._queuedChunks=null,new a(this,c,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(c,p){if(p<=this._progressiveDataLength)return null;const m=new o(this,c,p);return this._pdfDataRangeTransport.requestDataRange(c,p),this._rangeReaders.push(m),m}cancelAllRequests(c){this._fullRequestReader&&this._fullRequestReader.cancel(c);for(const p of this._rangeReaders.slice(0))p.cancel(c);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=r;class a{constructor(c,p,m=!1,_=null){this._stream=c,this._done=m||!1,this._filename=(0,n.isPdfFile)(_)?_:null,this._queuedChunks=p||[],this._loaded=0;for(const y of this._queuedChunks)this._loaded+=y.byteLength;this._requests=[],this._headersReady=Promise.resolve(),c._fullRequestReader=this,this.onProgress=null}_enqueue(c){this._done||(this._requests.length>0?this._requests.shift().resolve({value:c,done:!1}):this._queuedChunks.push(c),this._loaded+=c.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const c=(0,s.createPromiseCapability)();return this._requests.push(c),c.promise}cancel(c){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(c,p,m){this._stream=c,this._begin=p,this._end=m,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(c){if(!this._done){if(this._requests.length===0)this._queuedChunk=c;else{this._requests.shift().resolve({value:c,done:!1});for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const c=(0,s.createPromiseCapability)();return this._requests.push(c),c.promise}cancel(c){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(i,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class e{static textContent(n){const r=[],a={items:r,styles:Object.create(null)};function o(l){var m;if(!l)return;let c=null;const p=l.name;if(p==="#text")c=l.value;else if(e.shouldBuildText(p))(m=l==null?void 0:l.attributes)!=null&&m.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&r.push({str:c}),!!l.children)for(const _ of l.children)o(_)}return o(n),a}static shouldBuildText(n){return!(n==="textarea"||n==="input"||n==="option"||n==="select")}}t.XfaText=e},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var s=e(9);const n=function(l){return new Promise((c,p)=>{require$$5.readFile(l,(_,y)=>{if(_||!y){p(new Error(_));return}c(new Uint8Array(y))})})};class r extends s.BaseCanvasFactory{_createCanvas(c,p){return require$$5.createCanvas(c,p)}}t.NodeCanvasFactory=r;class a extends s.BaseCMapReaderFactory{_fetchData(c,p){return n(c).then(m=>({cMapData:m,compressionType:p}))}}t.NodeCMapReaderFactory=a;class o extends s.BaseStandardFontDataFactory{_fetchData(c){return n(c)}}t.NodeStandardFontDataFactory=o},(i,t,e)=>{var l,c,p,m,_,y,b,u,g,ue,P,Ee,h,fe,f,Me;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var s=e(7),n=e(1),r=e(23),a=e(24);const w=class w{constructor(k){at(this,g);at(this,P);at(this,h);at(this,f);at(this,l,void 0);at(this,c,!1);at(this,p,this.pointerup.bind(this));at(this,m,this.pointerdown.bind(this));at(this,_,new Map);at(this,y,!1);at(this,b,!1);at(this,u,void 0);w._initialized||(w._initialized=!0,r.FreeTextEditor.initialize(k.l10n),a.InkEditor.initialize(k.l10n),k.uiManager.registerEditorTypes([r.FreeTextEditor,a.InkEditor])),bt(this,u,k.uiManager),this.annotationStorage=k.annotationStorage,this.pageIndex=k.pageIndex,this.div=k.div,bt(this,l,k.accessibilityManager),I(this,u).addLayer(this)}updateToolbar(k){I(this,u).updateToolbar(k)}updateMode(k=I(this,u).getMode()){ht(this,f,Me).call(this),k===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),I(this,u).unselectAll()}addInkEditorIfNeeded(k){if(!k&&I(this,u).getMode()!==n.AnnotationEditorType.INK)return;if(!k){for(const H of I(this,_).values())if(H.isEmpty()){H.setInBackground();return}}ht(this,h,fe).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(k){I(this,u).setEditingState(k)}addCommands(k){I(this,u).addCommands(k)}enable(){this.div.style.pointerEvents="auto";for(const k of I(this,_).values())k.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const k of I(this,_).values())k.disableEditing()}setActiveEditor(k){I(this,u).getActive()!==k&&I(this,u).setActiveEditor(k)}enableClick(){this.div.addEventListener("pointerdown",I(this,m)),this.div.addEventListener("pointerup",I(this,p))}disableClick(){this.div.removeEventListener("pointerdown",I(this,m)),this.div.removeEventListener("pointerup",I(this,p))}attach(k){I(this,_).set(k.id,k)}detach(k){var R;I(this,_).delete(k.id),(R=I(this,l))==null||R.removePointerInTextLayer(k.contentDiv)}remove(k){I(this,u).removeEditor(k),this.detach(k),this.annotationStorage.remove(k.id),k.div.style.display="none",setTimeout(()=>{k.div.style.display="",k.div.remove(),k.isAttachedToDOM=!1,document.activeElement===document.body&&I(this,u).focusMainContainer()},0),I(this,b)||this.addInkEditorIfNeeded(!1)}add(k){if(ht(this,g,ue).call(this,k),I(this,u).addEditor(k),this.attach(k),!k.isAttachedToDOM){const R=k.render();this.div.append(R),k.isAttachedToDOM=!0}this.moveEditorInDOM(k),k.onceAdded(),this.addToAnnotationStorage(k)}moveEditorInDOM(k){var R;(R=I(this,l))==null||R.moveElementInDOM(this.div,k.div,k.contentDiv,!0)}addToAnnotationStorage(k){!k.isEmpty()&&!this.annotationStorage.has(k.id)&&this.annotationStorage.setValue(k.id,k)}addOrRebuild(k){k.needsToBeRebuilt()?k.rebuild():this.add(k)}addANewEditor(k){const R=()=>{this.addOrRebuild(k)},H=()=>{k.remove()};this.addCommands({cmd:R,undo:H,mustExec:!0})}addUndoableEditor(k){const R=()=>{this.addOrRebuild(k)},H=()=>{k.remove()};this.addCommands({cmd:R,undo:H,mustExec:!1})}getNextId(){return I(this,u).getId()}deserialize(k){switch(k.annotationType){case n.AnnotationEditorType.FREETEXT:return r.FreeTextEditor.deserialize(k,this);case n.AnnotationEditorType.INK:return a.InkEditor.deserialize(k,this)}return null}setSelected(k){I(this,u).setSelected(k)}toggleSelected(k){I(this,u).toggleSelected(k)}isSelected(k){return I(this,u).isSelected(k)}unselect(k){I(this,u).unselect(k)}pointerup(k){const R=s.KeyboardManager.platform.isMac;if(!(k.button!==0||k.ctrlKey&&R)&&k.target===this.div&&I(this,y)){if(bt(this,y,!1),!I(this,c)){bt(this,c,!0);return}ht(this,h,fe).call(this,k)}}pointerdown(k){const R=s.KeyboardManager.platform.isMac;if(k.button!==0||k.ctrlKey&&R||k.target!==this.div)return;bt(this,y,!0);const H=I(this,u).getActive();bt(this,c,!H||H.isEmpty())}drop(k){const R=k.dataTransfer.getData("text/plain"),H=I(this,u).getEditor(R);if(!H)return;k.preventDefault(),k.dataTransfer.dropEffect="move",ht(this,g,ue).call(this,H);const Z=this.div.getBoundingClientRect(),K=k.clientX-Z.x,q=k.clientY-Z.y;H.translate(K-H.startX,q-H.startY),this.moveEditorInDOM(H),H.div.focus()}dragover(k){k.preventDefault()}destroy(){var k,R;((k=I(this,u).getActive())==null?void 0:k.parent)===this&&I(this,u).setActiveEditor(null);for(const H of I(this,_).values())(R=I(this,l))==null||R.removePointerInTextLayer(H.contentDiv),H.isAttachedToDOM=!1,H.div.remove(),H.parent=null;this.div=null,I(this,_).clear(),I(this,u).removeLayer(this)}render(k){this.viewport=k.viewport,(0,s.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const R of I(this,u).getEditors(this.pageIndex))this.add(R);this.updateMode()}update(k){this.viewport=k.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[k,R,H,Z]=this.viewport.viewBox,K=H-k,q=Z-R;return[K,q]}get viewportBaseDimensions(){const{width:k,height:R,rotation:H}=this.viewport;return H%180===0?[k,R]:[R,k]}setDimensions(){const{width:k,height:R,rotation:H}=this.viewport,Z=H%180!==0,K=Math.floor(k)+"px",q=Math.floor(R)+"px";this.div.style.width=Z?q:K,this.div.style.height=Z?K:q,this.div.setAttribute("data-main-rotation",H)}};l=new WeakMap,c=new WeakMap,p=new WeakMap,m=new WeakMap,_=new WeakMap,y=new WeakMap,b=new WeakMap,u=new WeakMap,g=new WeakSet,ue=function(k){var R;k.parent!==this&&(this.attach(k),k.pageIndex=this.pageIndex,(R=k.parent)==null||R.detach(k),k.parent=this,k.div&&k.isAttachedToDOM&&(k.div.remove(),this.div.append(k.div)))},P=new WeakSet,Ee=function(k){switch(I(this,u).getMode()){case n.AnnotationEditorType.FREETEXT:return new r.FreeTextEditor(k);case n.AnnotationEditorType.INK:return new a.InkEditor(k)}return null},h=new WeakSet,fe=function(k){const R=this.getNextId(),H=ht(this,P,Ee).call(this,{parent:this,id:R,x:k.offsetX,y:k.offsetY});return H&&this.add(H),H},f=new WeakSet,Me=function(){bt(this,b,!0);for(const k of I(this,_).values())k.isEmpty()&&k.remove();bt(this,b,!1)},ft(w,"_initialized",!1);let o=w;t.AnnotationEditorLayer=o},(i,t,e)=>{var o,l,c,p,m,_,y,b,Re,g,De,P,Fe,h,pe;Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var s=e(1),n=e(7),r=e(6);const f=class f extends r.AnnotationEditor{constructor(C){super({...C,name:"freeTextEditor"});at(this,b);at(this,g);at(this,P);at(this,h);at(this,o,this.editorDivBlur.bind(this));at(this,l,this.editorDivFocus.bind(this));at(this,c,this.editorDivKeydown.bind(this));at(this,p,void 0);at(this,m,"");at(this,_,!1);at(this,y,void 0);bt(this,p,C.color||f._defaultColor||r.AnnotationEditor._defaultLineColor),bt(this,y,C.fontSize||f._defaultFontSize)}static initialize(C){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(R=>[R,C.get(R)]));const k=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(k.getPropertyValue("--freetext-padding"))}static updateDefaultParams(C,k){switch(C){case s.AnnotationEditorParamsType.FREETEXT_SIZE:f._defaultFontSize=k;break;case s.AnnotationEditorParamsType.FREETEXT_COLOR:f._defaultColor=k;break}}updateParams(C,k){switch(C){case s.AnnotationEditorParamsType.FREETEXT_SIZE:ht(this,b,Re).call(this,k);break;case s.AnnotationEditorParamsType.FREETEXT_COLOR:ht(this,g,De).call(this,k);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.FREETEXT_SIZE,f._defaultFontSize],[s.AnnotationEditorParamsType.FREETEXT_COLOR,f._defaultColor||r.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.FREETEXT_SIZE,I(this,y)],[s.AnnotationEditorParamsType.FREETEXT_COLOR,I(this,p)]]}getInitialTranslation(){return[-f._internalPadding*this.parent.scaleFactor,-(f._internalPadding+I(this,y))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(s.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",I(this,c)),this.editorDiv.addEventListener("focus",I(this,l)),this.editorDiv.addEventListener("blur",I(this,o)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",I(this,c)),this.editorDiv.removeEventListener("focus",I(this,l)),this.editorDiv.removeEventListener("blur",I(this,o)),this.div.focus(),this.isEditing=!1)}focusin(C){super.focusin(C),C.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),I(this,_)||(bt(this,_,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),bt(this,m,ht(this,P,Fe).call(this).trimEnd()),ht(this,h,pe).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(C){this.enableEditMode(),this.editorDiv.focus()}keydown(C){C.target===this.div&&C.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(C){f._keyboardManager.exec(this,C)}editorDivFocus(C){this.isEditing=!0}editorDivBlur(C){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let C,k;this.width&&(C=this.x,k=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),f._l10nPromise.get("editor_free_text_aria_label").then(H=>{var Z;return(Z=this.editorDiv)==null?void 0:Z.setAttribute("aria-label",H)}),f._l10nPromise.get("free_text_default_content").then(H=>{var Z;return(Z=this.editorDiv)==null?void 0:Z.setAttribute("default-content",H)}),this.editorDiv.contentEditable=!0;const{style:R}=this.editorDiv;if(R.fontSize=`calc(${I(this,y)}px * var(--scale-factor))`,R.color=I(this,p),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,n.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[H,Z]=this.parent.viewportBaseDimensions;this.setAt(C*H,k*Z,this.width*H,this.height*Z);for(const K of I(this,m).split(`
`)){const q=document.createElement("div");q.append(K?document.createTextNode(K):document.createElement("br")),this.editorDiv.append(q)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(C,k){const R=super.deserialize(C,k);return bt(R,y,C.fontSize),bt(R,p,s.Util.makeHexColor(...C.color)),bt(R,m,C.value),R}serialize(){if(this.isEmpty())return null;const C=f._internalPadding*this.parent.scaleFactor,k=this.getRect(C,C),R=r.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:s.AnnotationEditorType.FREETEXT,color:R,fontSize:I(this,y),value:I(this,m),pageIndex:this.parent.pageIndex,rect:k,rotation:this.rotation}}};o=new WeakMap,l=new WeakMap,c=new WeakMap,p=new WeakMap,m=new WeakMap,_=new WeakMap,y=new WeakMap,b=new WeakSet,Re=function(C){const k=H=>{this.editorDiv.style.fontSize=`calc(${H}px * var(--scale-factor))`,this.translate(0,-(H-I(this,y))*this.parent.scaleFactor),bt(this,y,H),ht(this,h,pe).call(this)},R=I(this,y);this.parent.addCommands({cmd:()=>{k(C)},undo:()=>{k(R)},mustExec:!0,type:s.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,De=function(C){const k=I(this,p);this.parent.addCommands({cmd:()=>{bt(this,p,C),this.editorDiv.style.color=C},undo:()=>{bt(this,p,k),this.editorDiv.style.color=k},mustExec:!0,type:s.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},P=new WeakSet,Fe=function(){const C=this.editorDiv.getElementsByTagName("div");if(C.length===0)return this.editorDiv.innerText;const k=[];for(let R=0,H=C.length;R<H;R++){const K=C[R].firstChild;(K==null?void 0:K.nodeName)==="#text"?k.push(K.data):k.push("")}return k.join(`
`)},h=new WeakSet,pe=function(){const[C,k]=this.parent.viewportBaseDimensions,R=this.div.getBoundingClientRect();this.width=R.width/C,this.height=R.height/k},ft(f,"_freeTextDefaultContent",""),ft(f,"_l10nPromise"),ft(f,"_internalPadding",0),ft(f,"_defaultColor",null),ft(f,"_defaultFontSize",10),ft(f,"_keyboardManager",new n.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],f.prototype.commitOrRemove]])),ft(f,"_type","freetext");let a=f;t.FreeTextEditor=a},(i,t,e)=>{var c,p,m,_,y,b,u,g,x,P,A,h,d,f,v,Oe,C,Ie,R,Le,Z,Ne,q,ge,$,Be,it,je,_t,We,E,Vt,O,me,j,ee,J,ie,S,Yt,D,be,L,se,nt,_e,et,ze,st,Ue,pt,He,ut,ye,At,ne,kt,Kt,Rt,xe;Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0,Object.defineProperty(t,"fitCurve",{enumerable:!0,get:function(){return r.fitCurve}});var s=e(1),n=e(6),r=e(25),a=e(7);const o=16,Pt=class Pt extends n.AnnotationEditor{constructor(rt){super({...rt,name:"inkEditor"});at(this,v);at(this,C);at(this,R);at(this,Z);at(this,q);at(this,$);at(this,it);at(this,_t);at(this,E);at(this,O);at(this,j);at(this,J);at(this,S);at(this,D);at(this,L);at(this,et);at(this,st);at(this,pt);at(this,ut);at(this,At);at(this,kt);at(this,Rt);at(this,c,0);at(this,p,0);at(this,m,0);at(this,_,this.canvasPointermove.bind(this));at(this,y,this.canvasPointerleave.bind(this));at(this,b,this.canvasPointerup.bind(this));at(this,u,this.canvasPointerdown.bind(this));at(this,g,!1);at(this,x,!1);at(this,P,null);at(this,A,null);at(this,h,0);at(this,d,0);at(this,f,null);this.color=rt.color||null,this.thickness=rt.thickness||null,this.opacity=rt.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(rt){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(gt=>[gt,rt.get(gt)]))}static updateDefaultParams(rt,gt){switch(rt){case s.AnnotationEditorParamsType.INK_THICKNESS:Pt._defaultThickness=gt;break;case s.AnnotationEditorParamsType.INK_COLOR:Pt._defaultColor=gt;break;case s.AnnotationEditorParamsType.INK_OPACITY:Pt._defaultOpacity=gt/100;break}}updateParams(rt,gt){switch(rt){case s.AnnotationEditorParamsType.INK_THICKNESS:ht(this,v,Oe).call(this,gt);break;case s.AnnotationEditorParamsType.INK_COLOR:ht(this,C,Ie).call(this,gt);break;case s.AnnotationEditorParamsType.INK_OPACITY:ht(this,R,Le).call(this,gt);break}}static get defaultPropertiesToUpdate(){return[[s.AnnotationEditorParamsType.INK_THICKNESS,Pt._defaultThickness],[s.AnnotationEditorParamsType.INK_COLOR,Pt._defaultColor||n.AnnotationEditor._defaultLineColor],[s.AnnotationEditorParamsType.INK_OPACITY,Math.round(Pt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[s.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Pt._defaultThickness],[s.AnnotationEditorParamsType.INK_COLOR,this.color||Pt._defaultColor||n.AnnotationEditor._defaultLineColor],[s.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Pt._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ht(this,j,ee).call(this),ht(this,J,ie).call(this)),this.isAttachedToDOM||(this.parent.add(this),ht(this,S,Yt).call(this)),ht(this,kt,Kt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,I(this,A).disconnect(),bt(this,A,null),super.remove())}enableEditMode(){I(this,g)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",I(this,u)),this.canvas.addEventListener("pointerup",I(this,b)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",I(this,u)),this.canvas.removeEventListener("pointerup",I(this,b)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){I(this,g)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),bt(this,g,!0),this.div.classList.add("disabled"),ht(this,kt,Kt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(rt){super.focusin(rt),this.enableEditMode()}canvasPointerdown(rt){rt.button!==0||!this.isInEditMode()||I(this,g)||(this.setInForeground(),rt.type!=="mouse"&&this.div.focus(),rt.stopPropagation(),this.canvas.addEventListener("pointerleave",I(this,y)),this.canvas.addEventListener("pointermove",I(this,_)),ht(this,$,Be).call(this,rt.offsetX,rt.offsetY))}canvasPointermove(rt){rt.stopPropagation(),ht(this,it,je).call(this,rt.offsetX,rt.offsetY)}canvasPointerup(rt){rt.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(rt.stopPropagation(),ht(this,O,me).call(this,rt),this.setInBackground())}canvasPointerleave(rt){ht(this,O,me).call(this,rt),this.setInBackground()}render(){if(this.div)return this.div;let rt,gt;this.width&&(rt=this.x,gt=this.y),super.render(),Pt._l10nPromise.get("editor_ink_aria_label").then(yt=>{var vt;return(vt=this.div)==null?void 0:vt.setAttribute("aria-label",yt)});const[tt,G,Y,mt]=ht(this,Z,Ne).call(this);if(this.setAt(tt,G,0,0),this.setDims(Y,mt),ht(this,j,ee).call(this),this.width){const[yt,vt]=this.parent.viewportBaseDimensions;this.setAt(rt*yt,gt*vt,this.width*yt,this.height*vt),bt(this,x,!0),ht(this,S,Yt).call(this),this.setDims(this.width*yt,this.height*vt),ht(this,E,Vt).call(this),ht(this,Rt,xe).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ht(this,J,ie).call(this),this.div}setDimensions(rt,gt){const tt=Math.round(rt),G=Math.round(gt);if(I(this,h)===tt&&I(this,d)===G)return;bt(this,h,tt),bt(this,d,G),this.canvas.style.visibility="hidden",I(this,c)&&Math.abs(I(this,c)-rt/gt)>.01&&(gt=Math.ceil(rt/I(this,c)),this.setDims(rt,gt));const[Y,mt]=this.parent.viewportBaseDimensions;this.width=rt/Y,this.height=gt/mt,I(this,g)&&ht(this,D,be).call(this,rt,gt),ht(this,S,Yt).call(this),ht(this,E,Vt).call(this),this.canvas.style.visibility="visible"}static deserialize(rt,gt){var Ot,Mt;const tt=super.deserialize(rt,gt);tt.thickness=rt.thickness,tt.color=s.Util.makeHexColor(...rt.color),tt.opacity=rt.opacity;const[G,Y]=gt.pageDimensions,mt=tt.width*G,yt=tt.height*Y,vt=gt.scaleFactor,St=rt.thickness/2;bt(tt,c,mt/yt),bt(tt,g,!0),bt(tt,h,Math.round(mt)),bt(tt,d,Math.round(yt));for(const{bezier:Ct}of rt.paths){const Lt=[];tt.paths.push(Lt);let It=vt*(Ct[0]-St),jt=vt*(yt-Ct[1]-St);for(let Nt=2,zt=Ct.length;Nt<zt;Nt+=6){const qt=vt*(Ct[Nt]-St),Gt=vt*(yt-Ct[Nt+1]-St),Ht=vt*(Ct[Nt+2]-St),Bt=vt*(yt-Ct[Nt+3]-St),Ut=vt*(Ct[Nt+4]-St),Xt=vt*(yt-Ct[Nt+5]-St);Lt.push([[It,jt],[qt,Gt],[Ht,Bt],[Ut,Xt]]),It=Ut,jt=Xt}const Et=ht(this,nt,_e).call(this,Lt);tt.bezierPath2D.push(Et)}const Tt=ht(Ot=tt,ut,ye).call(Ot);return bt(tt,m,Math.max(o,Tt[2]-Tt[0])),bt(tt,p,Math.max(o,Tt[3]-Tt[1])),ht(Mt=tt,D,be).call(Mt,mt,yt),tt}serialize(){if(this.isEmpty())return null;const rt=this.getRect(0,0),gt=this.rotation%180===0?rt[3]-rt[1]:rt[2]-rt[0],tt=n.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:s.AnnotationEditorType.INK,color:tt,thickness:this.thickness,opacity:this.opacity,paths:ht(this,et,ze).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,gt),pageIndex:this.parent.pageIndex,rect:rt,rotation:this.rotation}}};c=new WeakMap,p=new WeakMap,m=new WeakMap,_=new WeakMap,y=new WeakMap,b=new WeakMap,u=new WeakMap,g=new WeakMap,x=new WeakMap,P=new WeakMap,A=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,v=new WeakSet,Oe=function(rt){const gt=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=rt,ht(this,kt,Kt).call(this)},undo:()=>{this.thickness=gt,ht(this,kt,Kt).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},C=new WeakSet,Ie=function(rt){const gt=this.color;this.parent.addCommands({cmd:()=>{this.color=rt,ht(this,E,Vt).call(this)},undo:()=>{this.color=gt,ht(this,E,Vt).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},R=new WeakSet,Le=function(rt){rt/=100;const gt=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=rt,ht(this,E,Vt).call(this)},undo:()=>{this.opacity=gt,ht(this,E,Vt).call(this)},mustExec:!0,type:s.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Z=new WeakSet,Ne=function(){const{width:rt,height:gt,rotation:tt}=this.parent.viewport;switch(tt){case 90:return[0,rt,rt,gt];case 180:return[rt,gt,rt,gt];case 270:return[gt,0,rt,gt];default:return[0,0,rt,gt]}},q=new WeakSet,ge=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,a.opacityToHex)(this.opacity)}`},$=new WeakSet,Be=function(rt,gt){this.isEditing=!0,I(this,x)||(bt(this,x,!0),ht(this,S,Yt).call(this),this.thickness||(this.thickness=Pt._defaultThickness),this.color||(this.color=Pt._defaultColor||n.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Pt._defaultOpacity)),this.currentPath.push([rt,gt]),bt(this,P,null),ht(this,q,ge).call(this),this.ctx.beginPath(),this.ctx.moveTo(rt,gt),bt(this,f,()=>{I(this,f)&&(I(this,P)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ht(this,E,Vt).call(this),this.ctx.lineTo(...I(this,P)),bt(this,P,null),this.ctx.stroke()),window.requestAnimationFrame(I(this,f)))}),window.requestAnimationFrame(I(this,f))},it=new WeakSet,je=function(rt,gt){const[tt,G]=this.currentPath.at(-1);rt===tt&&gt===G||(this.currentPath.push([rt,gt]),bt(this,P,[rt,gt]))},_t=new WeakSet,We=function(rt,gt){var St;this.ctx.closePath(),bt(this,f,null),rt=Math.min(Math.max(rt,0),this.canvas.width),gt=Math.min(Math.max(gt,0),this.canvas.height);const[tt,G]=this.currentPath.at(-1);(rt!==tt||gt!==G)&&this.currentPath.push([rt,gt]);let Y;if(this.currentPath.length!==1)Y=(0,r.fitCurve)(this.currentPath,30,null);else{const Tt=[rt,gt];Y=[[Tt,Tt.slice(),Tt.slice(),Tt]]}const mt=ht(St=Pt,nt,_e).call(St,Y);this.currentPath.length=0;const yt=()=>{this.paths.push(Y),this.bezierPath2D.push(mt),this.rebuild()},vt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ht(this,j,ee).call(this),ht(this,J,ie).call(this)),ht(this,kt,Kt).call(this))};this.parent.addCommands({cmd:yt,undo:vt,mustExec:!0})},E=new WeakSet,Vt=function(){if(this.isEmpty()){ht(this,L,se).call(this);return}ht(this,q,ge).call(this);const{canvas:rt,ctx:gt}=this;gt.setTransform(1,0,0,1,0,0),gt.clearRect(0,0,rt.width,rt.height),ht(this,L,se).call(this);for(const tt of this.bezierPath2D)gt.stroke(tt)},O=new WeakSet,me=function(rt){ht(this,_t,We).call(this,rt.offsetX,rt.offsetY),this.canvas.removeEventListener("pointerleave",I(this,y)),this.canvas.removeEventListener("pointermove",I(this,_)),this.parent.addToAnnotationStorage(this)},j=new WeakSet,ee=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Pt._l10nPromise.get("editor_ink_canvas_aria_label").then(rt=>{var gt;return(gt=this.canvas)==null?void 0:gt.setAttribute("aria-label",rt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},J=new WeakSet,ie=function(){bt(this,A,new ResizeObserver(rt=>{const gt=rt[0].contentRect;gt.width&&gt.height&&this.setDimensions(gt.width,gt.height)})),I(this,A).observe(this.div)},S=new WeakSet,Yt=function(){if(!I(this,x))return;const[rt,gt]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*rt),this.canvas.height=Math.ceil(this.height*gt),ht(this,L,se).call(this)},D=new WeakSet,be=function(rt,gt){const tt=ht(this,At,ne).call(this),G=(rt-tt)/I(this,m),Y=(gt-tt)/I(this,p);this.scaleFactor=Math.min(G,Y)},L=new WeakSet,se=function(){const rt=ht(this,At,ne).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+rt,this.translationY*this.scaleFactor+rt)},nt=new WeakSet,_e=function(rt){const gt=new Path2D;for(let tt=0,G=rt.length;tt<G;tt++){const[Y,mt,yt,vt]=rt[tt];tt===0&&gt.moveTo(...Y),gt.bezierCurveTo(mt[0],mt[1],yt[0],yt[1],vt[0],vt[1])}return gt},et=new WeakSet,ze=function(rt,gt,tt,G){const mt=[],yt=this.thickness/2;let vt,St;for(const Tt of this.paths){vt=[],St=[];for(let Ot=0,Mt=Tt.length;Ot<Mt;Ot++){const[Ct,Lt,It,jt]=Tt[Ot],Et=rt*(Ct[0]+gt)+yt,Nt=G-rt*(Ct[1]+tt)-yt,zt=rt*(Lt[0]+gt)+yt,qt=G-rt*(Lt[1]+tt)-yt,Gt=rt*(It[0]+gt)+yt,Ht=G-rt*(It[1]+tt)-yt,Bt=rt*(jt[0]+gt)+yt,Ut=G-rt*(jt[1]+tt)-yt;Ot===0&&(vt.push(Et,Nt),St.push(Et,Nt)),vt.push(zt,qt,Gt,Ht,Bt,Ut),ht(this,st,Ue).call(this,Et,Nt,zt,qt,Gt,Ht,Bt,Ut,4,St)}mt.push({bezier:vt,points:St})}return mt},st=new WeakSet,Ue=function(rt,gt,tt,G,Y,mt,yt,vt,St,Tt){if(ht(this,pt,He).call(this,rt,gt,tt,G,Y,mt,yt,vt)){Tt.push(yt,vt);return}for(let Ot=1;Ot<St-1;Ot++){const Mt=Ot/St,Ct=1-Mt;let Lt=Mt*rt+Ct*tt,It=Mt*gt+Ct*G,jt=Mt*tt+Ct*Y,Et=Mt*G+Ct*mt;const Nt=Mt*Y+Ct*yt,zt=Mt*mt+Ct*vt;Lt=Mt*Lt+Ct*jt,It=Mt*It+Ct*Et,jt=Mt*jt+Ct*Nt,Et=Mt*Et+Ct*zt,Lt=Mt*Lt+Ct*jt,It=Mt*It+Ct*Et,Tt.push(Lt,It)}Tt.push(yt,vt)},pt=new WeakSet,He=function(rt,gt,tt,G,Y,mt,yt,vt){const Tt=(3*tt-2*rt-yt)**2,Ot=(3*G-2*gt-vt)**2,Mt=(3*Y-rt-2*yt)**2,Ct=(3*mt-gt-2*vt)**2;return Math.max(Tt,Mt)+Math.max(Ot,Ct)<=10},ut=new WeakSet,ye=function(){let rt=1/0,gt=-1/0,tt=1/0,G=-1/0;for(const Y of this.paths)for(const[mt,yt,vt,St]of Y){const Tt=s.Util.bezierBoundingBox(...mt,...yt,...vt,...St);rt=Math.min(rt,Tt[0]),tt=Math.min(tt,Tt[1]),gt=Math.max(gt,Tt[2]),G=Math.max(G,Tt[3])}return[rt,tt,gt,G]},At=new WeakSet,ne=function(){return I(this,g)?Math.ceil(this.thickness*this.parent.scaleFactor):0},kt=new WeakSet,Kt=function(rt=!1){if(this.isEmpty())return;if(!I(this,g)){ht(this,E,Vt).call(this);return}const gt=ht(this,ut,ye).call(this),tt=ht(this,At,ne).call(this);bt(this,m,Math.max(o,gt[2]-gt[0])),bt(this,p,Math.max(o,gt[3]-gt[1]));const G=Math.ceil(tt+I(this,m)*this.scaleFactor),Y=Math.ceil(tt+I(this,p)*this.scaleFactor),[mt,yt]=this.parent.viewportBaseDimensions;this.width=G/mt,this.height=Y/yt,bt(this,c,G/Y),ht(this,Rt,xe).call(this);const vt=this.translationX,St=this.translationY;this.translationX=-gt[0],this.translationY=-gt[1],ht(this,S,Yt).call(this),ht(this,E,Vt).call(this),bt(this,h,G),bt(this,d,Y),this.setDims(G,Y);const Tt=rt?tt/this.scaleFactor/2:0;this.translate(vt-this.translationX-Tt,St-this.translationY-Tt)},Rt=new WeakSet,xe=function(){const{style:rt}=this.div;I(this,c)>=1?(rt.minHeight=`${o}px`,rt.minWidth=`${Math.round(I(this,c)*o)}px`):(rt.minWidth=`${o}px`,rt.minHeight=`${Math.round(o/I(this,c))}px`)},at(Pt,nt),ft(Pt,"_defaultColor",null),ft(Pt,"_defaultOpacity",1),ft(Pt,"_defaultThickness",1),ft(Pt,"_l10nPromise"),ft(Pt,"_type","ink");let l=Pt;t.InkEditor=l},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fitCurve=void 0;const s=e(26);t.fitCurve=s},i=>{function t(b,u,g){if(!Array.isArray(b))throw new TypeError("First argument should be an array");if(b.forEach(h=>{if(!Array.isArray(h)||h.some(d=>typeof d!="number")||h.length!==b[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),b=b.filter((h,d)=>d===0||!h.every((f,v)=>f===b[d-1][v])),b.length<2)return[];const x=b.length,P=m(b[1],b[0]),A=m(b[x-2],b[x-1]);return e(b,P,A,u,g)}function e(b,u,g,x,P){var h,d,f,v,w,C,k,R,H,Z,K,q,W;if(b.length===2)return q=_.vectorLen(_.subtract(b[0],b[1]))/3,h=[b[0],_.addArrays(b[0],_.mulItems(u,q)),_.addArrays(b[1],_.mulItems(g,q)),b[1]],[h];if(d=o(b),[h,v,C]=s(b,d,d,u,g,P),v===0||v<x)return[h];if(v<x*x)for(f=d,w=v,k=C,W=0;W<20;W++){if(f=r(h,b,f),[h,v,C]=s(b,d,f,u,g,P),v<x)return[h];if(C===k){let $=v/w;if($>.9999&&$<1.0001)break}w=v,k=C}return K=[],R=_.subtract(b[C-1],b[C+1]),R.every($=>$===0)&&(R=_.subtract(b[C-1],b[C]),[R[0],R[1]]=[-R[1],R[0]]),H=_.normalize(R),Z=_.mulItems(H,-1),K=K.concat(e(b.slice(0,C+1),u,H,x,P)),K=K.concat(e(b.slice(C),Z,g,x,P)),K}function s(b,u,g,x,P,A){var h,d,f;return h=n(b,g,x,P),[d,f]=l(b,h,u),A&&A({bez:h,points:b,params:u,maxErr:d,maxPoint:f}),[h,d,f]}function n(b,u,g,x){var P,A,h,d,f,v,w,C,k,R,H,Z,K,q,W,$,X,it=b[0],lt=b[b.length-1];for(P=[it,null,null,lt],A=_.zeros_Xx2x2(u.length),K=0,q=u.length;K<q;K++)$=u[K],X=1-$,h=A[K],h[0]=_.mulItems(g,3*$*(X*X)),h[1]=_.mulItems(x,3*X*($*$));for(d=[[0,0],[0,0]],f=[0,0],K=0,q=b.length;K<q;K++)$=u[K],h=A[K],d[0][0]+=_.dot(h[0],h[0]),d[0][1]+=_.dot(h[0],h[1]),d[1][0]+=_.dot(h[0],h[1]),d[1][1]+=_.dot(h[1],h[1]),W=_.subtract(b[K],y.q([it,it,lt,lt],$)),f[0]+=_.dot(h[0],W),f[1]+=_.dot(h[1],W);return v=d[0][0]*d[1][1]-d[1][0]*d[0][1],w=d[0][0]*f[1]-d[1][0]*f[0],C=f[0]*d[1][1]-f[1]*d[0][1],k=v===0?0:C/v,R=v===0?0:w/v,Z=_.vectorLen(_.subtract(it,lt)),H=1e-6*Z,k<H||R<H?(P[1]=_.addArrays(it,_.mulItems(g,Z/3)),P[2]=_.addArrays(lt,_.mulItems(x,Z/3))):(P[1]=_.addArrays(it,_.mulItems(g,k)),P[2]=_.addArrays(lt,_.mulItems(x,R))),P}function r(b,u,g){return g.map((x,P)=>a(b,u[P],x))}function a(b,u,g){var x=_.subtract(y.q(b,g),u),P=y.qprime(b,g),A=_.mulMatrix(x,P),h=_.sum(_.squareItems(P))+2*_.mulMatrix(x,y.qprimeprime(b,g));return h===0?g:g-A/h}function o(b){var u=[],g,x,P;return b.forEach((A,h)=>{g=h?x+_.vectorLen(_.subtract(A,P)):0,u.push(g),x=g,P=A}),u=u.map(A=>A/x),u}function l(b,u,g){var x,P,A,h,d,f,v,w;P=0,A=Math.floor(b.length/2);const C=c(u,10);for(d=0,f=b.length;d<f;d++)v=b[d],w=p(u,g[d],C,10),h=_.subtract(y.q(u,w),v),x=h[0]*h[0]+h[1]*h[1],x>P&&(P=x,A=d);return[P,A]}var c=function(b,u){for(var g,x=[0],P=b[0],A=0,h=1;h<=u;h++)g=y.q(b,h/u),A+=_.vectorLen(_.subtract(g,P)),x.push(A),P=g;return x=x.map(d=>d/A),x};function p(b,u,g,x){if(u<0)return 0;if(u>1)return 1;for(var P,A,h,d,f,v=1;v<=x;v++)if(u<=g[v]){d=(v-1)/x,h=v/x,A=g[v-1],P=g[v],f=(u-A)/(P-A)*(h-d)+d;break}return f}function m(b,u){return _.normalize(_.subtract(b,u))}class _{static zeros_Xx2x2(u){for(var g=[];u--;)g.push([0,0]);return g}static mulItems(u,g){return u.map(x=>x*g)}static mulMatrix(u,g){return u.reduce((x,P,A)=>x+P*g[A],0)}static subtract(u,g){return u.map((x,P)=>x-g[P])}static addArrays(u,g){return u.map((x,P)=>x+g[P])}static addItems(u,g){return u.map(x=>x+g)}static sum(u){return u.reduce((g,x)=>g+x)}static dot(u,g){return _.mulMatrix(u,g)}static vectorLen(u){return Math.hypot(...u)}static divItems(u,g){return u.map(x=>x/g)}static squareItems(u){return u.map(g=>g*g)}static normalize(u){return this.divItems(u,this.vectorLen(u))}}class y{static q(u,g){var x=1-g,P=_.mulItems(u[0],x*x*x),A=_.mulItems(u[1],3*x*x*g),h=_.mulItems(u[2],3*x*g*g),d=_.mulItems(u[3],g*g*g);return _.addArrays(_.addArrays(P,A),_.addArrays(h,d))}static qprime(u,g){var x=1-g,P=_.mulItems(_.subtract(u[1],u[0]),3*x*x),A=_.mulItems(_.subtract(u[2],u[1]),6*x*g),h=_.mulItems(_.subtract(u[3],u[2]),3*g*g);return _.addArrays(_.addArrays(P,A),h)}static qprimeprime(u,g){return _.addArrays(_.mulItems(_.addArrays(_.subtract(u[2],_.mulItems(u[1],2)),u[0]),6*(1-g)),_.mulItems(_.addArrays(_.subtract(u[3],_.mulItems(u[2],2)),u[1]),6*g))}}i.exports=t,i.exports.fitCubic=e,i.exports.createTangent=m},(i,t,e)=>{var E,ve,O,Ae,j,Se;Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var s=e(1),n=e(8),r=e(5),a=e(28),o=e(29);const l=1e3,c=9,p=new WeakSet;function m(Q){return{width:Q[2]-Q[0],height:Q[3]-Q[1]}}class _{static create(S){switch(S.data.annotationType){case s.AnnotationType.LINK:return new b(S);case s.AnnotationType.TEXT:return new u(S);case s.AnnotationType.WIDGET:switch(S.data.fieldType){case"Tx":return new x(S);case"Btn":return S.data.radioButton?new A(S):S.data.checkBox?new P(S):new h(S);case"Ch":return new d(S)}return new g(S);case s.AnnotationType.POPUP:return new f(S);case s.AnnotationType.FREETEXT:return new w(S);case s.AnnotationType.LINE:return new C(S);case s.AnnotationType.SQUARE:return new k(S);case s.AnnotationType.CIRCLE:return new R(S);case s.AnnotationType.POLYLINE:return new H(S);case s.AnnotationType.CARET:return new K(S);case s.AnnotationType.INK:return new q(S);case s.AnnotationType.POLYGON:return new Z(S);case s.AnnotationType.HIGHLIGHT:return new W(S);case s.AnnotationType.UNDERLINE:return new $(S);case s.AnnotationType.SQUIGGLY:return new X(S);case s.AnnotationType.STRIKEOUT:return new it(S);case s.AnnotationType.STAMP:return new lt(S);case s.AnnotationType.FILEATTACHMENT:return new _t(S);default:return new y(S)}}}class y{constructor(S,{isRenderable:M=!1,ignoreBorder:D=!1,createQuadrilaterals:F=!1}={}){this.isRenderable=M,this.data=S.data,this.layer=S.layer,this.page=S.page,this.viewport=S.viewport,this.linkService=S.linkService,this.downloadManager=S.downloadManager,this.imageResourcesPath=S.imageResourcesPath,this.renderForms=S.renderForms,this.svgFactory=S.svgFactory,this.annotationStorage=S.annotationStorage,this.enableScripting=S.enableScripting,this.hasJSActions=S.hasJSActions,this._fieldObjects=S.fieldObjects,this._mouseState=S.mouseState,M&&(this.container=this._createContainer(D)),F&&(this.quadrilaterals=this._createQuadrilaterals(D))}_createContainer(S=!1){const M=this.data,D=this.page,F=this.viewport,L=document.createElement("section"),{width:V,height:nt}=m(M.rect),[dt,et,ot,st]=F.viewBox,ct=ot-dt,pt=st-et;L.setAttribute("data-annotation-id",M.id);const B=s.Util.normalizeRect([M.rect[0],D.view[3]-M.rect[1]+D.view[1],M.rect[2],D.view[3]-M.rect[3]+D.view[1]]);if(!S&&M.borderStyle.width>0){L.style.borderWidth=`${M.borderStyle.width}px`;const xt=M.borderStyle.horizontalCornerRadius,At=M.borderStyle.verticalCornerRadius;if(xt>0||At>0){const kt=`calc(${xt}px * var(--scale-factor)) / calc(${At}px * var(--scale-factor))`;L.style.borderRadius=kt}else if(this instanceof A){const kt=`calc(${V}px * var(--scale-factor)) / calc(${nt}px * var(--scale-factor))`;L.style.borderRadius=kt}switch(M.borderStyle.style){case s.AnnotationBorderStyleType.SOLID:L.style.borderStyle="solid";break;case s.AnnotationBorderStyleType.DASHED:L.style.borderStyle="dashed";break;case s.AnnotationBorderStyleType.BEVELED:(0,s.warn)("Unimplemented border style: beveled");break;case s.AnnotationBorderStyleType.INSET:(0,s.warn)("Unimplemented border style: inset");break;case s.AnnotationBorderStyleType.UNDERLINE:L.style.borderBottomStyle="solid";break}const wt=M.borderColor||null;wt?L.style.borderColor=s.Util.makeHexColor(wt[0]|0,wt[1]|0,wt[2]|0):L.style.borderWidth=0}L.style.left=`${100*(B[0]-dt)/ct}%`,L.style.top=`${100*(B[1]-et)/pt}%`;const{rotation:ut}=M;return M.hasOwnCanvas||ut===0?(L.style.width=`${100*V/ct}%`,L.style.height=`${100*nt/pt}%`):this.setRotation(ut,L),L}setRotation(S,M=this.container){const[D,F,L,V]=this.viewport.viewBox,nt=L-D,dt=V-F,{width:et,height:ot}=m(this.data.rect);let st,ct;S%180===0?(st=100*et/nt,ct=100*ot/dt):(st=100*ot/nt,ct=100*et/dt),M.style.width=`${st}%`,M.style.height=`${ct}%`,M.setAttribute("data-main-rotation",(360-S)%360)}get _commonActions(){const S=(M,D,F)=>{const L=F.detail[M];F.target.style[D]=a.ColorConverters[`${L[0]}_HTML`](L.slice(1))};return(0,s.shadow)(this,"_commonActions",{display:M=>{const D=M.detail.display%2===1;this.container.style.visibility=D?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:D,print:M.detail.display===0||M.detail.display===3})},print:M=>{this.annotationStorage.setValue(this.data.id,{print:M.detail.print})},hidden:M=>{this.container.style.visibility=M.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:M.detail.hidden})},focus:M=>{setTimeout(()=>M.target.focus({preventScroll:!1}),0)},userName:M=>{M.target.title=M.detail.userName},readonly:M=>{M.detail.readonly?M.target.setAttribute("readonly",""):M.target.removeAttribute("readonly")},required:M=>{this._setRequired(M.target,M.detail.required)},bgColor:M=>{S("bgColor","backgroundColor",M)},fillColor:M=>{S("fillColor","backgroundColor",M)},fgColor:M=>{S("fgColor","color",M)},textColor:M=>{S("textColor","color",M)},borderColor:M=>{S("borderColor","borderColor",M)},strokeColor:M=>{S("strokeColor","borderColor",M)},rotation:M=>{const D=M.detail.rotation;this.setRotation(D),this.annotationStorage.setValue(this.data.id,{rotation:D})}})}_dispatchEventFromSandbox(S,M){const D=this._commonActions;for(const F of Object.keys(M.detail)){const L=S[F]||D[F];L&&L(M)}}_setDefaultPropertiesFromJS(S){if(!this.enableScripting)return;const M=this.annotationStorage.getRawValue(this.data.id);if(!M)return;const D=this._commonActions;for(const[F,L]of Object.entries(M)){const V=D[F];if(V){const nt={detail:{[F]:L},target:S};V(nt),delete M[F]}}}_createQuadrilaterals(S=!1){if(!this.data.quadPoints)return null;const M=[],D=this.data.rect;for(const F of this.data.quadPoints)this.data.rect=[F[2].x,F[2].y,F[1].x,F[1].y],M.push(this._createContainer(S));return this.data.rect=D,M}_createPopup(S,M){let D=this.container;this.quadrilaterals&&(S=S||this.quadrilaterals,D=this.quadrilaterals[0]),S||(S=document.createElement("div"),S.className="popupTriggerArea",D.append(S));const L=new v({container:D,trigger:S,color:M.color,titleObj:M.titleObj,modificationDate:M.modificationDate,contentsObj:M.contentsObj,richText:M.richText,hideWrapper:!0}).render();L.style.left="100%",D.append(L)}_renderQuadrilaterals(S){for(const M of this.quadrilaterals)M.className=S;return this.quadrilaterals}render(){(0,s.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(S,M=null){const D=[];if(this._fieldObjects){const F=this._fieldObjects[S];if(F)for(const{page:L,id:V,exportValues:nt}of F){if(L===-1||V===M)continue;const dt=typeof nt=="string"?nt:null,et=document.querySelector(`[data-element-id="${V}"]`);if(et&&!p.has(et)){(0,s.warn)(`_getElementsByName - element not allowed: ${V}`);continue}D.push({id:V,exportValue:dt,domElement:et})}return D}for(const F of document.getElementsByName(S)){const{id:L,exportValue:V}=F;L!==M&&p.has(F)&&D.push({id:L,exportValue:V,domElement:F})}return D}static get platform(){const S=typeof navigator<"u"?navigator.platform:"";return(0,s.shadow)(this,"platform",{isWin:S.includes("Win"),isMac:S.includes("Mac")})}}class b extends y{constructor(S,M=null){super(S,{isRenderable:!0,ignoreBorder:!!(M!=null&&M.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=S.data.isTooltipOnly}render(){const{data:S,linkService:M}=this,D=document.createElement("a");D.setAttribute("data-element-id",S.id);let F=!1;return S.url?(M.addLinkAttributes(D,S.url,S.newWindow),F=!0):S.action?(this._bindNamedAction(D,S.action),F=!0):S.dest?(this._bindLink(D,S.dest),F=!0):(S.actions&&(S.actions.Action||S.actions["Mouse Up"]||S.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(D,S),F=!0),S.resetForm?(this._bindResetFormAction(D,S.resetForm),F=!0):this.isTooltipOnly&&!F&&(this._bindLink(D,""),F=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((L,V)=>{const nt=V===0?D:D.cloneNode();return L.append(nt),L}):(this.container.className="linkAnnotation",F&&this.container.append(D),this.container)}_bindLink(S,M){S.href=this.linkService.getDestinationHash(M),S.onclick=()=>(M&&this.linkService.goToDestination(M),!1),(M||M==="")&&(S.className="internalLink")}_bindNamedAction(S,M){S.href=this.linkService.getAnchorUrl(""),S.onclick=()=>(this.linkService.executeNamedAction(M),!1),S.className="internalLink"}_bindJSAction(S,M){S.href=this.linkService.getAnchorUrl("");const D=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const F of Object.keys(M.actions)){const L=D.get(F);L&&(S[L]=()=>{var V;return(V=this.linkService.eventBus)==null||V.dispatch("dispatcheventinsandbox",{source:this,detail:{id:M.id,name:F}}),!1})}S.onclick||(S.onclick=()=>!1),S.className="internalLink"}_bindResetFormAction(S,M){const D=S.onclick;if(D||(S.href=this.linkService.getAnchorUrl("")),S.className="internalLink",!this._fieldObjects){(0,s.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),D||(S.onclick=()=>!1);return}S.onclick=()=>{var ot;D&&D();const{fields:F,refs:L,include:V}=M,nt=[];if(F.length!==0||L.length!==0){const st=new Set(L);for(const ct of F){const pt=this._fieldObjects[ct]||[];for(const{id:B}of pt)st.add(B)}for(const ct of Object.values(this._fieldObjects))for(const pt of ct)st.has(pt.id)===V&&nt.push(pt)}else for(const st of Object.values(this._fieldObjects))nt.push(...st);const dt=this.annotationStorage,et=[];for(const st of nt){const{id:ct}=st;switch(et.push(ct),st.type){case"text":{const B=st.defaultValue||"";dt.setValue(ct,{value:B});break}case"checkbox":case"radiobutton":{const B=st.defaultValue===st.exportValues;dt.setValue(ct,{value:B});break}case"combobox":case"listbox":{const B=st.defaultValue||"";dt.setValue(ct,{value:B});break}default:continue}const pt=document.querySelector(`[data-element-id="${ct}"]`);if(pt){if(!p.has(pt)){(0,s.warn)(`_bindResetFormAction - element not allowed: ${ct}`);continue}}else continue;pt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((ot=this.linkService.eventBus)==null||ot.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:et,name:"ResetForm"}})),!1}}}class u extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M})}render(){this.container.className="textAnnotation";const S=document.createElement("img");return S.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",S.alt="[{{type}} Annotation]",S.dataset.l10nId="text_annotation_type",S.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(S,this.data),this.container.append(S),this.container}}class g extends y{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(S){const{isWin:M,isMac:D}=y.platform;return M&&S.ctrlKey||D&&S.metaKey}_setEventListener(S,M,D,F){M.includes("mouse")?S.addEventListener(M,L=>{var V;(V=this.linkService.eventBus)==null||V.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:D,value:F(L),shift:L.shiftKey,modifier:this._getKeyModifier(L)}})}):S.addEventListener(M,L=>{var V;(V=this.linkService.eventBus)==null||V.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:D,value:F(L)}})})}_setEventListeners(S,M,D){var F;for(const[L,V]of M)(V==="Action"||(F=this.data.actions)!=null&&F[V])&&this._setEventListener(S,L,V,D)}_setBackgroundColor(S){const M=this.data.backgroundColor||null;S.style.backgroundColor=M===null?"transparent":s.Util.makeHexColor(M[0],M[1],M[2])}_setTextStyle(S){const M=["left","center","right"],{fontColor:D}=this.data.defaultAppearanceData,F=this.data.defaultAppearanceData.fontSize||c,L=S.style;let V;if(this.data.multiLine){const nt=Math.abs(this.data.rect[3]-this.data.rect[1]),dt=Math.round(nt/(s.LINE_FACTOR*F))||1,et=nt/dt;V=Math.min(F,Math.round(et/s.LINE_FACTOR))}else{const nt=Math.abs(this.data.rect[3]-this.data.rect[1]);V=Math.min(F,Math.round(nt/s.LINE_FACTOR))}L.fontSize=`calc(${V}px * var(--scale-factor))`,L.color=s.Util.makeHexColor(D[0],D[1],D[2]),this.data.textAlignment!==null&&(L.textAlign=M[this.data.textAlignment])}_setRequired(S,M){M?S.setAttribute("required",!0):S.removeAttribute("required"),S.setAttribute("aria-required",M)}}class x extends g{constructor(S){const M=S.renderForms||!S.data.hasAppearance&&!!S.data.fieldValue;super(S,{isRenderable:M})}setPropertyOnSiblings(S,M,D,F){const L=this.annotationStorage;for(const V of this._getElementsByName(S.name,S.id))V.domElement&&(V.domElement[M]=D),L.setValue(V.id,{[F]:D})}render(){var F;const S=this.annotationStorage,M=this.data.id;this.container.className="textWidgetAnnotation";let D=null;if(this.renderForms){const L=S.getValue(M,{value:this.data.fieldValue});let V=L.formattedValue||L.value||"";const nt=S.getValue(M,{charLimit:this.data.maxLen}).charLimit;nt&&V.length>nt&&(V=V.slice(0,nt));const dt={userValue:V,formattedValue:null,valueOnFocus:""};this.data.multiLine?(D=document.createElement("textarea"),D.textContent=V,this.data.doNotScroll&&(D.style.overflowY="hidden")):(D=document.createElement("input"),D.type="text",D.setAttribute("value",V),this.data.doNotScroll&&(D.style.overflowX="hidden")),p.add(D),D.setAttribute("data-element-id",M),D.disabled=this.data.readOnly,D.name=this.data.fieldName,D.tabIndex=l,this._setRequired(D,this.data.required),nt&&(D.maxLength=nt),D.addEventListener("input",ot=>{S.setValue(M,{value:ot.target.value}),this.setPropertyOnSiblings(D,"value",ot.target.value,"value")}),D.addEventListener("resetform",ot=>{const st=this.data.defaultFieldValue??"";D.value=dt.userValue=st,dt.formattedValue=null});let et=ot=>{const{formattedValue:st}=dt;st!=null&&(ot.target.value=st),ot.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){D.addEventListener("focus",st=>{dt.userValue&&(st.target.value=dt.userValue),dt.valueOnFocus=st.target.value}),D.addEventListener("updatefromsandbox",st=>{const ct={value(pt){dt.userValue=pt.detail.value??"",S.setValue(M,{value:dt.userValue.toString()}),pt.target.value=dt.userValue},formattedValue(pt){const{formattedValue:B}=pt.detail;dt.formattedValue=B,B!=null&&pt.target!==document.activeElement&&(pt.target.value=B),S.setValue(M,{formattedValue:B})},selRange(pt){pt.target.setSelectionRange(...pt.detail.selRange)},charLimit:pt=>{var At;const{charLimit:B}=pt.detail,{target:ut}=pt;if(B===0){ut.removeAttribute("maxLength");return}ut.setAttribute("maxLength",B);let xt=dt.userValue;!xt||xt.length<=B||(xt=xt.slice(0,B),ut.value=dt.userValue=xt,S.setValue(M,{value:xt}),(At=this.linkService.eventBus)==null||At.dispatch("dispatcheventinsandbox",{source:this,detail:{id:M,name:"Keystroke",value:xt,willCommit:!0,commitKey:1,selStart:ut.selectionStart,selEnd:ut.selectionEnd}}))}};this._dispatchEventFromSandbox(ct,st)}),D.addEventListener("keydown",st=>{var B;let ct=-1;if(st.key==="Escape"?ct=0:st.key==="Enter"?ct=2:st.key==="Tab"&&(ct=3),ct===-1)return;const{value:pt}=st.target;dt.valueOnFocus!==pt&&(dt.userValue=pt,(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:M,name:"Keystroke",value:pt,willCommit:!0,commitKey:ct,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}}))});const ot=et;et=null,D.addEventListener("blur",st=>{var pt;const{value:ct}=st.target;dt.userValue=ct,this._mouseState.isDown&&dt.valueOnFocus!==ct&&((pt=this.linkService.eventBus)==null||pt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:M,name:"Keystroke",value:ct,willCommit:!0,commitKey:1,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}})),ot(st)}),(F=this.data.actions)!=null&&F.Keystroke&&D.addEventListener("beforeinput",st=>{var kt;const{data:ct,target:pt}=st,{value:B,selectionStart:ut,selectionEnd:xt}=pt;let At=ut,wt=xt;switch(st.inputType){case"deleteWordBackward":{const Dt=B.substring(0,ut).match(/\w*[^\w]*$/);Dt&&(At-=Dt[0].length);break}case"deleteWordForward":{const Dt=B.substring(ut).match(/^[^\w]*\w*/);Dt&&(wt+=Dt[0].length);break}case"deleteContentBackward":ut===xt&&(At-=1);break;case"deleteContentForward":ut===xt&&(wt+=1);break}st.preventDefault(),(kt=this.linkService.eventBus)==null||kt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:M,name:"Keystroke",value:B,change:ct||"",willCommit:!1,selStart:At,selEnd:wt}})}),this._setEventListeners(D,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.value)}if(et&&D.addEventListener("blur",et),this.data.comb){const st=(this.data.rect[2]-this.data.rect[0])/nt;D.classList.add("comb"),D.style.letterSpacing=`calc(${st}px * var(--scale-factor) - 1ch)`}}else D=document.createElement("div"),D.textContent=this.data.fieldValue,D.style.verticalAlign="middle",D.style.display="table-cell";return this._setTextStyle(D),this._setBackgroundColor(D),this._setDefaultPropertiesFromJS(D),this.container.append(D),this.container}}class P extends g{constructor(S){super(S,{isRenderable:S.renderForms})}render(){const S=this.annotationStorage,M=this.data,D=M.id;let F=S.getValue(D,{value:M.exportValue===M.fieldValue}).value;typeof F=="string"&&(F=F!=="Off",S.setValue(D,{value:F})),this.container.className="buttonWidgetAnnotation checkBox";const L=document.createElement("input");return p.add(L),L.setAttribute("data-element-id",D),L.disabled=M.readOnly,this._setRequired(L,this.data.required),L.type="checkbox",L.name=M.fieldName,F&&L.setAttribute("checked",!0),L.setAttribute("exportValue",M.exportValue),L.tabIndex=l,L.addEventListener("change",V=>{const{name:nt,checked:dt}=V.target;for(const et of this._getElementsByName(nt,D)){const ot=dt&&et.exportValue===M.exportValue;et.domElement&&(et.domElement.checked=ot),S.setValue(et.id,{value:ot})}S.setValue(D,{value:dt})}),L.addEventListener("resetform",V=>{const nt=M.defaultFieldValue||"Off";V.target.checked=nt===M.exportValue}),this.enableScripting&&this.hasJSActions&&(L.addEventListener("updatefromsandbox",V=>{const nt={value(dt){dt.target.checked=dt.detail.value!=="Off",S.setValue(D,{value:dt.target.checked})}};this._dispatchEventFromSandbox(nt,V)}),this._setEventListeners(L,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],V=>V.target.checked)),this._setBackgroundColor(L),this._setDefaultPropertiesFromJS(L),this.container.append(L),this.container}}class A extends g{constructor(S){super(S,{isRenderable:S.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const S=this.annotationStorage,M=this.data,D=M.id;let F=S.getValue(D,{value:M.fieldValue===M.buttonValue}).value;typeof F=="string"&&(F=F!==M.buttonValue,S.setValue(D,{value:F}));const L=document.createElement("input");if(p.add(L),L.setAttribute("data-element-id",D),L.disabled=M.readOnly,this._setRequired(L,this.data.required),L.type="radio",L.name=M.fieldName,F&&L.setAttribute("checked",!0),L.tabIndex=l,L.addEventListener("change",V=>{const{name:nt,checked:dt}=V.target;for(const et of this._getElementsByName(nt,D))S.setValue(et.id,{value:!1});S.setValue(D,{value:dt})}),L.addEventListener("resetform",V=>{const nt=M.defaultFieldValue;V.target.checked=nt!=null&&nt===M.buttonValue}),this.enableScripting&&this.hasJSActions){const V=M.buttonValue;L.addEventListener("updatefromsandbox",nt=>{const dt={value:et=>{const ot=V===et.detail.value;for(const st of this._getElementsByName(et.target.name)){const ct=ot&&st.id===D;st.domElement&&(st.domElement.checked=ct),S.setValue(st.id,{value:ct})}}};this._dispatchEventFromSandbox(dt,nt)}),this._setEventListeners(L,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],nt=>nt.target.checked)}return this._setBackgroundColor(L),this._setDefaultPropertiesFromJS(L),this.container.append(L),this.container}}class h extends b{constructor(S){super(S,{ignoreBorder:S.data.hasAppearance})}render(){const S=super.render();S.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(S.title=this.data.alternativeText);const M=S.lastChild;return this.enableScripting&&this.hasJSActions&&M&&(this._setDefaultPropertiesFromJS(M),M.addEventListener("updatefromsandbox",D=>{this._dispatchEventFromSandbox({},D)})),S}}class d extends g{constructor(S){super(S,{isRenderable:S.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const S=this.annotationStorage,M=this.data.id,D=S.getValue(M,{value:this.data.fieldValue}),F=document.createElement("select");p.add(F),F.setAttribute("data-element-id",M),F.disabled=this.data.readOnly,this._setRequired(F,this.data.required),F.name=this.data.fieldName,F.tabIndex=l;let L=this.data.combo&&this.data.options.length>0;this.data.combo||(F.size=this.data.options.length,this.data.multiSelect&&(F.multiple=!0)),F.addEventListener("resetform",et=>{const ot=this.data.defaultFieldValue;for(const st of F.options)st.selected=st.value===ot});for(const et of this.data.options){const ot=document.createElement("option");ot.textContent=et.displayValue,ot.value=et.exportValue,D.value.includes(et.exportValue)&&(ot.setAttribute("selected",!0),L=!1),F.append(ot)}let V=null;if(L){const et=document.createElement("option");et.value=" ",et.setAttribute("hidden",!0),et.setAttribute("selected",!0),F.prepend(et),V=()=>{et.remove(),F.removeEventListener("input",V),V=null},F.addEventListener("input",V)}const nt=(et,ot)=>{const st=ot?"value":"textContent",ct=et.target.options;return et.target.multiple?Array.prototype.filter.call(ct,pt=>pt.selected).map(pt=>pt[st]):ct.selectedIndex===-1?null:ct[ct.selectedIndex][st]},dt=et=>{const ot=et.target.options;return Array.prototype.map.call(ot,st=>({displayValue:st.textContent,exportValue:st.value}))};return this.enableScripting&&this.hasJSActions?(F.addEventListener("updatefromsandbox",et=>{const ot={value(st){V==null||V();const ct=st.detail.value,pt=new Set(Array.isArray(ct)?ct:[ct]);for(const B of F.options)B.selected=pt.has(B.value);S.setValue(M,{value:nt(st,!0)})},multipleSelection(st){F.multiple=!0},remove(st){const ct=F.options,pt=st.detail.remove;ct[pt].selected=!1,F.remove(pt),ct.length>0&&Array.prototype.findIndex.call(ct,ut=>ut.selected)===-1&&(ct[0].selected=!0),S.setValue(M,{value:nt(st,!0),items:dt(st)})},clear(st){for(;F.length!==0;)F.remove(0);S.setValue(M,{value:null,items:[]})},insert(st){const{index:ct,displayValue:pt,exportValue:B}=st.detail.insert,ut=F.children[ct],xt=document.createElement("option");xt.textContent=pt,xt.value=B,ut?ut.before(xt):F.append(xt),S.setValue(M,{value:nt(st,!0),items:dt(st)})},items(st){const{items:ct}=st.detail;for(;F.length!==0;)F.remove(0);for(const pt of ct){const{displayValue:B,exportValue:ut}=pt,xt=document.createElement("option");xt.textContent=B,xt.value=ut,F.append(xt)}F.options.length>0&&(F.options[0].selected=!0),S.setValue(M,{value:nt(st,!0),items:dt(st)})},indices(st){const ct=new Set(st.detail.indices);for(const pt of st.target.options)pt.selected=ct.has(pt.index);S.setValue(M,{value:nt(st,!0)})},editable(st){st.target.disabled=!st.detail.editable}};this._dispatchEventFromSandbox(ot,et)}),F.addEventListener("input",et=>{var ct;const ot=nt(et,!0),st=nt(et,!1);S.setValue(M,{value:ot}),(ct=this.linkService.eventBus)==null||ct.dispatch("dispatcheventinsandbox",{source:this,detail:{id:M,name:"Keystroke",value:st,changeEx:ot,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(F,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],et=>et.target.checked)):F.addEventListener("input",function(et){S.setValue(M,{value:nt(et,!0)})}),this.data.combo&&this._setTextStyle(F),this._setBackgroundColor(F),this._setDefaultPropertiesFromJS(F),this.container.append(F),this.container}}class f extends y{constructor(S){var D,F,L;const M=!!((D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M})}render(){const S=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",S.includes(this.data.parentType))return this.container;const M=`[data-annotation-id="${this.data.parentId}"]`,D=this.layer.querySelectorAll(M);if(D.length===0)return this.container;const F=new v({container:this.container,trigger:Array.from(D),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),L=this.page,V=s.Util.normalizeRect([this.data.parentRect[0],L.view[3]-this.data.parentRect[1]+L.view[1],this.data.parentRect[2],L.view[3]-this.data.parentRect[3]+L.view[1]]),nt=V[0]+this.data.parentRect[2]-this.data.parentRect[0],dt=V[1],[et,ot,st,ct]=this.viewport.viewBox,pt=st-et,B=ct-ot;return this.container.style.left=`${100*(nt-et)/pt}%`,this.container.style.top=`${100*(dt-ot)/B}%`,this.container.append(F.render()),this.container}}class v{constructor(S){this.container=S.container,this.trigger=S.trigger,this.color=S.color,this.titleObj=S.titleObj,this.modificationDate=S.modificationDate,this.contentsObj=S.contentsObj,this.richText=S.richText,this.hideWrapper=S.hideWrapper||!1,this.pinned=!1}render(){var nt,dt;const M=document.createElement("div");M.className="popupWrapper",this.hideElement=this.hideWrapper?M:this.container,this.hideElement.hidden=!0;const D=document.createElement("div");D.className="popup";const F=this.color;if(F){const et=.7*(255-F[0])+F[0],ot=.7*(255-F[1])+F[1],st=.7*(255-F[2])+F[2];D.style.backgroundColor=s.Util.makeHexColor(et|0,ot|0,st|0)}const L=document.createElement("h1");L.dir=this.titleObj.dir,L.textContent=this.titleObj.str,D.append(L);const V=n.PDFDateString.toDateObject(this.modificationDate);if(V){const et=document.createElement("span");et.className="popupDate",et.textContent="{{date}}, {{time}}",et.dataset.l10nId="annotation_date_string",et.dataset.l10nArgs=JSON.stringify({date:V.toLocaleDateString(),time:V.toLocaleTimeString()}),D.append(et)}if((nt=this.richText)!=null&&nt.str&&(!((dt=this.contentsObj)!=null&&dt.str)||this.contentsObj.str===this.richText.str))o.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:D}),D.lastChild.className="richText popupContent";else{const et=this._formatContents(this.contentsObj);D.append(et)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const et of this.trigger)et.addEventListener("click",this._toggle.bind(this)),et.addEventListener("mouseover",this._show.bind(this,!1)),et.addEventListener("mouseout",this._hide.bind(this,!1));return D.addEventListener("click",this._hide.bind(this,!0)),M.append(D),M}_formatContents({str:S,dir:M}){const D=document.createElement("p");D.className="popupContent",D.dir=M;const F=S.split(/(?:\r\n?|\n)/);for(let L=0,V=F.length;L<V;++L){const nt=F[L];D.append(document.createTextNode(nt)),L<V-1&&D.append(document.createElement("br"))}return D}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(S=!1){S&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(S=!0){S&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class w extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0}),this.textContent=S.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const S=document.createElement("div");S.className="annotationTextContent",S.setAttribute("role","comment");for(const M of this.textContent){const D=document.createElement("span");D.textContent=M,S.append(D)}this.container.append(S)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class C extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const S=this.data,{width:M,height:D}=m(S.rect),F=this.svgFactory.create(M,D,!0),L=this.svgFactory.createElement("svg:line");return L.setAttribute("x1",S.rect[2]-S.lineCoordinates[0]),L.setAttribute("y1",S.rect[3]-S.lineCoordinates[1]),L.setAttribute("x2",S.rect[2]-S.lineCoordinates[2]),L.setAttribute("y2",S.rect[3]-S.lineCoordinates[3]),L.setAttribute("stroke-width",S.borderStyle.width||1),L.setAttribute("stroke","transparent"),L.setAttribute("fill","transparent"),F.append(L),this.container.append(F),this._createPopup(L,S),this.container}}class k extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const S=this.data,{width:M,height:D}=m(S.rect),F=this.svgFactory.create(M,D,!0),L=S.borderStyle.width,V=this.svgFactory.createElement("svg:rect");return V.setAttribute("x",L/2),V.setAttribute("y",L/2),V.setAttribute("width",M-L),V.setAttribute("height",D-L),V.setAttribute("stroke-width",L||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),F.append(V),this.container.append(F),this._createPopup(V,S),this.container}}class R extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const S=this.data,{width:M,height:D}=m(S.rect),F=this.svgFactory.create(M,D,!0),L=S.borderStyle.width,V=this.svgFactory.createElement("svg:ellipse");return V.setAttribute("cx",M/2),V.setAttribute("cy",D/2),V.setAttribute("rx",M/2-L/2),V.setAttribute("ry",D/2-L/2),V.setAttribute("stroke-width",L||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),F.append(V),this.container.append(F),this._createPopup(V,S),this.container}}class H extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const S=this.data,{width:M,height:D}=m(S.rect),F=this.svgFactory.create(M,D,!0);let L=[];for(const nt of S.vertices){const dt=nt.x-S.rect[0],et=S.rect[3]-nt.y;L.push(dt+","+et)}L=L.join(" ");const V=this.svgFactory.createElement(this.svgElementName);return V.setAttribute("points",L),V.setAttribute("stroke-width",S.borderStyle.width||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),F.append(V),this.container.append(F),this._createPopup(V,S),this.container}}class Z extends H{constructor(S){super(S),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class q extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const S=this.data,{width:M,height:D}=m(S.rect),F=this.svgFactory.create(M,D,!0);for(const L of S.inkLists){let V=[];for(const dt of L){const et=dt.x-S.rect[0],ot=S.rect[3]-dt.y;V.push(`${et},${ot}`)}V=V.join(" ");const nt=this.svgFactory.createElement(this.svgElementName);nt.setAttribute("points",V),nt.setAttribute("stroke-width",S.borderStyle.width||1),nt.setAttribute("stroke","transparent"),nt.setAttribute("fill","transparent"),this._createPopup(nt,S),F.append(nt)}return this.container.append(F),this.container}}class W extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class $ extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class X extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class it extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class lt extends y{constructor(S){var D,F,L;const M=!!(S.data.hasPopup||(D=S.data.titleObj)!=null&&D.str||(F=S.data.contentsObj)!=null&&F.str||(L=S.data.richText)!=null&&L.str);super(S,{isRenderable:M,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class _t extends y{constructor(S){var F;super(S,{isRenderable:!0});const{filename:M,content:D}=this.data.file;this.filename=(0,n.getFilenameFromUrl)(M),this.content=D,(F=this.linkService.eventBus)==null||F.dispatch("fileattachmentannotation",{source:this,filename:M,content:D})}render(){var M,D;this.container.className="fileAttachmentAnnotation";const S=document.createElement("div");return S.className="popupTriggerArea",S.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((M=this.data.titleObj)!=null&&M.str||(D=this.data.contentsObj)!=null&&D.str||this.data.richText)&&this._createPopup(S,this.data),this.container.append(S),this.container}_download(){var S;(S=this.downloadManager)==null||S.openOrDownloadData(this.container,this.content,this.filename)}}const J=class J{static render(S){var nt,dt;const{annotations:M,div:D,viewport:F,accessibilityManager:L}=S;ht(this,O,Ae).call(this,D,F);let V=0;for(const et of M){if(et.annotationType!==s.AnnotationType.POPUP){const{width:st,height:ct}=m(et.rect);if(st<=0||ct<=0)continue}const ot=_.create({data:et,layer:D,page:S.page,viewport:F,linkService:S.linkService,downloadManager:S.downloadManager,imageResourcesPath:S.imageResourcesPath||"",renderForms:S.renderForms!==!1,svgFactory:new n.DOMSVGFactory,annotationStorage:S.annotationStorage||new r.AnnotationStorage,enableScripting:S.enableScripting,hasJSActions:S.hasJSActions,fieldObjects:S.fieldObjects,mouseState:S.mouseState||{isDown:!1}});if(ot.isRenderable){const st=ot.render();if(et.hidden&&(st.style.visibility="hidden"),Array.isArray(st))for(const ct of st)ct.style.zIndex=V++,ht(nt=J,E,ve).call(nt,ct,et.id,D,L);else st.style.zIndex=V++,ot instanceof f?D.prepend(st):ht(dt=J,E,ve).call(dt,st,et.id,D,L)}}ht(this,j,Se).call(this,D,S.annotationCanvasMap)}static update(S){const{annotationCanvasMap:M,div:D,viewport:F}=S;ht(this,O,Ae).call(this,D,F),ht(this,j,Se).call(this,D,M),D.hidden=!1}};E=new WeakSet,ve=function(S,M,D,F){const L=S.firstChild||S;L.id=`${n.AnnotationPrefix}${M}`,D.append(S),F==null||F.moveElementInDOM(D,S,L,!1)},O=new WeakSet,Ae=function(S,{width:M,height:D,rotation:F}){const{style:L}=S,V=F%180!==0,nt=Math.floor(M)+"px",dt=Math.floor(D)+"px";L.width=V?dt:nt,L.height=V?nt:dt,S.setAttribute("data-main-rotation",F)},j=new WeakSet,Se=function(S,M){if(M){for(const[D,F]of M){const L=S.querySelector(`[data-annotation-id="${D}"]`);if(!L)continue;const{firstChild:V}=L;V?V.nodeName==="CANVAS"?V.replaceWith(F):V.before(F):L.append(F)}M.clear()}},at(J,E),at(J,O),at(J,j);let z=J;t.AnnotationLayer=z},(i,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function e(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}class s{static CMYK_G([r,a,o,l]){return["G",1-Math.min(1,.3*r+.59*o+.11*a+l)]}static G_CMYK([r]){return["CMYK",0,0,0,1-r]}static G_RGB([r]){return["RGB",r,r,r]}static G_HTML([r]){const a=e(r);return`#${a}${a}${a}`}static RGB_G([r,a,o]){return["G",.3*r+.59*a+.11*o]}static RGB_HTML([r,a,o]){const l=e(r),c=e(a),p=e(o);return`#${l}${c}${p}`}static T_HTML(){return"#00000000"}static CMYK_RGB([r,a,o,l]){return["RGB",1-Math.min(1,r+l),1-Math.min(1,o+l),1-Math.min(1,a+l)]}static CMYK_HTML(r){const a=this.CMYK_RGB(r).slice(1);return this.RGB_HTML(a)}static RGB_CMYK([r,a,o]){const l=1-r,c=1-a,p=1-o,m=Math.min(l,c,p);return["CMYK",l,c,p,m]}}t.ColorConverters=s},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var s=e(20);class n{static setupStorage(a,o,l,c,p){const m=c.getValue(o,{value:null});switch(l.name){case"textarea":if(m.value!==null&&(a.textContent=m.value),p==="print")break;a.addEventListener("input",_=>{c.setValue(o,{value:_.target.value})});break;case"input":if(l.attributes.type==="radio"||l.attributes.type==="checkbox"){if(m.value===l.attributes.xfaOn?a.setAttribute("checked",!0):m.value===l.attributes.xfaOff&&a.removeAttribute("checked"),p==="print")break;a.addEventListener("change",_=>{c.setValue(o,{value:_.target.checked?_.target.getAttribute("xfaOn"):_.target.getAttribute("xfaOff")})})}else{if(m.value!==null&&a.setAttribute("value",m.value),p==="print")break;a.addEventListener("input",_=>{c.setValue(o,{value:_.target.value})})}break;case"select":if(m.value!==null)for(const _ of l.children)_.attributes.value===m.value&&(_.attributes.selected=!0);a.addEventListener("input",_=>{const y=_.target.options,b=y.selectedIndex===-1?"":y[y.selectedIndex].value;c.setValue(o,{value:b})});break}}static setAttributes({html:a,element:o,storage:l=null,intent:c,linkService:p}){const{attributes:m}=o,_=a instanceof HTMLAnchorElement;m.type==="radio"&&(m.name=`${m.name}-${c}`);for(const[y,b]of Object.entries(m))if(b!=null)switch(y){case"class":b.length&&a.setAttribute(y,b.join(" "));break;case"dataId":break;case"id":a.setAttribute("data-element-id",b);break;case"style":Object.assign(a.style,b);break;case"textContent":a.textContent=b;break;default:(!_||y!=="href"&&y!=="newWindow")&&a.setAttribute(y,b)}_&&p.addLinkAttributes(a,m.href,m.newWindow),l&&m.dataId&&this.setupStorage(a,m.dataId,o,l)}static render(a){var u;const o=a.annotationStorage,l=a.linkService,c=a.xfaHtml,p=a.intent||"display",m=document.createElement(c.name);c.attributes&&this.setAttributes({html:m,element:c,intent:p,linkService:l});const _=[[c,-1,m]],y=a.div;if(y.append(m),a.viewport){const g=`matrix(${a.viewport.transform.join(",")})`;y.style.transform=g}p!=="richText"&&y.setAttribute("class","xfaLayer xfaFont");const b=[];for(;_.length>0;){const[g,x,P]=_.at(-1);if(x+1===g.children.length){_.pop();continue}const A=g.children[++_.at(-1)[1]];if(A===null)continue;const{name:h}=A;if(h==="#text"){const f=document.createTextNode(A.value);b.push(f),P.append(f);continue}let d;if((u=A==null?void 0:A.attributes)!=null&&u.xmlns?d=document.createElementNS(A.attributes.xmlns,h):d=document.createElement(h),P.append(d),A.attributes&&this.setAttributes({html:d,element:A,storage:o,intent:p,linkService:l}),A.children&&A.children.length>0)_.push([A,-1,d]);else if(A.value){const f=document.createTextNode(A.value);s.XfaText.shouldBuildText(h)&&b.push(f),d.append(f)}}for(const g of y.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:b}}static update(a){const o=`matrix(${a.viewport.transform.join(",")})`;a.div.style.transform=o,a.div.hidden=!1}}t.XfaLayer=n},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=P;var s=e(1),n=e(8);const r=1e5,a=30,o=.8,l=new Map,c=/^\s+$/g;function p(A,h){const d=l.get(A);if(d)return d;h.save(),h.font=`${a}px ${A}`;const f=h.measureText("");let v=f.fontBoundingBoxAscent,w=Math.abs(f.fontBoundingBoxDescent);if(v){h.restore();const k=v/(v+w);return l.set(A,k),k}h.strokeStyle="red",h.clearRect(0,0,a,a),h.strokeText("g",0,0);let C=h.getImageData(0,0,a,a).data;w=0;for(let k=C.length-1-3;k>=0;k-=4)if(C[k]>0){w=Math.ceil(k/4/a);break}h.clearRect(0,0,a,a),h.strokeText("A",0,a),C=h.getImageData(0,0,a,a).data,v=0;for(let k=0,R=C.length;k<R;k+=4)if(C[k]>0){v=a-Math.floor(k/4/a);break}if(h.restore(),v){const k=v/(v+w);return l.set(A,k),k}return l.set(A,o),o}function m(A,h,d,f){const v=document.createElement("span"),w=A._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:h.str!=="",hasEOL:h.hasEOL,fontSize:0};A._textDivs.push(v);const C=s.Util.transform(A._viewport.transform,h.transform);let k=Math.atan2(C[1],C[0]);const R=d[h.fontName];R.vertical&&(k+=Math.PI/2);const H=Math.hypot(C[2],C[3]),Z=H*p(R.fontFamily,f);let K,q;k===0?(K=C[4],q=C[5]-Z):(K=C[4]+Z*Math.sin(k),q=C[5]-Z*Math.cos(k)),v.style.left=`${K}px`,v.style.top=`${q}px`,v.style.fontSize=`${H}px`,v.style.fontFamily=R.fontFamily,w.fontSize=H,v.setAttribute("role","presentation"),v.textContent=h.str,v.dir=h.dir,A._fontInspectorEnabled&&(v.dataset.fontName=h.fontName),k!==0&&(w.angle=k*(180/Math.PI));let W=!1;if(h.str.length>1||A._enhanceTextSelection&&c.test(h.str))W=!0;else if(h.str!==" "&&h.transform[0]!==h.transform[3]){const $=Math.abs(h.transform[0]),X=Math.abs(h.transform[3]);$!==X&&Math.max($,X)/Math.min($,X)>1.5&&(W=!0)}if(W&&(R.vertical?w.canvasWidth=h.height*A._viewport.scale:w.canvasWidth=h.width*A._viewport.scale),A._textDivProperties.set(v,w),A._textContentStream&&A._layoutText(v),A._enhanceTextSelection&&w.hasText){let $=1,X=0;k!==0&&($=Math.cos(k),X=Math.sin(k));const it=(R.vertical?h.height:h.width)*A._viewport.scale,lt=H;let _t,z;k!==0?(_t=[$,X,-X,$,K,q],z=s.Util.getAxialAlignedBoundingBox([0,0,it,lt],_t)):z=[K,q,K+it,q+lt],A._bounds.push({left:z[0],top:z[1],right:z[2],bottom:z[3],div:v,size:[it,lt],m:_t})}}function _(A){if(A._canceled)return;const h=A._textDivs,d=A._capability,f=h.length;if(f>r){A._renderingDone=!0,d.resolve();return}if(!A._textContentStream)for(let v=0;v<f;v++)A._layoutText(h[v]);A._renderingDone=!0,d.resolve()}function y(A,h,d){let f=0;for(let v=0;v<d;v++){const w=A[h++];w>0&&(f=f?Math.min(w,f):w)}return f}function b(A){const h=A._bounds,d=A._viewport,f=u(d.width,d.height,h);for(let v=0;v<f.length;v++){const w=h[v].div,C=A._textDivProperties.get(w);if(C.angle===0){C.paddingLeft=h[v].left-f[v].left,C.paddingTop=h[v].top-f[v].top,C.paddingRight=f[v].right-h[v].right,C.paddingBottom=f[v].bottom-h[v].bottom,A._textDivProperties.set(w,C);continue}const k=f[v],R=h[v],H=R.m,Z=H[0],K=H[1],q=[[0,0],[0,R.size[1]],[R.size[0],0],R.size],W=new Float64Array(64);for(let X=0,it=q.length;X<it;X++){const lt=s.Util.applyTransform(q[X],H);W[X+0]=Z&&(k.left-lt[0])/Z,W[X+4]=K&&(k.top-lt[1])/K,W[X+8]=Z&&(k.right-lt[0])/Z,W[X+12]=K&&(k.bottom-lt[1])/K,W[X+16]=K&&(k.left-lt[0])/-K,W[X+20]=Z&&(k.top-lt[1])/Z,W[X+24]=K&&(k.right-lt[0])/-K,W[X+28]=Z&&(k.bottom-lt[1])/Z,W[X+32]=Z&&(k.left-lt[0])/-Z,W[X+36]=K&&(k.top-lt[1])/-K,W[X+40]=Z&&(k.right-lt[0])/-Z,W[X+44]=K&&(k.bottom-lt[1])/-K,W[X+48]=K&&(k.left-lt[0])/K,W[X+52]=Z&&(k.top-lt[1])/-Z,W[X+56]=K&&(k.right-lt[0])/K,W[X+60]=Z&&(k.bottom-lt[1])/-Z}const $=1+Math.min(Math.abs(Z),Math.abs(K));C.paddingLeft=y(W,32,16)/$,C.paddingTop=y(W,48,16)/$,C.paddingRight=y(W,0,16)/$,C.paddingBottom=y(W,16,16)/$,A._textDivProperties.set(w,C)}}function u(A,h,d){const f=d.map(function(w,C){return{x1:w.left,y1:w.top,x2:w.right,y2:w.bottom,index:C,x1New:void 0,x2New:void 0}});g(A,f);const v=new Array(d.length);for(const w of f){const C=w.index;v[C]={left:w.x1New,top:0,right:w.x2New,bottom:0}}d.map(function(w,C){const k=v[C],R=f[C];R.x1=w.top,R.y1=A-k.right,R.x2=w.bottom,R.y2=A-k.left,R.index=C,R.x1New=void 0,R.x2New=void 0}),g(h,f);for(const w of f){const C=w.index;v[C].top=w.x1New,v[C].bottom=w.x2New}return v}function g(A,h){h.sort(function(v,w){return v.x1-w.x1||v.index-w.index});const f=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const v of h){let w=0;for(;w<f.length&&f[w].end<=v.y1;)w++;let C=f.length-1;for(;C>=0&&f[C].start>=v.y2;)C--;let k,R,H,Z,K=-1/0;for(H=w;H<=C;H++){k=f[H],R=k.boundary;let $;R.x2>v.x1?$=R.index>v.index?R.x1New:v.x1:R.x2New===void 0?$=(R.x2+v.x1)/2:$=R.x2New,$>K&&(K=$)}for(v.x1New=K,H=w;H<=C;H++)k=f[H],R=k.boundary,R.x2New===void 0?R.x2>v.x1?R.index>v.index&&(R.x2New=R.x2):R.x2New=K:R.x2New>K&&(R.x2New=Math.max(K,R.x2));const q=[];let W=null;for(H=w;H<=C;H++){k=f[H],R=k.boundary;const $=R.x2>v.x2?R:v;W===$?q.at(-1).end=k.end:(q.push({start:k.start,end:k.end,boundary:$}),W=$)}for(f[w].start<v.y1&&(q[0].start=v.y1,q.unshift({start:f[w].start,end:v.y1,boundary:f[w].boundary})),v.y2<f[C].end&&(q.at(-1).end=v.y2,q.push({start:v.y2,end:f[C].end,boundary:f[C].boundary})),H=w;H<=C;H++){if(k=f[H],R=k.boundary,R.x2New!==void 0)continue;let $=!1;for(Z=w-1;!$&&Z>=0&&f[Z].start>=R.y1;Z--)$=f[Z].boundary===R;for(Z=C+1;!$&&Z<f.length&&f[Z].end<=R.y2;Z++)$=f[Z].boundary===R;for(Z=0;!$&&Z<q.length;Z++)$=q[Z].boundary===R;$||(R.x2New=K)}Array.prototype.splice.apply(f,[w,C-w+1,...q])}for(const v of f){const w=v.boundary;w.x2New===void 0&&(w.x2New=Math.max(A,w.x2))}}class x{constructor({textContent:h,textContentStream:d,container:f,viewport:v,textDivs:w,textContentItemsStr:C,enhanceTextSelection:k}){var R;k&&(0,n.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=h,this._textContentStream=d,this._container=f,this._document=f.ownerDocument,this._viewport=v,this._textDivs=w||[],this._textContentItemsStr=C||[],this._enhanceTextSelection=!!k,this._fontInspectorEnabled=!!((R=globalThis.FontInspector)!=null&&R.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,s.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new s.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(h,d){for(let f=0,v=h.length;f<v;f++){if(h[f].str===void 0){if(h[f].type==="beginMarkedContentProps"||h[f].type==="beginMarkedContent"){const w=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),h[f].id!==null&&this._container.setAttribute("id",`${h[f].id}`),w.append(this._container)}else h[f].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(h[f].str),m(this,h[f],d,this._layoutTextCtx)}}_layoutText(h){const d=this._textDivProperties.get(h);let f="";if(d.canvasWidth!==0&&d.hasText){const{fontFamily:v}=h.style,{fontSize:w}=d;(w!==this._layoutTextLastFontSize||v!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${w*this._devicePixelRatio}px ${v}`,this._layoutTextLastFontSize=w,this._layoutTextLastFontFamily=v);const{width:C}=this._layoutTextCtx.measureText(h.textContent);if(C>0){const k=this._devicePixelRatio*d.canvasWidth/C;this._enhanceTextSelection&&(d.scale=k),f=`scaleX(${k})`}}if(d.angle!==0&&(f=`rotate(${d.angle}deg) ${f}`),f.length>0&&(this._enhanceTextSelection&&(d.originalTransform=f),h.style.transform=f),d.hasText&&this._container.append(h),d.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),this._container.append(v)}}_render(h=0){const d=(0,s.createPromiseCapability)();let f=Object.create(null);const v=this._document.createElement("canvas");if(v.height=v.width=a,this._layoutTextCtx=v.getContext("2d",{alpha:!1}),this._textContent){const w=this._textContent.items,C=this._textContent.styles;this._processItems(w,C),d.resolve()}else if(this._textContentStream){const w=()=>{this._reader.read().then(({value:C,done:k})=>{if(k){d.resolve();return}Object.assign(f,C.styles),this._processItems(C.items,f),w()},d.reject)};this._reader=this._textContentStream.getReader(),w()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');d.promise.then(()=>{f=null,h?this._renderTimer=setTimeout(()=>{_(this),this._renderTimer=null},h):_(this)},this._capability.reject)}expandTextDivs(h=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(b(this),this._bounds=null);const d=[],f=[];for(let v=0,w=this._textDivs.length;v<w;v++){const C=this._textDivs[v],k=this._textDivProperties.get(C);k.hasText&&(h?(d.length=0,f.length=0,k.originalTransform&&d.push(k.originalTransform),k.paddingTop>0?(f.push(`${k.paddingTop}px`),d.push(`translateY(${-k.paddingTop}px)`)):f.push(0),k.paddingRight>0?f.push(`${k.paddingRight/k.scale}px`):f.push(0),k.paddingBottom>0?f.push(`${k.paddingBottom}px`):f.push(0),k.paddingLeft>0?(f.push(`${k.paddingLeft/k.scale}px`),d.push(`translateX(${-k.paddingLeft/k.scale}px)`)):f.push(0),C.style.padding=f.join(" "),d.length&&(C.style.transform=d.join(" "))):(C.style.padding=null,C.style.transform=k.originalTransform))}}}t.TextLayerRenderTask=x;function P(A){const h=new x({textContent:A.textContent,textContentStream:A.textContentStream,container:A.container,viewport:A.viewport,textDivs:A.textDivs,textContentItemsStr:A.textContentItemsStr,enhanceTextSelection:A.enhanceTextSelection});return h._render(A.timeout),h}},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var s=e(8),n=e(1),r=e(3);let a=class{constructor(){(0,n.unreachable)("Not implemented: SVGGraphics")}};t.SVGGraphics=a;{let u=function(d){let f=[];const v=[];for(const w of d){if(w.fn==="save"){f.push({fnId:92,fn:"group",items:[]}),v.push(f),f=f.at(-1).items;continue}w.fn==="restore"?f=v.pop():f.push(w)}return f},g=function(d){if(Number.isInteger(d))return d.toString();const f=d.toFixed(10);let v=f.length-1;if(f[v]!=="0")return f;do v--;while(f[v]==="0");return f.substring(0,f[v]==="."?v:v+1)},x=function(d){if(d[4]===0&&d[5]===0){if(d[1]===0&&d[2]===0)return d[0]===1&&d[3]===1?"":`scale(${g(d[0])} ${g(d[3])})`;if(d[0]===d[3]&&d[1]===-d[2]){const f=Math.acos(d[0])*180/Math.PI;return`rotate(${g(f)})`}}else if(d[0]===1&&d[1]===0&&d[2]===0&&d[3]===1)return`translate(${g(d[4])} ${g(d[5])})`;return`matrix(${g(d[0])} ${g(d[1])} ${g(d[2])} ${g(d[3])} ${g(d[4])} ${g(d[5])})`};const o={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},l="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/1999/xlink",p=["butt","round","square"],m=["miter","round","bevel"],_=function(d,f="",v=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!v)return URL.createObjectURL(new Blob([d],{type:f}));const w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let C=`data:${f};base64,`;for(let k=0,R=d.length;k<R;k+=3){const H=d[k]&255,Z=d[k+1]&255,K=d[k+2]&255,q=H>>2,W=(H&3)<<4|Z>>4,$=k+1<R?(Z&15)<<2|K>>6:64,X=k+2<R?K&63:64;C+=w[q]+w[W]+w[$]+w[X]}return C},y=function(){const d=new Uint8Array([137,80,78,71,13,10,26,10]),f=12,v=new Int32Array(256);for(let K=0;K<256;K++){let q=K;for(let W=0;W<8;W++)q&1?q=3988292384^q>>1&2147483647:q=q>>1&2147483647;v[K]=q}function w(K,q,W){let $=-1;for(let X=q;X<W;X++){const it=($^K[X])&255,lt=v[it];$=$>>>8^lt}return $^-1}function C(K,q,W,$){let X=$;const it=q.length;W[X]=it>>24&255,W[X+1]=it>>16&255,W[X+2]=it>>8&255,W[X+3]=it&255,X+=4,W[X]=K.charCodeAt(0)&255,W[X+1]=K.charCodeAt(1)&255,W[X+2]=K.charCodeAt(2)&255,W[X+3]=K.charCodeAt(3)&255,X+=4,W.set(q,X),X+=q.length;const lt=w(W,$+4,X);W[X]=lt>>24&255,W[X+1]=lt>>16&255,W[X+2]=lt>>8&255,W[X+3]=lt&255}function k(K,q,W){let $=1,X=0;for(let it=q;it<W;++it)$=($+(K[it]&255))%65521,X=(X+$)%65521;return X<<16|$}function R(K){if(!r.isNodeJS)return H(K);try{let q;parseInt(process.versions.node)>=8?q=K:q=Buffer.from(K);const W=require$$5.deflateSync(q,{level:9});return W instanceof Uint8Array?W:new Uint8Array(W)}catch(q){(0,n.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+q)}return H(K)}function H(K){let q=K.length;const W=65535,$=Math.ceil(q/W),X=new Uint8Array(2+q+$*5+4);let it=0;X[it++]=120,X[it++]=156;let lt=0;for(;q>W;)X[it++]=0,X[it++]=255,X[it++]=255,X[it++]=0,X[it++]=0,X.set(K.subarray(lt,lt+W),it),it+=W,lt+=W,q-=W;X[it++]=1,X[it++]=q&255,X[it++]=q>>8&255,X[it++]=~q&65535&255,X[it++]=(~q&65535)>>8&255,X.set(K.subarray(lt),it),it+=K.length-lt;const _t=k(K,0,K.length);return X[it++]=_t>>24&255,X[it++]=_t>>16&255,X[it++]=_t>>8&255,X[it++]=_t&255,X}function Z(K,q,W,$){const X=K.width,it=K.height;let lt,_t,z;const E=K.data;switch(q){case n.ImageKind.GRAYSCALE_1BPP:_t=0,lt=1,z=X+7>>3;break;case n.ImageKind.RGB_24BPP:_t=2,lt=8,z=X*3;break;case n.ImageKind.RGBA_32BPP:_t=6,lt=8,z=X*4;break;default:throw new Error("invalid format")}const T=new Uint8Array((1+z)*it);let O=0,N=0;for(let M=0;M<it;++M)T[O++]=0,T.set(E.subarray(N,N+z),O),N+=z,O+=z;if(q===n.ImageKind.GRAYSCALE_1BPP&&$){O=0;for(let M=0;M<it;M++){O++;for(let D=0;D<z;D++)T[O++]^=255}}const j=new Uint8Array([X>>24&255,X>>16&255,X>>8&255,X&255,it>>24&255,it>>16&255,it>>8&255,it&255,lt,_t,0,0,0]),U=R(T),J=d.length+f*3+j.length+U.length,Q=new Uint8Array(J);let S=0;return Q.set(d,S),S+=d.length,C("IHDR",j,Q,S),S+=f+j.length,C("IDATA",U,Q,S),S+=f+U.length,C("IEND",new Uint8Array(0),Q,S),_(Q,"image/png",W)}return function(q,W,$){const X=q.kind===void 0?n.ImageKind.GRAYSCALE_1BPP:q.kind;return Z(q,X,W,$)}}();class b{constructor(){this.fontSizeScale=1,this.fontWeight=o.fontWeight,this.fontSize=0,this.textMatrix=n.IDENTITY_MATRIX,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=n.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=o.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(f,v){this.x=f,this.y=v}}let P=0,A=0,h=0;t.SVGGraphics=a=class{constructor(d,f,v=!1){(0,s.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new s.DOMSVGFactory,this.current=new b,this.transformMatrix=n.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=d,this.objs=f,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!v,this._operatorIdMapping=[];for(const w in n.OPS)this._operatorIdMapping[n.OPS[w]]=w}save(){this.transformStack.push(this.transformMatrix);const d=this.current;this.extraStack.push(d),this.current=d.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(d){this.save(),this.executeOpTree(d),this.restore()}loadDependencies(d){const f=d.fnArray,v=d.argsArray;for(let w=0,C=f.length;w<C;w++)if(f[w]===n.OPS.dependency)for(const k of v[w]){const R=k.startsWith("g_")?this.commonObjs:this.objs,H=new Promise(Z=>{R.get(k,Z)});this.current.dependencies.push(H)}return Promise.all(this.current.dependencies)}transform(d,f,v,w,C,k){const R=[d,f,v,w,C,k];this.transformMatrix=n.Util.transform(this.transformMatrix,R),this.tgrp=null}getSVG(d,f){this.viewport=f;const v=this._initialize(f);return this.loadDependencies(d).then(()=>(this.transformMatrix=n.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(d)),v))}convertOpList(d){const f=this._operatorIdMapping,v=d.argsArray,w=d.fnArray,C=[];for(let k=0,R=w.length;k<R;k++){const H=w[k];C.push({fnId:H,fn:f[H],args:v[k]})}return u(C)}executeOpTree(d){for(const f of d){const v=f.fn,w=f.fnId,C=f.args;switch(w|0){case n.OPS.beginText:this.beginText();break;case n.OPS.dependency:break;case n.OPS.setLeading:this.setLeading(C);break;case n.OPS.setLeadingMoveText:this.setLeadingMoveText(C[0],C[1]);break;case n.OPS.setFont:this.setFont(C);break;case n.OPS.showText:this.showText(C[0]);break;case n.OPS.showSpacedText:this.showText(C[0]);break;case n.OPS.endText:this.endText();break;case n.OPS.moveText:this.moveText(C[0],C[1]);break;case n.OPS.setCharSpacing:this.setCharSpacing(C[0]);break;case n.OPS.setWordSpacing:this.setWordSpacing(C[0]);break;case n.OPS.setHScale:this.setHScale(C[0]);break;case n.OPS.setTextMatrix:this.setTextMatrix(C[0],C[1],C[2],C[3],C[4],C[5]);break;case n.OPS.setTextRise:this.setTextRise(C[0]);break;case n.OPS.setTextRenderingMode:this.setTextRenderingMode(C[0]);break;case n.OPS.setLineWidth:this.setLineWidth(C[0]);break;case n.OPS.setLineJoin:this.setLineJoin(C[0]);break;case n.OPS.setLineCap:this.setLineCap(C[0]);break;case n.OPS.setMiterLimit:this.setMiterLimit(C[0]);break;case n.OPS.setFillRGBColor:this.setFillRGBColor(C[0],C[1],C[2]);break;case n.OPS.setStrokeRGBColor:this.setStrokeRGBColor(C[0],C[1],C[2]);break;case n.OPS.setStrokeColorN:this.setStrokeColorN(C);break;case n.OPS.setFillColorN:this.setFillColorN(C);break;case n.OPS.shadingFill:this.shadingFill(C[0]);break;case n.OPS.setDash:this.setDash(C[0],C[1]);break;case n.OPS.setRenderingIntent:this.setRenderingIntent(C[0]);break;case n.OPS.setFlatness:this.setFlatness(C[0]);break;case n.OPS.setGState:this.setGState(C[0]);break;case n.OPS.fill:this.fill();break;case n.OPS.eoFill:this.eoFill();break;case n.OPS.stroke:this.stroke();break;case n.OPS.fillStroke:this.fillStroke();break;case n.OPS.eoFillStroke:this.eoFillStroke();break;case n.OPS.clip:this.clip("nonzero");break;case n.OPS.eoClip:this.clip("evenodd");break;case n.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case n.OPS.paintImageXObject:this.paintImageXObject(C[0]);break;case n.OPS.paintInlineImageXObject:this.paintInlineImageXObject(C[0]);break;case n.OPS.paintImageMaskXObject:this.paintImageMaskXObject(C[0]);break;case n.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(C[0],C[1]);break;case n.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case n.OPS.closePath:this.closePath();break;case n.OPS.closeStroke:this.closeStroke();break;case n.OPS.closeFillStroke:this.closeFillStroke();break;case n.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case n.OPS.nextLine:this.nextLine();break;case n.OPS.transform:this.transform(C[0],C[1],C[2],C[3],C[4],C[5]);break;case n.OPS.constructPath:this.constructPath(C[0],C[1]);break;case n.OPS.endPath:this.endPath();break;case 92:this.group(f.items);break;default:(0,n.warn)(`Unimplemented operator ${v}`);break}}}setWordSpacing(d){this.current.wordSpacing=d}setCharSpacing(d){this.current.charSpacing=d}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(d,f,v,w,C,k){const R=this.current;R.textMatrix=R.lineMatrix=[d,f,v,w,C,k],R.textMatrixScale=Math.hypot(d,f),R.x=R.lineX=0,R.y=R.lineY=0,R.xcoords=[],R.ycoords=[],R.tspan=this.svgFactory.createElement("svg:tspan"),R.tspan.setAttributeNS(null,"font-family",R.fontFamily),R.tspan.setAttributeNS(null,"font-size",`${g(R.fontSize)}px`),R.tspan.setAttributeNS(null,"y",g(-R.y)),R.txtElement=this.svgFactory.createElement("svg:text"),R.txtElement.append(R.tspan)}beginText(){const d=this.current;d.x=d.lineX=0,d.y=d.lineY=0,d.textMatrix=n.IDENTITY_MATRIX,d.lineMatrix=n.IDENTITY_MATRIX,d.textMatrixScale=1,d.tspan=this.svgFactory.createElement("svg:tspan"),d.txtElement=this.svgFactory.createElement("svg:text"),d.txtgrp=this.svgFactory.createElement("svg:g"),d.xcoords=[],d.ycoords=[]}moveText(d,f){const v=this.current;v.x=v.lineX+=d,v.y=v.lineY+=f,v.xcoords=[],v.ycoords=[],v.tspan=this.svgFactory.createElement("svg:tspan"),v.tspan.setAttributeNS(null,"font-family",v.fontFamily),v.tspan.setAttributeNS(null,"font-size",`${g(v.fontSize)}px`),v.tspan.setAttributeNS(null,"y",g(-v.y))}showText(d){const f=this.current,v=f.font,w=f.fontSize;if(w===0)return;const C=f.fontSizeScale,k=f.charSpacing,R=f.wordSpacing,H=f.fontDirection,Z=f.textHScale*H,K=v.vertical,q=K?1:-1,W=v.defaultVMetrics,$=w*f.fontMatrix[0];let X=0;for(const _t of d){if(_t===null){X+=H*R;continue}else if(typeof _t=="number"){X+=q*_t*w/1e3;continue}const z=(_t.isSpace?R:0)+k,E=_t.fontChar;let T,O,N=_t.width;if(K){let U;const J=_t.vmetric||W;U=_t.vmetric?J[1]:N*.5,U=-U*$;const Q=J[2]*$;N=J?-J[0]:N,T=U/C,O=(X+Q)/C}else T=X/C,O=0;(_t.isInFont||v.missingFile)&&(f.xcoords.push(f.x+T),K&&f.ycoords.push(-f.y+O),f.tspan.textContent+=E);let j;K?j=N*$-z*H:j=N*$+z*H,X+=j}f.tspan.setAttributeNS(null,"x",f.xcoords.map(g).join(" ")),K?f.tspan.setAttributeNS(null,"y",f.ycoords.map(g).join(" ")):f.tspan.setAttributeNS(null,"y",g(-f.y)),K?f.y-=X:f.x+=X*Z,f.tspan.setAttributeNS(null,"font-family",f.fontFamily),f.tspan.setAttributeNS(null,"font-size",`${g(f.fontSize)}px`),f.fontStyle!==o.fontStyle&&f.tspan.setAttributeNS(null,"font-style",f.fontStyle),f.fontWeight!==o.fontWeight&&f.tspan.setAttributeNS(null,"font-weight",f.fontWeight);const it=f.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;if(it===n.TextRenderingMode.FILL||it===n.TextRenderingMode.FILL_STROKE?(f.fillColor!==o.fillColor&&f.tspan.setAttributeNS(null,"fill",f.fillColor),f.fillAlpha<1&&f.tspan.setAttributeNS(null,"fill-opacity",f.fillAlpha)):f.textRenderingMode===n.TextRenderingMode.ADD_TO_PATH?f.tspan.setAttributeNS(null,"fill","transparent"):f.tspan.setAttributeNS(null,"fill","none"),it===n.TextRenderingMode.STROKE||it===n.TextRenderingMode.FILL_STROKE){const _t=1/(f.textMatrixScale||1);this._setStrokeAttributes(f.tspan,_t)}let lt=f.textMatrix;f.textRise!==0&&(lt=lt.slice(),lt[5]+=f.textRise),f.txtElement.setAttributeNS(null,"transform",`${x(lt)} scale(${g(Z)}, -1)`),f.txtElement.setAttributeNS(l,"xml:space","preserve"),f.txtElement.append(f.tspan),f.txtgrp.append(f.txtElement),this._ensureTransformGroup().append(f.txtElement)}setLeadingMoveText(d,f){this.setLeading(-f),this.moveText(d,f)}addFontStyle(d){if(!d.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const f=_(d.data,d.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${d.loadedName}"; src: url(${f}); }
`}setFont(d){const f=this.current,v=this.commonObjs.get(d[0]);let w=d[1];f.font=v,this.embedFonts&&!v.missingFile&&!this.embeddedFonts[v.loadedName]&&(this.addFontStyle(v),this.embeddedFonts[v.loadedName]=v),f.fontMatrix=v.fontMatrix||n.FONT_IDENTITY_MATRIX;let C="normal";v.black?C="900":v.bold&&(C="bold");const k=v.italic?"italic":"normal";w<0?(w=-w,f.fontDirection=-1):f.fontDirection=1,f.fontSize=w,f.fontFamily=v.loadedName,f.fontWeight=C,f.fontStyle=k,f.tspan=this.svgFactory.createElement("svg:tspan"),f.tspan.setAttributeNS(null,"y",g(-f.y)),f.xcoords=[],f.ycoords=[]}endText(){var f;const d=this.current;d.textRenderingMode&n.TextRenderingMode.ADD_TO_PATH_FLAG&&((f=d.txtElement)!=null&&f.hasChildNodes())&&(d.element=d.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(d){d>0&&(this.current.lineWidth=d)}setLineCap(d){this.current.lineCap=p[d]}setLineJoin(d){this.current.lineJoin=m[d]}setMiterLimit(d){this.current.miterLimit=d}setStrokeAlpha(d){this.current.strokeAlpha=d}setStrokeRGBColor(d,f,v){this.current.strokeColor=n.Util.makeHexColor(d,f,v)}setFillAlpha(d){this.current.fillAlpha=d}setFillRGBColor(d,f,v){this.current.fillColor=n.Util.makeHexColor(d,f,v),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(d){this.current.strokeColor=this._makeColorN_Pattern(d)}setFillColorN(d){this.current.fillColor=this._makeColorN_Pattern(d)}shadingFill(d){const f=this.viewport.width,v=this.viewport.height,w=n.Util.inverseTransform(this.transformMatrix),C=n.Util.applyTransform([0,0],w),k=n.Util.applyTransform([0,v],w),R=n.Util.applyTransform([f,0],w),H=n.Util.applyTransform([f,v],w),Z=Math.min(C[0],k[0],R[0],H[0]),K=Math.min(C[1],k[1],R[1],H[1]),q=Math.max(C[0],k[0],R[0],H[0]),W=Math.max(C[1],k[1],R[1],H[1]),$=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x",Z),$.setAttributeNS(null,"y",K),$.setAttributeNS(null,"width",q-Z),$.setAttributeNS(null,"height",W-K),$.setAttributeNS(null,"fill",this._makeShadingPattern(d)),this.current.fillAlpha<1&&$.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append($)}_makeColorN_Pattern(d){return d[0]==="TilingPattern"?this._makeTilingPattern(d):this._makeShadingPattern(d)}_makeTilingPattern(d){const f=d[1],v=d[2],w=d[3]||n.IDENTITY_MATRIX,[C,k,R,H]=d[4],Z=d[5],K=d[6],q=d[7],W=`shading${h++}`,[$,X,it,lt]=n.Util.normalizeRect([...n.Util.applyTransform([C,k],w),...n.Util.applyTransform([R,H],w)]),[_t,z]=n.Util.singularValueDecompose2dScale(w),E=Z*_t,T=K*z,O=this.svgFactory.createElement("svg:pattern");O.setAttributeNS(null,"id",W),O.setAttributeNS(null,"patternUnits","userSpaceOnUse"),O.setAttributeNS(null,"width",E),O.setAttributeNS(null,"height",T),O.setAttributeNS(null,"x",`${$}`),O.setAttributeNS(null,"y",`${X}`);const N=this.svg,j=this.transformMatrix,U=this.current.fillColor,J=this.current.strokeColor,Q=this.svgFactory.create(it-$,lt-X);if(this.svg=Q,this.transformMatrix=w,q===2){const S=n.Util.makeHexColor(...f);this.current.fillColor=S,this.current.strokeColor=S}return this.executeOpTree(this.convertOpList(v)),this.svg=N,this.transformMatrix=j,this.current.fillColor=U,this.current.strokeColor=J,O.append(Q.childNodes[0]),this.defs.append(O),`url(#${W})`}_makeShadingPattern(d){switch(typeof d=="string"&&(d=this.objs.get(d)),d[0]){case"RadialAxial":const f=`shading${h++}`,v=d[3];let w;switch(d[1]){case"axial":const C=d[4],k=d[5];w=this.svgFactory.createElement("svg:linearGradient"),w.setAttributeNS(null,"id",f),w.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),w.setAttributeNS(null,"x1",C[0]),w.setAttributeNS(null,"y1",C[1]),w.setAttributeNS(null,"x2",k[0]),w.setAttributeNS(null,"y2",k[1]);break;case"radial":const R=d[4],H=d[5],Z=d[6],K=d[7];w=this.svgFactory.createElement("svg:radialGradient"),w.setAttributeNS(null,"id",f),w.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),w.setAttributeNS(null,"cx",H[0]),w.setAttributeNS(null,"cy",H[1]),w.setAttributeNS(null,"r",K),w.setAttributeNS(null,"fx",R[0]),w.setAttributeNS(null,"fy",R[1]),w.setAttributeNS(null,"fr",Z);break;default:throw new Error(`Unknown RadialAxial type: ${d[1]}`)}for(const C of v){const k=this.svgFactory.createElement("svg:stop");k.setAttributeNS(null,"offset",C[0]),k.setAttributeNS(null,"stop-color",C[1]),w.append(k)}return this.defs.append(w),`url(#${f})`;case"Mesh":return(0,n.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${d[0]}`)}}setDash(d,f){this.current.dashArray=d,this.current.dashPhase=f}constructPath(d,f){const v=this.current;let w=v.x,C=v.y,k=[],R=0;for(const H of d)switch(H|0){case n.OPS.rectangle:w=f[R++],C=f[R++];const Z=f[R++],K=f[R++],q=w+Z,W=C+K;k.push("M",g(w),g(C),"L",g(q),g(C),"L",g(q),g(W),"L",g(w),g(W),"Z");break;case n.OPS.moveTo:w=f[R++],C=f[R++],k.push("M",g(w),g(C));break;case n.OPS.lineTo:w=f[R++],C=f[R++],k.push("L",g(w),g(C));break;case n.OPS.curveTo:w=f[R+4],C=f[R+5],k.push("C",g(f[R]),g(f[R+1]),g(f[R+2]),g(f[R+3]),g(w),g(C)),R+=6;break;case n.OPS.curveTo2:k.push("C",g(w),g(C),g(f[R]),g(f[R+1]),g(f[R+2]),g(f[R+3])),w=f[R+2],C=f[R+3],R+=4;break;case n.OPS.curveTo3:w=f[R+2],C=f[R+3],k.push("C",g(f[R]),g(f[R+1]),g(w),g(C),g(w),g(C)),R+=4;break;case n.OPS.closePath:k.push("Z");break}k=k.join(" "),v.path&&d.length>0&&d[0]!==n.OPS.rectangle&&d[0]!==n.OPS.moveTo?k=v.path.getAttributeNS(null,"d")+k:(v.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(v.path)),v.path.setAttributeNS(null,"d",k),v.path.setAttributeNS(null,"fill","none"),v.element=v.path,v.setCurrentPoint(w,C)}endPath(){const d=this.current;if(d.path=null,!this.pendingClip)return;if(!d.element){this.pendingClip=null;return}const f=`clippath${P++}`,v=this.svgFactory.createElement("svg:clipPath");v.setAttributeNS(null,"id",f),v.setAttributeNS(null,"transform",x(this.transformMatrix));const w=d.element.cloneNode(!0);if(this.pendingClip==="evenodd"?w.setAttributeNS(null,"clip-rule","evenodd"):w.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,v.append(w),this.defs.append(v),d.activeClipUrl){d.clipGroup=null;for(const C of this.extraStack)C.clipGroup=null;v.setAttributeNS(null,"clip-path",d.activeClipUrl)}d.activeClipUrl=`url(#${f})`,this.tgrp=null}clip(d){this.pendingClip=d}closePath(){const d=this.current;if(d.path){const f=`${d.path.getAttributeNS(null,"d")}Z`;d.path.setAttributeNS(null,"d",f)}}setLeading(d){this.current.leading=-d}setTextRise(d){this.current.textRise=d}setTextRenderingMode(d){this.current.textRenderingMode=d}setHScale(d){this.current.textHScale=d/100}setRenderingIntent(d){}setFlatness(d){}setGState(d){for(const[f,v]of d)switch(f){case"LW":this.setLineWidth(v);break;case"LC":this.setLineCap(v);break;case"LJ":this.setLineJoin(v);break;case"ML":this.setMiterLimit(v);break;case"D":this.setDash(v[0],v[1]);break;case"RI":this.setRenderingIntent(v);break;case"FL":this.setFlatness(v);break;case"Font":this.setFont(v);break;case"CA":this.setStrokeAlpha(v);break;case"ca":this.setFillAlpha(v);break;default:(0,n.warn)(`Unimplemented graphic state operator ${f}`);break}}fill(){const d=this.current;d.element&&(d.element.setAttributeNS(null,"fill",d.fillColor),d.element.setAttributeNS(null,"fill-opacity",d.fillAlpha),this.endPath())}stroke(){const d=this.current;d.element&&(this._setStrokeAttributes(d.element),d.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(d,f=1){const v=this.current;let w=v.dashArray;f!==1&&w.length>0&&(w=w.map(function(C){return f*C})),d.setAttributeNS(null,"stroke",v.strokeColor),d.setAttributeNS(null,"stroke-opacity",v.strokeAlpha),d.setAttributeNS(null,"stroke-miterlimit",g(v.miterLimit)),d.setAttributeNS(null,"stroke-linecap",v.lineCap),d.setAttributeNS(null,"stroke-linejoin",v.lineJoin),d.setAttributeNS(null,"stroke-width",g(f*v.lineWidth)+"px"),d.setAttributeNS(null,"stroke-dasharray",w.map(g).join(" ")),d.setAttributeNS(null,"stroke-dashoffset",g(f*v.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const d=this.svgFactory.createElement("svg:rect");d.setAttributeNS(null,"x","0"),d.setAttributeNS(null,"y","0"),d.setAttributeNS(null,"width","1px"),d.setAttributeNS(null,"height","1px"),d.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(d)}paintImageXObject(d){const f=d.startsWith("g_")?this.commonObjs.get(d):this.objs.get(d);if(!f){(0,n.warn)(`Dependent image with object ID ${d} is not ready yet`);return}this.paintInlineImageXObject(f)}paintInlineImageXObject(d,f){const v=d.width,w=d.height,C=y(d,this.forceDataSchema,!!f),k=this.svgFactory.createElement("svg:rect");k.setAttributeNS(null,"x","0"),k.setAttributeNS(null,"y","0"),k.setAttributeNS(null,"width",g(v)),k.setAttributeNS(null,"height",g(w)),this.current.element=k,this.clip("nonzero");const R=this.svgFactory.createElement("svg:image");R.setAttributeNS(c,"xlink:href",C),R.setAttributeNS(null,"x","0"),R.setAttributeNS(null,"y",g(-w)),R.setAttributeNS(null,"width",g(v)+"px"),R.setAttributeNS(null,"height",g(w)+"px"),R.setAttributeNS(null,"transform",`scale(${g(1/v)} ${g(-1/w)})`),f?f.append(R):this._ensureTransformGroup().append(R)}paintImageMaskXObject(d){const f=this.current,v=d.width,w=d.height,C=f.fillColor;f.maskId=`mask${A++}`;const k=this.svgFactory.createElement("svg:mask");k.setAttributeNS(null,"id",f.maskId);const R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x","0"),R.setAttributeNS(null,"y","0"),R.setAttributeNS(null,"width",g(v)),R.setAttributeNS(null,"height",g(w)),R.setAttributeNS(null,"fill",C),R.setAttributeNS(null,"mask",`url(#${f.maskId})`),this.defs.append(k),this._ensureTransformGroup().append(R),this.paintInlineImageXObject(d,k)}paintFormXObjectBegin(d,f){if(Array.isArray(d)&&d.length===6&&this.transform(d[0],d[1],d[2],d[3],d[4],d[5]),f){const v=f[2]-f[0],w=f[3]-f[1],C=this.svgFactory.createElement("svg:rect");C.setAttributeNS(null,"x",f[0]),C.setAttributeNS(null,"y",f[1]),C.setAttributeNS(null,"width",g(v)),C.setAttributeNS(null,"height",g(w)),this.current.element=C,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(d){const f=this.svgFactory.create(d.width,d.height),v=this.svgFactory.createElement("svg:defs");f.append(v),this.defs=v;const w=this.svgFactory.createElement("svg:g");return w.setAttributeNS(null,"transform",x(d.transform)),f.append(w),this.svg=w,f}_ensureClipGroup(){if(!this.current.clipGroup){const d=this.svgFactory.createElement("svg:g");d.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(d),this.current.clipGroup=d}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",x(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var s=e(1),n=e(33);const r=require$$5,a=require$$5,o=require$$5,l=require$$5,c=/^file:\/\/\/[a-zA-Z]:\//;function p(A){const h=l.parse(A);return h.protocol==="file:"||h.host?h:/^[a-z]:[/\\]/i.test(A)?l.parse(`file:///${A}`):(h.host||(h.protocol="file:"),h)}class m{constructor(h){this.source=h,this.url=p(h.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new x(this):new u(this),this._fullRequestReader}getRangeReader(h,d){if(d<=this._progressiveDataLength)return null;const f=this.isFsUrl?new P(this,h,d):new g(this,h,d);return this._rangeRequestReaders.push(f),f}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h);for(const d of this._rangeRequestReaders.slice(0))d.cancel(h)}}t.PDFNodeStream=m;class _{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null;const d=h.source;this._contentLength=d.length,this._loaded=0,this._filename=null,this._disableRange=d.disableRange||!1,this._rangeChunkSize=d.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!d.disableStream,this._isRangeSupported=!d.disableRange,this._readableStream=null,this._readCapability=(0,s.createPromiseCapability)(),this._headersCapability=(0,s.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=(0,s.createPromiseCapability)(),this.read()):(this._loaded+=h.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",d=>{this._error(d)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new s.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class y{constructor(h){this._url=h.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,s.createPromiseCapability)();const d=h.source;this._isStreamingSupported=!d.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const h=this._readableStream.read();return h===null?(this._readCapability=(0,s.createPromiseCapability)(),this.read()):(this._loaded+=h.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(h).buffer,done:!1})}cancel(h){if(!this._readableStream){this._error(h);return}this._readableStream.destroy(h)}_error(h){this._storedError=h,this._readCapability.resolve()}_setReadableStream(h){this._readableStream=h,h.on("readable",()=>{this._readCapability.resolve()}),h.on("end",()=>{h.destroy(),this._done=!0,this._readCapability.resolve()}),h.on("error",d=>{this._error(d)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function b(A,h){return{protocol:A.protocol,auth:A.auth,host:A.hostname,port:A.port,path:A.path,method:"GET",headers:h}}class u extends _{constructor(h){super(h);const d=f=>{if(f.statusCode===404){const k=new s.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=k,this._headersCapability.reject(k);return}this._headersCapability.resolve(),this._setReadableStream(f);const v=k=>this._readableStream.headers[k.toLowerCase()],{allowRangeRequests:w,suggestedLength:C}=(0,n.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:h.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=w,this._contentLength=C||this._contentLength,this._filename=(0,n.extractFilenameFromHeader)(v)};this._request=null,this._url.protocol==="http:"?this._request=a.request(b(this._url,h.httpHeaders),d):this._request=o.request(b(this._url,h.httpHeaders),d),this._request.on("error",f=>{this._storedError=f,this._headersCapability.reject(f)}),this._request.end()}}class g extends y{constructor(h,d,f){super(h),this._httpHeaders={};for(const w in h.httpHeaders){const C=h.httpHeaders[w];typeof C>"u"||(this._httpHeaders[w]=C)}this._httpHeaders.Range=`bytes=${d}-${f-1}`;const v=w=>{if(w.statusCode===404){const C=new s.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=C;return}this._setReadableStream(w)};this._request=null,this._url.protocol==="http:"?this._request=a.request(b(this._url,this._httpHeaders),v):this._request=o.request(b(this._url,this._httpHeaders),v),this._request.on("error",w=>{this._storedError=w}),this._request.end()}}class x extends _{constructor(h){super(h);let d=decodeURIComponent(this._url.path);c.test(this._url.href)&&(d=d.replace(/^\//,"")),r.lstat(d,(f,v)=>{if(f){f.code==="ENOENT"&&(f=new s.MissingPDFException(`Missing PDF "${d}".`)),this._storedError=f,this._headersCapability.reject(f);return}this._contentLength=v.size,this._setReadableStream(r.createReadStream(d)),this._headersCapability.resolve()})}}class P extends y{constructor(h,d,f){super(h);let v=decodeURIComponent(this._url.path);c.test(this._url.href)&&(v=v.replace(/^\//,"")),this._setReadableStream(r.createReadStream(v,{start:d,end:f-1}))}}},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=l,t.extractFilenameFromHeader=o,t.validateRangeRequestCapabilities=a,t.validateResponseStatus=c;var s=e(1),n=e(34),r=e(8);function a({getResponseHeader:p,isHttp:m,rangeChunkSize:_,disableRange:y}){const b={allowRangeRequests:!1,suggestedLength:void 0},u=parseInt(p("Content-Length"),10);return!Number.isInteger(u)||(b.suggestedLength=u,u<=2*_)||y||!m||p("Accept-Ranges")!=="bytes"||(p("Content-Encoding")||"identity")!=="identity"||(b.allowRangeRequests=!0),b}function o(p){const m=p("Content-Disposition");if(m){let _=(0,n.getFilenameFromContentDispositionHeader)(m);if(_.includes("%"))try{_=decodeURIComponent(_)}catch{}if((0,r.isPdfFile)(_))return _}return null}function l(p,m){return p===404||p===0&&m.startsWith("file:")?new s.MissingPDFException('Missing PDF "'+m+'".'):new s.UnexpectedResponseException(`Unexpected server response (${p}) while retrieving PDF "${m}".`,p)}function c(p){return p===200||p===206}},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=n;var s=e(1);function n(r){let a=!0,o=l("filename\\*","i").exec(r);if(o){o=o[1];let u=_(o);return u=unescape(u),u=y(u),u=b(u),p(u)}if(o=m(r),o){const u=b(o);return p(u)}if(o=l("filename","i").exec(r),o){o=o[1];let u=_(o);return u=b(u),p(u)}function l(u,g){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function c(u,g){if(u){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const x=new TextDecoder(u,{fatal:!0}),P=(0,s.stringToBytes)(g);g=x.decode(P),a=!1}catch{}}return g}function p(u){return a&&/[\x80-\xff]/.test(u)&&(u=c("utf-8",u),a&&(u=c("iso-8859-1",u))),u}function m(u){const g=[];let x;const P=l("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(x=P.exec(u))!==null;){let[,h,d,f]=x;if(h=parseInt(h,10),h in g){if(h===0)break;continue}g[h]=[d,f]}const A=[];for(let h=0;h<g.length&&h in g;++h){let[d,f]=g[h];f=_(f),d&&(f=unescape(f),h===0&&(f=y(f))),A.push(f)}return A.join("")}function _(u){if(u.startsWith('"')){const g=u.slice(1).split('\\"');for(let x=0;x<g.length;++x){const P=g[x].indexOf('"');P!==-1&&(g[x]=g[x].slice(0,P),g.length=x+1),g[x]=g[x].replace(/\\(.)/g,"$1")}u=g.join('"')}return u}function y(u){const g=u.indexOf("'");if(g===-1)return u;const x=u.slice(0,g),A=u.slice(g+1).replace(/^[^']*'/,"");return c(x,A)}function b(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,x,P,A){if(P==="q"||P==="Q")return A=A.replace(/_/g," "),A=A.replace(/=([0-9a-fA-F]{2})/g,function(h,d){return String.fromCharCode(parseInt(d,16))}),c(x,A);try{A=atob(A)}catch{}return c(x,A)})}return""}},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var s=e(1),n=e(33);const r=200,a=206;function o(_){const y=_.response;return typeof y!="string"?y:(0,s.stringToBytes)(y).buffer}class l{constructor(y,b={}){this.url=y,this.isHttp=/^https?:/i.test(y),this.httpHeaders=this.isHttp&&b.httpHeaders||Object.create(null),this.withCredentials=b.withCredentials||!1,this.getXhr=b.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(y,b,u){const g={begin:y,end:b};for(const x in u)g[x]=u[x];return this.request(g)}requestFull(y){return this.request(y)}request(y){const b=this.getXhr(),u=this.currXhrId++,g=this.pendingRequests[u]={xhr:b};b.open("GET",this.url),b.withCredentials=this.withCredentials;for(const x in this.httpHeaders){const P=this.httpHeaders[x];typeof P>"u"||b.setRequestHeader(x,P)}return this.isHttp&&"begin"in y&&"end"in y?(b.setRequestHeader("Range",`bytes=${y.begin}-${y.end-1}`),g.expectedStatus=a):g.expectedStatus=r,b.responseType="arraybuffer",y.onError&&(b.onerror=function(x){y.onError(b.status)}),b.onreadystatechange=this.onStateChange.bind(this,u),b.onprogress=this.onProgress.bind(this,u),g.onHeadersReceived=y.onHeadersReceived,g.onDone=y.onDone,g.onError=y.onError,g.onProgress=y.onProgress,b.send(null),u}onProgress(y,b){var g;const u=this.pendingRequests[y];u&&((g=u.onProgress)==null||g.call(u,b))}onStateChange(y,b){var h,d,f;const u=this.pendingRequests[y];if(!u)return;const g=u.xhr;if(g.readyState>=2&&u.onHeadersReceived&&(u.onHeadersReceived(),delete u.onHeadersReceived),g.readyState!==4||!(y in this.pendingRequests))return;if(delete this.pendingRequests[y],g.status===0&&this.isHttp){(h=u.onError)==null||h.call(u,g.status);return}const x=g.status||r;if(!(x===r&&u.expectedStatus===a)&&x!==u.expectedStatus){(d=u.onError)==null||d.call(u,g.status);return}const A=o(g);if(x===a){const v=g.getResponseHeader("Content-Range"),w=/bytes (\d+)-(\d+)\/(\d+)/.exec(v);u.onDone({begin:parseInt(w[1],10),chunk:A})}else A?u.onDone({begin:0,chunk:A}):(f=u.onError)==null||f.call(u,g.status)}getRequestXhr(y){return this.pendingRequests[y].xhr}isPendingRequest(y){return y in this.pendingRequests}abortRequest(y){const b=this.pendingRequests[y].xhr;delete this.pendingRequests[y],b.abort()}}class c{constructor(y){this._source=y,this._manager=new l(y.url,{httpHeaders:y.httpHeaders,withCredentials:y.withCredentials}),this._rangeChunkSize=y.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(y){const b=this._rangeRequestReaders.indexOf(y);b>=0&&this._rangeRequestReaders.splice(b,1)}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}getRangeReader(y,b){const u=new m(this._manager,y,b);return u.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(u),u}cancelAllRequests(y){var b;(b=this._fullRequestReader)==null||b.cancel(y);for(const u of this._rangeRequestReaders.slice(0))u.cancel(y)}}t.PDFNetworkStream=c;class p{constructor(y,b){this._manager=y;const u={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=b.url,this._fullRequestId=y.requestFull(u),this._headersReceivedCapability=(0,s.createPromiseCapability)(),this._disableRange=b.disableRange||!1,this._contentLength=b.length,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const y=this._fullRequestId,b=this._manager.getRequestXhr(y),u=P=>b.getResponseHeader(P),{allowRangeRequests:g,suggestedLength:x}=(0,n.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=x||this._contentLength,this._filename=(0,n.extractFilenameFromHeader)(u),this._isRangeSupported&&this._manager.abortRequest(y),this._headersReceivedCapability.resolve()}_onDone(y){if(y&&(this._requests.length>0?this._requests.shift().resolve({value:y.chunk,done:!1}):this._cachedChunks.push(y.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(y){this._storedError=(0,n.createResponseStatusError)(y,this._url),this._headersReceivedCapability.reject(this._storedError);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(y){var b;(b=this.onProgress)==null||b.call(this,{loaded:y.loaded,total:y.lengthComputable?y.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const y=(0,s.createPromiseCapability)();return this._requests.push(y),y.promise}cancel(y){this._done=!0,this._headersReceivedCapability.reject(y);for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class m{constructor(y,b,u){this._manager=y;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=y.url,this._requestId=y.requestRange(b,u,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var y;(y=this.onClosed)==null||y.call(this,this)}_onDone(y){const b=y.chunk;this._requests.length>0?this._requests.shift().resolve({value:b,done:!1}):this._queuedChunk=b,this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(y){this._storedError=(0,n.createResponseStatusError)(y,this._url);for(const b of this._requests)b.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(y){var b;this.isStreamingSupported||(b=this.onProgress)==null||b.call(this,{loaded:y.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const b=this._queuedChunk;return this._queuedChunk=null,{value:b,done:!1}}if(this._done)return{value:void 0,done:!0};const y=(0,s.createPromiseCapability)();return this._requests.push(y),y.promise}cancel(y){this._done=!0;for(const b of this._requests)b.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(i,t,e)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var s=e(1),n=e(33);function r(p,m,_){return{method:"GET",headers:p,signal:_.signal,mode:"cors",credentials:m?"include":"same-origin",redirect:"follow"}}function a(p){const m=new Headers;for(const _ in p){const y=p[_];typeof y>"u"||m.append(_,y)}return m}class o{constructor(m){this.source=m,this.isHttp=/^https?:/i.test(m.url),this.httpHeaders=this.isHttp&&m.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var m;return((m=this._fullRequestReader)==null?void 0:m._loaded)??0}getFullReader(){return(0,s.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(m,_){if(_<=this._progressiveDataLength)return null;const y=new c(this,m,_);return this._rangeRequestReaders.push(y),y}cancelAllRequests(m){this._fullRequestReader&&this._fullRequestReader.cancel(m);for(const _ of this._rangeRequestReaders.slice(0))_.cancel(m)}}t.PDFFetchStream=o;class l{constructor(m){this._stream=m,this._reader=null,this._loaded=0,this._filename=null;const _=m.source;this._withCredentials=_.withCredentials||!1,this._contentLength=_.length,this._headersCapability=(0,s.createPromiseCapability)(),this._disableRange=_.disableRange||!1,this._rangeChunkSize=_.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!_.disableStream,this._isRangeSupported=!_.disableRange,this._headers=a(this._stream.httpHeaders);const y=_.url;fetch(y,r(this._headers,this._withCredentials,this._abortController)).then(b=>{if(!(0,n.validateResponseStatus)(b.status))throw(0,n.createResponseStatusError)(b.status,y);this._reader=b.body.getReader(),this._headersCapability.resolve();const u=P=>b.headers.get(P),{allowRangeRequests:g,suggestedLength:x}=(0,n.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=g,this._contentLength=x||this._contentLength,this._filename=(0,n.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new s.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:m,done:_}=await this._reader.read();return _?{value:m,done:_}:(this._loaded+=m.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(m).buffer,done:!1})}cancel(m){this._reader&&this._reader.cancel(m),this._abortController.abort()}}class c{constructor(m,_,y){this._stream=m,this._reader=null,this._loaded=0;const b=m.source;this._withCredentials=b.withCredentials||!1,this._readCapability=(0,s.createPromiseCapability)(),this._isStreamingSupported=!b.disableStream,this._abortController=new AbortController,this._headers=a(this._stream.httpHeaders),this._headers.append("Range",`bytes=${_}-${y-1}`);const u=b.url;fetch(u,r(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,n.validateResponseStatus)(g.status))throw(0,n.createResponseStatusError)(g.status,u);this._readCapability.resolve(),this._reader=g.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:m,done:_}=await this._reader.read();return _?{value:m,done:_}:(this._loaded+=m.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(m).buffer,done:!1})}cancel(m){this._reader&&this._reader.cancel(m),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(i){var t=__webpack_module_cache__[i];if(t!==void 0)return t.exports;var e=__webpack_module_cache__[i]={exports:{}};return __webpack_modules__[i](e,e.exports,__w_pdfjs_require__),e.exports}var __webpack_exports__={};return(()=>{var i=__webpack_exports__;Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"AnnotationEditorLayer",{enumerable:!0,get:function(){return n.AnnotationEditorLayer}}),Object.defineProperty(i,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(i,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(i,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return r.AnnotationEditorUIManager}}),Object.defineProperty(i,"AnnotationLayer",{enumerable:!0,get:function(){return a.AnnotationLayer}}),Object.defineProperty(i,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(i,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(i,"GlobalWorkerOptions",{enumerable:!0,get:function(){return o.GlobalWorkerOptions}}),Object.defineProperty(i,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(i,"LoopbackPort",{enumerable:!0,get:function(){return e.LoopbackPort}}),Object.defineProperty(i,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(i,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(i,"PDFDataRangeTransport",{enumerable:!0,get:function(){return e.PDFDataRangeTransport}}),Object.defineProperty(i,"PDFDateString",{enumerable:!0,get:function(){return s.PDFDateString}}),Object.defineProperty(i,"PDFWorker",{enumerable:!0,get:function(){return e.PDFWorker}}),Object.defineProperty(i,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(i,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(i,"PixelsPerInch",{enumerable:!0,get:function(){return s.PixelsPerInch}}),Object.defineProperty(i,"RenderingCancelledException",{enumerable:!0,get:function(){return s.RenderingCancelledException}}),Object.defineProperty(i,"SVGGraphics",{enumerable:!0,get:function(){return p.SVGGraphics}}),Object.defineProperty(i,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return t.UNSUPPORTED_FEATURES}}),Object.defineProperty(i,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(i,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(i,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(i,"XfaLayer",{enumerable:!0,get:function(){return m.XfaLayer}}),Object.defineProperty(i,"build",{enumerable:!0,get:function(){return e.build}}),Object.defineProperty(i,"createPromiseCapability",{enumerable:!0,get:function(){return t.createPromiseCapability}}),Object.defineProperty(i,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(i,"getDocument",{enumerable:!0,get:function(){return e.getDocument}}),Object.defineProperty(i,"getFilenameFromUrl",{enumerable:!0,get:function(){return s.getFilenameFromUrl}}),Object.defineProperty(i,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return s.getPdfFilenameFromUrl}}),Object.defineProperty(i,"getXfaPageViewport",{enumerable:!0,get:function(){return s.getXfaPageViewport}}),Object.defineProperty(i,"isPdfFile",{enumerable:!0,get:function(){return s.isPdfFile}}),Object.defineProperty(i,"loadScript",{enumerable:!0,get:function(){return s.loadScript}}),Object.defineProperty(i,"renderTextLayer",{enumerable:!0,get:function(){return c.renderTextLayer}}),Object.defineProperty(i,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(i,"version",{enumerable:!0,get:function(){return e.version}});var t=__w_pdfjs_require__(1),e=__w_pdfjs_require__(4),s=__w_pdfjs_require__(8),n=__w_pdfjs_require__(22),r=__w_pdfjs_require__(7),a=__w_pdfjs_require__(27),o=__w_pdfjs_require__(15),l=__w_pdfjs_require__(3),c=__w_pdfjs_require__(30),p=__w_pdfjs_require__(31),m=__w_pdfjs_require__(29);if(l.isNodeJS){const{PDFNodeStream:_}=__w_pdfjs_require__(32);(0,e.setPDFNetworkStreamFactory)(y=>new _(y))}else{const{PDFNetworkStream:_}=__w_pdfjs_require__(35),{PDFFetchStream:y}=__w_pdfjs_require__(36);(0,e.setPDFNetworkStreamFactory)(b=>(0,s.isValidFetchUrl)(b.url)?new y(b):new _(b))}})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports,pageFlip_browser={exports:{}};(function(i,t){(function(e,s){s(t)})(commonjsGlobal,function(e){class s{constructor(h,d){this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=d,this.nowDrawingDensity=this.createdDensity,this.render=h}setDensity(h){this.createdDensity=h,this.nowDrawingDensity=h}setDrawingDensity(h){this.nowDrawingDensity=h}setPosition(h){this.state.position=h}setAngle(h){this.state.angle=h}setArea(h){this.state.area=h}setHardDrawingAngle(h){this.state.hardDrawingAngle=h}setHardAngle(h){this.state.hardAngle=h,this.state.hardDrawingAngle=h}setOrientation(h){this.orientation=h}getDrawingDensity(){return this.nowDrawingDensity}getDensity(){return this.createdDensity}getHardAngle(){return this.state.hardAngle}}class n extends s{constructor(h,d,f){super(h,f),this.image=null,this.isLoad=!1,this.loadingAngle=0,this.image=new Image,this.image.src=d}draw(h){const d=this.render.getContext(),f=this.render.convertToGlobal(this.state.position),v=this.render.getRect().pageWidth,w=this.render.getRect().height;d.save(),d.translate(f.x,f.y),d.beginPath();for(let C of this.state.area)C!==null&&(C=this.render.convertToGlobal(C),d.lineTo(C.x-f.x,C.y-f.y));d.rotate(this.state.angle),d.clip(),this.isLoad?d.drawImage(this.image,0,0,v,w):this.drawLoader(d,{x:0,y:0},v,w),d.restore()}simpleDraw(h){const d=this.render.getRect(),f=this.render.getContext(),v=d.pageWidth,w=d.height,C=h===1?d.left+d.pageWidth:d.left,k=d.top;this.isLoad?f.drawImage(this.image,C,k,v,w):this.drawLoader(f,{x:C,y:k},v,w)}drawLoader(h,d,f,v){h.beginPath(),h.strokeStyle="rgb(200, 200, 200)",h.fillStyle="rgb(255, 255, 255)",h.lineWidth=1,h.rect(d.x+1,d.y+1,f-1,v-1),h.stroke(),h.fill();const w={x:d.x+f/2,y:d.y+v/2};h.beginPath(),h.lineWidth=10,h.arc(w.x,w.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),h.stroke(),h.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}load(){this.isLoad||(this.image.onload=()=>{this.isLoad=!0})}newTemporaryCopy(){return this}getTemporaryCopy(){return this}hideTemporaryCopy(){}}class r{constructor(h,d){this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=d,this.app=h,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}destroy(){this.pages=[]}createSpread(){this.landscapeSpread=[],this.portraitSpread=[];for(let d=0;d<this.pages.length;d++)this.portraitSpread.push([d]);let h=0;this.isShowCover&&(this.pages[0].setDensity("hard"),this.landscapeSpread.push([h]),h++);for(let d=h;d<this.pages.length;d+=2)d<this.pages.length-1?this.landscapeSpread.push([d,d+1]):(this.landscapeSpread.push([d]),this.pages[d].setDensity("hard"))}getSpread(){return this.render.getOrientation()==="landscape"?this.landscapeSpread:this.portraitSpread}getSpreadIndexByPage(h){const d=this.getSpread();for(let f=0;f<d.length;f++)if(h===d[f][0]||h===d[f][1])return f;return null}getPageCount(){return this.pages.length}getPages(){return this.pages}getPage(h){if(h>=0&&h<this.pages.length)return this.pages[h];throw new Error("Invalid page number")}nextBy(h){const d=this.pages.indexOf(h);return d<this.pages.length-1?this.pages[d+1]:null}prevBy(h){const d=this.pages.indexOf(h);return d>0?this.pages[d-1]:null}getFlippingPage(h){const d=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return h===0?this.pages[d].newTemporaryCopy():this.pages[d-1];{const f=h===0?this.getSpread()[d+1]:this.getSpread()[d-1];return f.length===1||h===0?this.pages[f[0]]:this.pages[f[1]]}}getBottomPage(h){const d=this.currentSpreadIndex;if(this.render.getOrientation()==="portrait")return h===0?this.pages[d+1]:this.pages[d-1];{const f=h===0?this.getSpread()[d+1]:this.getSpread()[d-1];return f.length===1?this.pages[f[0]]:h===0?this.pages[f[1]]:this.pages[f[0]]}}showNext(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}showPrev(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}getCurrentPageIndex(){return this.currentPageIndex}show(h=null){if(h===null&&(h=this.currentPageIndex),h<0||h>=this.pages.length)return;const d=this.getSpreadIndexByPage(h);d!==null&&(this.currentSpreadIndex=d,this.showSpread())}getCurrentSpreadIndex(){return this.currentSpreadIndex}setCurrentSpreadIndex(h){if(!(h>=0&&h<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=h}showSpread(){const h=this.getSpread()[this.currentSpreadIndex];h.length===2?(this.render.setLeftPage(this.pages[h[0]]),this.render.setRightPage(this.pages[h[1]])):this.render.getOrientation()==="landscape"&&h[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[h[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[h[0]])),this.currentPageIndex=h[0],this.app.updatePageIndex(this.currentPageIndex)}}class a extends r{constructor(h,d,f){super(h,d),this.imagesHref=f}load(){for(const h of this.imagesHref){const d=new n(this.render,h,"soft");d.load(),this.pages.push(d)}this.createSpread()}}class o{static GetDistanceBetweenTwoPoint(h,d){return h===null||d===null?1/0:Math.sqrt(Math.pow(d.x-h.x,2)+Math.pow(d.y-h.y,2))}static GetSegmentLength(h){return o.GetDistanceBetweenTwoPoint(h[0],h[1])}static GetAngleBetweenTwoLine(h,d){const f=h[0].y-h[1].y,v=d[0].y-d[1].y,w=h[1].x-h[0].x,C=d[1].x-d[0].x;return Math.acos((f*v+w*C)/(Math.sqrt(f*f+w*w)*Math.sqrt(v*v+C*C)))}static PointInRect(h,d){return d===null?null:d.x>=h.left&&d.x<=h.width+h.left&&d.y>=h.top&&d.y<=h.top+h.height?d:null}static GetRotatedPoint(h,d,f){return{x:h.x*Math.cos(f)+h.y*Math.sin(f)+d.x,y:h.y*Math.cos(f)-h.x*Math.sin(f)+d.y}}static LimitPointToCircle(h,d,f){if(o.GetDistanceBetweenTwoPoint(h,f)<=d)return f;const v=h.x,w=h.y,C=f.x,k=f.y;let R=Math.sqrt(Math.pow(d,2)*Math.pow(v-C,2)/(Math.pow(v-C,2)+Math.pow(w-k,2)))+v;f.x<0&&(R*=-1);let H=(R-v)*(w-k)/(v-C)+w;return v-C+w===0&&(H=d),{x:R,y:H}}static GetIntersectBetweenTwoSegment(h,d,f){return o.PointInRect(h,o.GetIntersectBeetwenTwoLine(d,f))}static GetIntersectBeetwenTwoLine(h,d){const f=h[0].y-h[1].y,v=d[0].y-d[1].y,w=h[1].x-h[0].x,C=d[1].x-d[0].x,k=h[0].x*h[1].y-h[1].x*h[0].y,R=d[0].x*d[1].y-d[1].x*d[0].y,H=f*R-v*k,Z=w*R-C*k,K=-(k*C-R*w)/(f*C-v*w),q=-(f*R-v*k)/(f*C-v*w);if(isFinite(K)&&isFinite(q))return{x:K,y:q};if(Math.abs(H-Z)<.1)throw new Error("Segment included");return null}static GetCordsFromTwoPoint(h,d){const f=Math.abs(h.x-d.x),v=Math.abs(h.y-d.y),w=Math.max(f,v),C=[h];function k(R,H,Z,K,q){return H>R?R+q*(Z/K):H<R?R-q*(Z/K):R}for(let R=1;R<=w;R+=1)C.push({x:k(h.x,d.x,f,w,R),y:k(h.y,d.y,v,w,R)});return C}}class l extends s{constructor(h,d,f){super(h,f),this.copiedElement=null,this.temporaryCopy=null,this.isLoad=!1,this.element=d,this.element.classList.add("stf__item"),this.element.classList.add("--"+f)}newTemporaryCopy(){return this.nowDrawingDensity==="hard"?this:(this.temporaryCopy===null&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new l(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}getTemporaryCopy(){return this.temporaryCopy}hideTemporaryCopy(){this.temporaryCopy!==null&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}draw(h){const d=h||this.nowDrawingDensity,f=this.render.convertToGlobal(this.state.position),v=this.render.getRect().pageWidth,w=this.render.getRect().height;this.element.classList.remove("--simple");const C=`
            display: block;
            z-index: ${this.element.style.zIndex};
            left: 0;
            top: 0;
            width: ${v}px;
            height: ${w}px;
        `;d==="hard"?this.drawHard(C):this.drawSoft(f,C)}drawHard(h=""){const d=this.render.getRect().left+this.render.getRect().width/2,f=this.state.hardDrawingAngle,v=h+`
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                clip-path: none;
                -webkit-clip-path: none;
            `+(this.orientation===0?`transform-origin: ${this.render.getRect().pageWidth}px 0; 
                   transform: translate3d(0, 0, 0) rotateY(${f}deg);`:`transform-origin: 0 0; 
                   transform: translate3d(${d}px, 0, 0) rotateY(${f}deg);`);this.element.style.cssText=v}drawSoft(h,d=""){let f="polygon( ";for(const w of this.state.area)if(w!==null){let C=this.render.getDirection()===1?{x:-w.x+this.state.position.x,y:w.y-this.state.position.y}:{x:w.x-this.state.position.x,y:w.y-this.state.position.y};C=o.GetRotatedPoint(C,{x:0,y:0},this.state.angle),f+=C.x+"px "+C.y+"px, "}f=f.slice(0,-2),f+=")";const v=d+`transform-origin: 0 0; clip-path: ${f}; -webkit-clip-path: ${f};`+(this.render.isSafari()&&this.state.angle===0?`transform: translate(${h.x}px, ${h.y}px);`:`transform: translate3d(${h.x}px, ${h.y}px, 0) rotate(${this.state.angle}rad);`);this.element.style.cssText=v}simpleDraw(h){const d=this.render.getRect(),f=d.pageWidth,v=d.height,w=h===1?d.left+d.pageWidth:d.left,C=d.top;this.element.classList.add("--simple"),this.element.style.cssText=`
            position: absolute; 
            display: block; 
            height: ${v}px; 
            left: ${w}px; 
            top: ${C}px; 
            width: ${f}px; 
            z-index: ${this.render.getSettings().startZIndex+1};`}getElement(){return this.element}load(){this.isLoad=!0}setOrientation(h){super.setOrientation(h),this.element.classList.remove("--left","--right"),this.element.classList.add(h===1?"--right":"--left")}setDrawingDensity(h){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+h),super.setDrawingDensity(h)}}class c extends r{constructor(h,d,f,v){super(h,d),this.element=f,this.pagesElement=v}load(){for(const h of this.pagesElement){const d=new l(this.render,h,h.dataset.density==="hard"?"hard":"soft");d.load(),this.pages.push(d)}this.createSpread()}}class p{constructor(h,d,f,v){this.direction=h,this.corner=d,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=parseInt(f,10),this.pageHeight=parseInt(v,10)}calc(h){try{return this.position=this.calcAngleAndPosition(h),this.calculateIntersectPoint(this.position),!0}catch{return!1}}getFlippingClipArea(){const h=[];let d=!1;return h.push(this.rect.topLeft),h.push(this.topIntersectPoint),this.sideIntersectPoint===null?d=!0:(h.push(this.sideIntersectPoint),this.bottomIntersectPoint===null&&(d=!1)),h.push(this.bottomIntersectPoint),(d||this.corner==="bottom")&&h.push(this.rect.bottomLeft),h}getBottomClipArea(){const h=[];return h.push(this.topIntersectPoint),this.corner==="top"?h.push({x:this.pageWidth,y:0}):(this.topIntersectPoint!==null&&h.push({x:this.pageWidth,y:0}),h.push({x:this.pageWidth,y:this.pageHeight})),this.sideIntersectPoint!==null?o.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&h.push(this.sideIntersectPoint):this.corner==="top"&&h.push({x:this.pageWidth,y:this.pageHeight}),h.push(this.bottomIntersectPoint),h.push(this.topIntersectPoint),h}getAngle(){return this.direction===0?-this.angle:this.angle}getRect(){return this.rect}getPosition(){return this.position}getActiveCorner(){return this.direction===0?this.rect.topLeft:this.rect.topRight}getDirection(){return this.direction}getFlippingProgress(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}getCorner(){return this.corner}getBottomPagePosition(){return this.direction===1?{x:this.pageWidth,y:0}:{x:0,y:0}}getShadowStartPoint(){return this.corner==="top"?this.topIntersectPoint:this.sideIntersectPoint!==null?this.sideIntersectPoint:this.topIntersectPoint}getShadowAngle(){const h=o.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return this.direction===0?h:Math.PI-h}calcAngleAndPosition(h){let d=h;if(this.updateAngleAndGeometry(d),d=this.corner==="top"?this.checkPositionAtCenterLine(d,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(d,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(d.x-this.pageWidth)<1&&Math.abs(d.y)<1)throw new Error("Point is too small");return d}updateAngleAndGeometry(h){this.angle=this.calculateAngle(h),this.rect=this.getPageRect(h)}calculateAngle(h){const d=this.pageWidth-h.x+1,f=this.corner==="bottom"?this.pageHeight-h.y:h.y;let v=2*Math.acos(d/Math.sqrt(f*f+d*d));f<0&&(v=-v);const w=Math.PI-v;if(!isFinite(v)||w>=0&&w<.003)throw new Error("The G point is too small");return this.corner==="bottom"&&(v=-v),v}getPageRect(h){return this.corner==="top"?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],h):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],h)}getRectFromBasePoint(h,d){return{topLeft:this.getRotatedPoint(h[0],d),topRight:this.getRotatedPoint(h[1],d),bottomLeft:this.getRotatedPoint(h[2],d),bottomRight:this.getRotatedPoint(h[3],d)}}getRotatedPoint(h,d){return{x:h.x*Math.cos(this.angle)+h.y*Math.sin(this.angle)+d.x,y:h.y*Math.cos(this.angle)-h.x*Math.sin(this.angle)+d.y}}calculateIntersectPoint(h){const d={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};this.corner==="top"?(this.topIntersectPoint=o.GetIntersectBetweenTwoSegment(d,[h,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=o.GetIntersectBetweenTwoSegment(d,[h,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=o.GetIntersectBetweenTwoSegment(d,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=o.GetIntersectBetweenTwoSegment(d,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=o.GetIntersectBetweenTwoSegment(d,[h,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=o.GetIntersectBetweenTwoSegment(d,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}checkPositionAtCenterLine(h,d,f){let v=h;const w=o.LimitPointToCircle(d,this.pageWidth,v);v!==w&&(v=w,this.updateAngleAndGeometry(v));const C=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2));let k=this.rect.bottomRight,R=this.rect.topLeft;if(this.corner==="bottom"&&(k=this.rect.topRight,R=this.rect.bottomLeft),k.x<=0){const H=o.LimitPointToCircle(f,C,R);H!==v&&(v=H,this.updateAngleAndGeometry(v))}return v}getSegmentToShadowLine(){const h=this.getShadowStartPoint();return[h,h!==this.sideIntersectPoint&&this.sideIntersectPoint!==null?this.sideIntersectPoint:this.bottomIntersectPoint]}}class m{constructor(h,d){this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state="read",this.render=h,this.app=d}fold(h){this.setState("user_fold"),this.calc===null&&this.start(h),this.do(this.render.convertToPage(h))}flip(h){if(this.app.getSettings().disableFlipByClick&&!this.isPointOnCorners(h)||(this.calc!==null&&this.render.finishAnimation(),!this.start(h)))return;const d=this.getBoundsRect();this.setState("flipping");const f=d.height/10,v=this.calc.getCorner()==="bottom"?d.height-f:f,w=this.calc.getCorner()==="bottom"?d.height:0;this.calc.calc({x:d.pageWidth-f,y:v}),this.animateFlippingTo({x:d.pageWidth-f,y:v},{x:-d.pageWidth,y:w},!0)}start(h){this.reset();const d=this.render.convertToBook(h),f=this.getBoundsRect(),v=this.getDirectionByPoint(d),w=d.y>=f.height/2?"bottom":"top";if(!this.checkDirection(v))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(v),this.bottomPage=this.app.getPageCollection().getBottomPage(v),this.render.getOrientation()==="landscape")if(v===1){const C=this.app.getPageCollection().nextBy(this.flippingPage);C!==null&&this.flippingPage.getDensity()!==C.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),C.setDrawingDensity("hard"))}else{const C=this.app.getPageCollection().prevBy(this.flippingPage);C!==null&&this.flippingPage.getDensity()!==C.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),C.setDrawingDensity("hard"))}return this.render.setDirection(v),this.calc=new p(v,w,f.pageWidth.toString(10),f.height.toString(10)),!0}catch{return!1}}do(h){if(this.calc!==null&&this.calc.calc(h)){const d=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),this.calc.getDirection()===0?this.flippingPage.setHardAngle(90*(200-2*d)/100):this.flippingPage.setHardAngle(-90*(200-2*d)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),d,this.calc.getDirection())}}flipToPage(h,d){const f=this.app.getPageCollection().getCurrentSpreadIndex(),v=this.app.getPageCollection().getSpreadIndexByPage(h);try{v>f&&(this.app.getPageCollection().setCurrentSpreadIndex(v-1),this.flipNext(d)),v<f&&(this.app.getPageCollection().setCurrentSpreadIndex(v+1),this.flipPrev(d))}catch{}}flipNext(h){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:h==="top"?1:this.render.getRect().height-2})}flipPrev(h){this.flip({x:10,y:h==="top"?1:this.render.getRect().height-2})}stopMove(){if(this.calc===null)return;const h=this.calc.getPosition(),d=this.getBoundsRect(),f=this.calc.getCorner()==="bottom"?d.height:0;h.x<=0?this.animateFlippingTo(h,{x:-d.pageWidth,y:f},!0):this.animateFlippingTo(h,{x:d.pageWidth,y:f},!1)}showCorner(h){if(!this.checkState("read","fold_corner"))return;const d=this.getBoundsRect(),f=d.pageWidth;if(this.isPointOnCorners(h))if(this.calc===null){if(!this.start(h))return;this.setState("fold_corner"),this.calc.calc({x:f-1,y:1});const v=50,w=this.calc.getCorner()==="bottom"?d.height-1:1,C=this.calc.getCorner()==="bottom"?d.height-v:v;this.animateFlippingTo({x:f-1,y:w},{x:f-v,y:C},!1,!1)}else this.do(this.render.convertToPage(h));else this.setState("read"),this.render.finishAnimation(),this.stopMove()}animateFlippingTo(h,d,f,v=!0){const w=o.GetCordsFromTwoPoint(h,d),C=[];for(const R of w)C.push(()=>this.do(R));const k=this.getAnimationDuration(w.length);this.render.startAnimation(C,k,()=>{this.calc&&(f&&(this.calc.getDirection()===1?this.app.turnToPrevPage():this.app.turnToNextPage()),v&&(this.render.setBottomPage(null),this.render.setFlippingPage(null),this.render.clearShadow(),this.setState("read"),this.reset()))})}getCalculation(){return this.calc}getState(){return this.state}setState(h){this.state!==h&&(this.app.updateState(h),this.state=h)}getDirectionByPoint(h){const d=this.getBoundsRect();if(this.render.getOrientation()==="portrait"){if(h.x-d.pageWidth<=d.width/5)return 1}else if(h.x<d.width/2)return 1;return 0}getAnimationDuration(h){const d=this.app.getSettings().flippingTime;return h>=1e3?d:h/1e3*d}checkDirection(h){return h===0?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}reset(){this.calc=null,this.flippingPage=null,this.bottomPage=null}getBoundsRect(){return this.render.getRect()}checkState(...h){for(const d of h)if(this.state===d)return!0;return!1}isPointOnCorners(h){const d=this.getBoundsRect(),f=d.pageWidth,v=Math.sqrt(Math.pow(f,2)+Math.pow(d.height,2))/5,w=this.render.convertToBook(h);return w.x>0&&w.y>0&&w.x<d.width&&w.y<d.height&&(w.x<v||w.x>d.width-v)&&(w.y<v||w.y>d.height-v)}}class _{constructor(h,d){this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=d,this.app=h;const f=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=f.exec(window.navigator.userAgent)!==null}render(h){if(this.animation!==null){const d=Math.round((h-this.animation.startedAt)/this.animation.durationFrame);d<this.animation.frames.length?this.animation.frames[d]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=h,this.drawFrame()}start(){this.update();const h=d=>{this.render(d),requestAnimationFrame(h)};requestAnimationFrame(h)}startAnimation(h,d,f){this.finishAnimation(),this.animation={frames:h,duration:d,durationFrame:d/h.length,onAnimateEnd:f,startedAt:this.timer}}finishAnimation(){this.animation!==null&&(this.animation.frames[this.animation.frames.length-1](),this.animation.onAnimateEnd!==null&&this.animation.onAnimateEnd()),this.animation=null}update(){this.boundsRect=null;const h=this.calculateBoundsRect();this.orientation!==h&&(this.orientation=h,this.app.updateOrientation(h))}calculateBoundsRect(){let h="landscape";const d=this.getBlockWidth(),f=d/2,v=this.getBlockHeight()/2,w=this.setting.width/this.setting.height;let C=this.setting.width,k=this.setting.height,R=f-C;return this.setting.size==="stretch"?(d<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(h="portrait"),C=h==="portrait"?this.getBlockWidth():this.getBlockWidth()/2,C>this.setting.maxWidth&&(C=this.setting.maxWidth),k=C/w,k>this.getBlockHeight()&&(k=this.getBlockHeight(),C=k*w),R=h==="portrait"?f-C/2-C:f-C):d<2*C&&this.app.getSettings().usePortrait&&(h="portrait",R=f-C/2-C),this.boundsRect={left:R,top:v-k/2,width:2*C,height:k,pageWidth:C},h}setShadowData(h,d,f,v){if(!this.app.getSettings().drawShadow)return;const w=100*this.getSettings().maxShadowOpacity;this.shadow={pos:h,angle:d,width:3*this.getRect().pageWidth/4*f/100,opacity:(100-f)*w/100/100,direction:v,progress:2*f}}clearShadow(){this.shadow=null}getBlockWidth(){return this.app.getUI().getDistElement().offsetWidth}getBlockHeight(){return this.app.getUI().getDistElement().offsetHeight}getDirection(){return this.direction}getRect(){return this.boundsRect===null&&this.calculateBoundsRect(),this.boundsRect}getSettings(){return this.app.getSettings()}getOrientation(){return this.orientation}setPageRect(h){this.pageRect=h}setDirection(h){this.direction=h}setRightPage(h){h!==null&&h.setOrientation(1),this.rightPage=h}setLeftPage(h){h!==null&&h.setOrientation(0),this.leftPage=h}setBottomPage(h){h!==null&&h.setOrientation(this.direction===1?0:1),this.bottomPage=h}setFlippingPage(h){h!==null&&h.setOrientation(this.direction===0&&this.orientation!=="portrait"?0:1),this.flippingPage=h}convertToBook(h){const d=this.getRect();return{x:h.x-d.left,y:h.y-d.top}}isSafari(){return this.safari}convertToPage(h,d){d||(d=this.direction);const f=this.getRect();return{x:d===0?h.x-f.left-f.width/2:f.width/2-h.x+f.left,y:h.y-f.top}}convertToGlobal(h,d){if(d||(d=this.direction),h==null)return null;const f=this.getRect();return{x:d===0?h.x+f.left+f.width/2:f.width/2-h.x+f.left,y:h.y+f.top}}convertRectToGlobal(h,d){return d||(d=this.direction),{topLeft:this.convertToGlobal(h.topLeft,d),topRight:this.convertToGlobal(h.topRight,d),bottomLeft:this.convertToGlobal(h.bottomLeft,d),bottomRight:this.convertToGlobal(h.bottomRight,d)}}}class y extends _{constructor(h,d,f){super(h,d),this.canvas=f,this.ctx=f.getContext("2d")}getContext(){return this.ctx}reload(){}drawFrame(){this.clear(),this.orientation!=="portrait"&&this.leftPage!=null&&this.leftPage.simpleDraw(0),this.rightPage!=null&&this.rightPage.simpleDraw(1),this.bottomPage!=null&&this.bottomPage.draw(),this.drawBookShadow(),this.flippingPage!=null&&this.flippingPage.draw(),this.shadow!=null&&(this.drawOuterShadow(),this.drawInnerShadow());const h=this.getRect();this.orientation==="portrait"&&(this.ctx.beginPath(),this.ctx.rect(h.left+h.pageWidth,h.top,h.width,h.height),this.ctx.clip())}drawBookShadow(){const h=this.getRect();this.ctx.save(),this.ctx.beginPath();const d=h.width/20;this.ctx.rect(h.left,h.top,h.width,h.height);const f={x:h.left+h.width/2-d/2,y:0};this.ctx.translate(f.x,f.y);const v=this.ctx.createLinearGradient(0,0,d,0);v.addColorStop(0,"rgba(0, 0, 0, 0)"),v.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),v.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),v.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),v.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),v.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=v,this.ctx.fillRect(0,0,d,2*h.height),this.ctx.restore()}drawOuterShadow(){const h=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(h.left,h.top,h.width,h.height);const d=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(d.x,d.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const f=this.ctx.createLinearGradient(0,0,this.shadow.width,0);this.shadow.direction===0?(this.ctx.translate(0,-100),f.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),f.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),f.addColorStop(0,"rgba(0, 0, 0, 0)"),f.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=f,this.ctx.fillRect(0,0,this.shadow.width,2*h.height),this.ctx.restore()}drawInnerShadow(){const h=this.getRect();this.ctx.save(),this.ctx.beginPath();const d=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),f=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(f.topLeft.x,f.topLeft.y),this.ctx.lineTo(f.topRight.x,f.topRight.y),this.ctx.lineTo(f.bottomRight.x,f.bottomRight.y),this.ctx.lineTo(f.bottomLeft.x,f.bottomLeft.y),this.ctx.translate(d.x,d.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const v=3*this.shadow.width/4,w=this.ctx.createLinearGradient(0,0,v,0);this.shadow.direction===0?(this.ctx.translate(-v,-100),w.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),w.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),w.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),w.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),w.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),w.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),w.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),w.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=w,this.ctx.fillRect(0,0,v,2*h.height),this.ctx.restore()}clear(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}class b{constructor(h,d,f){this.touchPoint=null,this.swipeTimeout=250,this.onResize=()=>{this.update()},this.onMouseDown=w=>{if(this.checkTarget(w.target)){const C=this.getMousePos(w.clientX,w.clientY);this.app.startUserTouch(C),w.preventDefault()}},this.onTouchStart=w=>{if(this.checkTarget(w.target)&&w.changedTouches.length>0){const C=w.changedTouches[0],k=this.getMousePos(C.clientX,C.clientY);this.touchPoint={point:k,time:Date.now()},setTimeout(()=>{this.touchPoint!==null&&this.app.startUserTouch(k)},this.swipeTimeout),this.app.getSettings().mobileScrollSupport||w.preventDefault()}},this.onMouseUp=w=>{const C=this.getMousePos(w.clientX,w.clientY);this.app.userStop(C)},this.onMouseMove=w=>{const C=this.getMousePos(w.clientX,w.clientY);this.app.userMove(C,!1)},this.onTouchMove=w=>{if(w.changedTouches.length>0){const C=w.changedTouches[0],k=this.getMousePos(C.clientX,C.clientY);this.app.getSettings().mobileScrollSupport?(this.touchPoint!==null&&(Math.abs(this.touchPoint.point.x-k.x)>10||this.app.getState()!=="read")&&w.cancelable&&this.app.userMove(k,!0),this.app.getState()!=="read"&&w.preventDefault()):this.app.userMove(k,!0)}},this.onTouchEnd=w=>{if(w.changedTouches.length>0){const C=w.changedTouches[0],k=this.getMousePos(C.clientX,C.clientY);let R=!1;if(this.touchPoint!==null){const H=k.x-this.touchPoint.point.x,Z=Math.abs(k.y-this.touchPoint.point.y);Math.abs(H)>this.swipeDistance&&Z<2*this.swipeDistance&&Date.now()-this.touchPoint.time<this.swipeTimeout&&(H>0?this.app.flipPrev(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"):this.app.flipNext(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"),R=!0),this.touchPoint=null}this.app.userStop(k,R)}},this.parentElement=h,h.classList.add("stf__parent"),h.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=h.querySelector(".stf__wrapper"),this.app=d;const v=this.app.getSettings().usePortrait?1:2;h.style.minWidth=f.minWidth*v+"px",h.style.minHeight=f.minHeight+"px",f.size==="fixed"&&(h.style.minWidth=f.width*v+"px",h.style.minHeight=f.height+"px"),f.autoSize&&(h.style.width="100%",h.style.maxWidth=2*f.maxWidth+"px"),h.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=f.swipeDistance}destroy(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}getDistElement(){return this.distElement}getWrapper(){return this.wrapper}setOrientationStyle(h){this.wrapper.classList.remove("--portrait","--landscape"),h==="portrait"?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}removeHandlers(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}setHandlers(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}getMousePos(h,d){const f=this.distElement.getBoundingClientRect();return{x:h-f.left,y:d-f.top}}checkTarget(h){return!this.app.getSettings().clickEventForward||!["a","button"].includes(h.tagName.toLowerCase())}}class u extends b{constructor(h,d,f,v){super(h,d,f),this.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),this.distElement=h.querySelector(".stf__block"),this.items=v;for(const w of v)this.distElement.appendChild(w);this.setHandlers()}clear(){for(const h of this.items)this.parentElement.appendChild(h)}updateItems(h){this.removeHandlers(),this.distElement.innerHTML="";for(const d of h)this.distElement.appendChild(d);this.items=h,this.setHandlers()}update(){this.app.getRender().update()}}class g extends b{constructor(h,d,f){super(h,d,f),this.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',this.canvas=h.querySelectorAll("canvas")[0],this.distElement=this.canvas,this.resizeCanvas(),this.setHandlers()}resizeCanvas(){const h=getComputedStyle(this.canvas),d=parseInt(h.getPropertyValue("width"),10),f=parseInt(h.getPropertyValue("height"),10);this.canvas.width=d,this.canvas.height=f}getCanvas(){return this.canvas}update(){this.resizeCanvas(),this.app.getRender().update()}}class x extends _{constructor(h,d,f){super(h,d),this.outerShadow=null,this.innerShadow=null,this.hardShadow=null,this.hardInnerShadow=null,this.element=f,this.createShadows()}createShadows(){this.element.insertAdjacentHTML("beforeend",`<div class="stf__outerShadow"></div>
             <div class="stf__innerShadow"></div>
             <div class="stf__hardShadow"></div>
             <div class="stf__hardInnerShadow"></div>`),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}clearShadow(){super.clearShadow(),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}reload(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}drawHardInnerShadow(){const h=this.getRect(),d=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress;let f=(100-d)*(2.5*h.pageWidth)/100+20;f>h.pageWidth&&(f=h.pageWidth);let v=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+5).toString(10)};
            width: ${f}px;
            height: ${h.height}px;
            background: linear-gradient(to right,
                rgba(0, 0, 0, ${this.shadow.opacity*d/100}) 5%,
                rgba(0, 0, 0, 0) 100%);
            left: ${h.left+h.width/2}px;
            transform-origin: 0 0;
        `;v+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0);":"transform: translate3d(0, 0, 0) rotateY(180deg);",this.hardInnerShadow.style.cssText=v}drawHardOuterShadow(){const h=this.getRect();let d=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*h.pageWidth)/100+20;d>h.pageWidth&&(d=h.pageWidth);let f=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+4).toString(10)};
            width: ${d}px;
            height: ${h.height}px;
            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);
            left: ${h.left+h.width/2}px;
            transform-origin: 0 0;
        `;f+=this.getDirection()===0&&this.shadow.progress>100||this.getDirection()===1&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0) rotateY(180deg);":"transform: translate3d(0, 0, 0);",this.hardShadow.style.cssText=f}drawInnerShadow(){const h=this.getRect(),d=3*this.shadow.width/4,f=this.getDirection()===0?d:0,v=this.getDirection()===0?"to left":"to right",w=this.convertToGlobal(this.shadow.pos),C=this.shadow.angle+3*Math.PI/2,k=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];let R="polygon( ";for(const Z of k){let K=this.getDirection()===1?{x:-Z.x+this.shadow.pos.x,y:Z.y-this.shadow.pos.y}:{x:Z.x-this.shadow.pos.x,y:Z.y-this.shadow.pos.y};K=o.GetRotatedPoint(K,{x:f,y:100},C),R+=K.x+"px "+K.y+"px, "}R=R.slice(0,-2),R+=")";const H=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${d}px;
            height: ${2*h.height}px;
            background: linear-gradient(${v},
                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,
                rgba(0, 0, 0, 0.05) 15%,
                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,
                rgba(0, 0, 0, 0) 100%);
            transform-origin: ${f}px 100px;
            transform: translate3d(${w.x-f}px, ${w.y-100}px, 0) rotate(${C}rad);
            clip-path: ${R};
            -webkit-clip-path: ${R};
        `;this.innerShadow.style.cssText=H}drawOuterShadow(){const h=this.getRect(),d=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),f=this.shadow.angle+3*Math.PI/2,v=this.getDirection()===1?this.shadow.width:0,w=this.getDirection()===0?"to right":"to left",C=[{x:0,y:0},{x:h.pageWidth,y:0},{x:h.pageWidth,y:h.height},{x:0,y:h.height}];let k="polygon( ";for(const H of C)if(H!==null){let Z=this.getDirection()===1?{x:-H.x+this.shadow.pos.x,y:H.y-this.shadow.pos.y}:{x:H.x-this.shadow.pos.x,y:H.y-this.shadow.pos.y};Z=o.GetRotatedPoint(Z,{x:v,y:100},f),k+=Z.x+"px "+Z.y+"px, "}k=k.slice(0,-2),k+=")";const R=`
            display: block;
            z-index: ${(this.getSettings().startZIndex+10).toString(10)};
            width: ${this.shadow.width}px;
            height: ${2*h.height}px;
            background: linear-gradient(${w}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));
            transform-origin: ${v}px 100px;
            transform: translate3d(${d.x-v}px, ${d.y-100}px, 0) rotate(${f}rad);
            clip-path: ${k};
            -webkit-clip-path: ${k};
        `;this.outerShadow.style.cssText=R}drawLeftPage(){this.orientation!=="portrait"&&this.leftPage!==null&&(this.direction===1&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(0))}drawRightPage(){this.rightPage!==null&&(this.direction===0&&this.flippingPage!==null&&this.flippingPage.getDrawingDensity()==="hard"?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(1))}drawBottomPage(){if(this.bottomPage===null)return;const h=this.flippingPage!=null?this.flippingPage.getDrawingDensity():null;this.orientation==="portrait"&&this.direction===1||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(h))}drawFrame(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),this.flippingPage!=null&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),this.shadow!=null&&this.flippingPage!==null&&(this.flippingPage.getDrawingDensity()==="soft"?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}clear(){for(const h of this.app.getPageCollection().getPages())h!==this.leftPage&&h!==this.rightPage&&h!==this.flippingPage&&h!==this.bottomPage&&(h.getElement().style.cssText="display: none"),h.getTemporaryCopy()!==this.flippingPage&&h.hideTemporaryCopy()}update(){super.update(),this.rightPage!==null&&this.rightPage.setOrientation(1),this.leftPage!==null&&this.leftPage.setOrientation(0)}}class P{constructor(){this._default={startPage:0,size:"fixed",width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!0,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}getSettings(h){const d=this._default;if(Object.assign(d,h),d.size!=="stretch"&&d.size!=="fixed")throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(d.width<=0||d.height<=0)throw new Error("Invalid width or height");if(d.flippingTime<=0)throw new Error("Invalid flipping time");return d.size==="stretch"?(d.minWidth<=0&&(d.minWidth=100),d.maxWidth<d.minWidth&&(d.maxWidth=2e3),d.minHeight<=0&&(d.minHeight=100),d.maxHeight<d.minHeight&&(d.maxHeight=2e3)):(d.minWidth=d.width,d.maxWidth=d.width,d.minHeight=d.height,d.maxHeight=d.height),d}}(function(A,h){h===void 0&&(h={});var d=h.insertAt;if(A&&typeof document<"u"){var f=document.head||document.getElementsByTagName("head")[0],v=document.createElement("style");v.type="text/css",d==="top"&&f.firstChild?f.insertBefore(v,f.firstChild):f.appendChild(v),v.styleSheet?v.styleSheet.cssText=A:v.appendChild(document.createTextNode(A))}})(`.stf__parent {
  position: relative;
  display: block;
  box-sizing: border-box;
  transform: translateZ(0);

  -ms-touch-action: pan-y;
  touch-action: pan-y;
}

.sft__wrapper {
  position: relative;
  width: 100%;
  box-sizing: border-box;
}

.stf__parent canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
}

.stf__block {
  position: absolute;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  perspective: 2000px;
}

.stf__item {
  display: none;
  position: absolute;
  transform-style: preserve-3d;
}

.stf__outerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__innerShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardShadow {
  position: absolute;
  left: 0;
  top: 0;
}

.stf__hardInnerShadow {
  position: absolute;
  left: 0;
  top: 0;
}`),e.PageFlip=class extends class{constructor(){this.events=new Map}on(A,h){return this.events.has(A)?this.events.get(A).push(h):this.events.set(A,[h]),this}off(A){this.events.delete(A)}trigger(A,h,d=null){if(this.events.has(A))for(const f of this.events.get(A))f({data:d,object:h})}}{constructor(A,h){super(),this.isUserTouch=!1,this.isUserMove=!1,this.setting=null,this.pages=null,this.setting=new P().getSettings(h),this.block=A}destroy(){this.ui.destroy(),this.block.remove()}update(){this.render.update(),this.pages.show()}loadFromImages(A){this.ui=new g(this.block,this,this.setting);const h=this.ui.getCanvas();this.render=new y(this,this.setting,h),this.flipController=new m(this.render,this),this.pages=new a(this,this.render,A),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}loadFromHTML(A){this.ui=new u(this.block,this,this.setting,A),this.render=new x(this,this.setting,this.ui.getDistElement()),this.flipController=new m(this.render,this),this.pages=new c(this,this.render,this.ui.getDistElement(),A),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}updateFromImages(A){const h=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new a(this,this.render,A),this.pages.load(),this.pages.show(h),this.trigger("update",this,{page:h,mode:this.render.getOrientation()})}updateFromHtml(A){const h=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new c(this,this.render,this.ui.getDistElement(),A),this.pages.load(),this.ui.updateItems(A),this.render.reload(),this.pages.show(h),this.trigger("update",this,{page:h,mode:this.render.getOrientation()})}clear(){this.pages.destroy(),this.ui.clear()}turnToPrevPage(){this.pages.showPrev()}turnToNextPage(){this.pages.showNext()}turnToPage(A){this.pages.show(A)}flipNext(A="top"){this.flipController.flipNext(A)}flipPrev(A="top"){this.flipController.flipPrev(A)}flip(A,h="top"){this.flipController.flipToPage(A,h)}updateState(A){this.trigger("changeState",this,A)}updatePageIndex(A){this.trigger("flip",this,A)}updateOrientation(A){this.ui.setOrientationStyle(A),this.update(),this.trigger("changeOrientation",this,A)}getPageCount(){return this.pages.getPageCount()}getCurrentPageIndex(){return this.pages.getCurrentPageIndex()}getPage(A){return this.pages.getPage(A)}getRender(){return this.render}getFlipController(){return this.flipController}getOrientation(){return this.render.getOrientation()}getBoundsRect(){return this.render.getRect()}getSettings(){return this.setting}getUI(){return this.ui}getState(){return this.flipController.getState()}getPageCollection(){return this.pages}startUserTouch(A){this.mousePosition=A,this.isUserTouch=!0,this.isUserMove=!1}userMove(A,h){this.isUserTouch||h||!this.setting.showPageCorners?this.isUserTouch&&o.GetDistanceBetweenTwoPoint(this.mousePosition,A)>5&&(this.isUserMove=!0,this.flipController.fold(A)):this.flipController.showCorner(A)}userStop(A,h=!1){this.isUserTouch&&(this.isUserTouch=!1,h||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(A)))}},Object.defineProperty(e,"__esModule",{value:!0})})})(pageFlip_browser,pageFlip_browser.exports);var pageFlip_browserExports=pageFlip_browser.exports;defineStore("averageSpecie",()=>{const i=ref(""),t=ref([]),e=ref([]),s=ref(0),n=async()=>{try{t.value=[],e.value=[];const{data:o}=await APIService.getAverageCandidateTrees();r(o,i.value)}catch(o){console.error("Error fetching data:",o)}},r=(o,l)=>{const c=o.filter(_=>_.codigo===l),{alturaPromedioTotal:p,alturaPromedioComercial:m}=a(c);t.value=["Altura Promedio","Altura Fuste"],e.value=[p,m]},a=o=>{const l=o.reduce((_,y)=>_+y.altura_total,0),c=Math.round(l/o.length),p=o.reduce((_,y)=>_+y.altura_comercial,0),m=Math.round(p/o.length);return s.value=o.length,{alturaPromedioTotal:c,alturaPromedioComercial:m}};return{cod_especie:i,etiquetas:t,valores:e,cantIndividuos:s,fetchData:n}});const QuoteButton_vue_vue_type_style_index_0_scoped_29afe16d_lang="",_withScopeId$2=i=>(pushScopeId("data-v-29afe16d"),i=i(),popScopeId(),i),_hoisted_1$4={class:"citar"},_hoisted_2$4={key:0,id:"modal",class:"modal"},_hoisted_3$4={class:"modal__contenido"},_hoisted_4$4=_withScopeId$2(()=>createBaseVNode("p",{class:"modal__titulo"},"Cítese como",-1)),_hoisted_5$2=_withScopeId$2(()=>createBaseVNode("p",{class:"modal__texto"}," Bernal, R., S.R. Gradstein & M. Celis (eds.). 2019. Sistema de información de Arboles y plantas del Sur de la Amazonia colombiana, Corpoamazonia, Bogotá. https://sara.amazoniaesenciadevida.com.co ",-1)),_sfc_main$4={__name:"QuoteButton",setup(i){const t=ref(!1),e=()=>{const s=document.querySelector(".modal__texto").textContent;s?navigator.clipboard.writeText(s).then(()=>{console.log("Texto copiado al portapapeles")}).catch(n=>{console.error("Error al copiar el texto:",n)}):console.error("Elemento con la clase modal__texto no encontrado")};return(s,n)=>{const r=resolveComponent("font-awesome-icon");return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$4,[createBaseVNode("button",{class:"citar__boton",onClick:n[0]||(n[0]=a=>t.value=!t.value)},[createVNode(r,{icon:"quote-left",class:"mr-2"}),createTextVNode(" Cómo Citar ")])]),t.value?(openBlock(),createElementBlock("div",_hoisted_2$4,[createBaseVNode("div",_hoisted_3$4,[createBaseVNode("span",{onClick:n[1]||(n[1]=a=>t.value=!t.value),class:"modal__close"},[createVNode(r,{icon:["fas","circle-xmark"]})]),_hoisted_4$4,_hoisted_5$2,createBaseVNode("button",{onClick:n[2]||(n[2]=()=>{e(),t.value=!t.value}),class:"modal__boton"},[createVNode(r,{icon:"copy",class:"mr-2"}),createTextVNode(" Copiar ")])])])):createCommentVNode("",!0)],64)}}},QuoteButton=_export_sfc(_sfc_main$4,[["__scopeId","data-v-29afe16d"]]),PagesQueries_vue_vue_type_style_index_0_scoped_49eb371a_lang="",_hoisted_1$3={class:"related__page"},_hoisted_2$3={style:{"border-bottom":"3px solid var(--primary)"}},_hoisted_3$3={class:"related__page-content"},_hoisted_4$3=["href"],_hoisted_5$1=["src","title"],_sfc_main$3={__name:"PagesQueries",props:{scientificName:{type:String,required:!0},vernacularName:{type:String,required:!0}},setup(i){const t=i,e=[{url:`https://tropicos.org/name/Search?name=${t.scientificName}`,img:"/logos/tropicos.png",title:"Trópicos"},{url:`https://powo.science.kew.org/results?q=${t.scientificName}`,img:"/logos/powo.png",title:"Plants of the World Online"},{url:"https://www.sinchi.org.co",img:"/logos/sinchi.png",title:"SINCHI"},{url:`https://www.gbif.org/es/search?q=${t.scientificName}`,img:"/logos/gbif.png",title:"GBIF"},{url:`https://catalogo.biodiversidad.co/search/basic?q=${t.scientificName}`,img:"/logos/SIB.png",title:"SIB Colombia"},{url:`http://www.biovirtual.unal.edu.co/es/colecciones/result/species/${t.scientificName}/plants/`,img:"/logos/unal.png",title:"Universidad Nacional de Colombia"}];return(s,n)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("h2",null,[createTextVNode("Consultar la especie "),createBaseVNode("span",_hoisted_2$3,toDisplayString(t.vernacularName),1),createTextVNode(" en:")]),createBaseVNode("div",_hoisted_3$3,[(openBlock(),createElementBlock(Fragment,null,renderList(e,(r,a)=>createBaseVNode("div",{key:a,class:"related__page-link"},[createBaseVNode("a",{href:r.url,target:"_blank"},[createBaseVNode("img",{src:r.img,title:r.title},null,8,_hoisted_5$1)],8,_hoisted_4$3)])),64))])]))}},PagesQueries=_export_sfc(_sfc_main$3,[["__scopeId","data-v-49eb371a"]]),RenderGeo_vue_vue_type_style_index_0_scoped_f94fd5da_lang="",_withScopeId$1=i=>(pushScopeId("data-v-f94fd5da"),i=i(),popScopeId(),i),_hoisted_1$2={class:"map-container"},_hoisted_2$2={class:"legend"},_hoisted_3$2=_withScopeId$1(()=>createBaseVNode("h4",null,"Leyenda",-1)),_hoisted_4$2={class:"legend-item"},_hoisted_5=["src"],_hoisted_6=_withScopeId$1(()=>createBaseVNode("span",null,"Árbol - Corpoamazonia",-1)),_hoisted_7={class:"legend-item"},_hoisted_8=["src"],_hoisted_9=_withScopeId$1(()=>createBaseVNode("span",null,"Palma - Corpoamazonia",-1)),_hoisted_10={class:"legend-item"},_hoisted_11=["src"],_hoisted_12=_withScopeId$1(()=>createBaseVNode("span",null,"Árbol - GBIF (Global Biodiversity Information Facility)",-1)),_hoisted_13={class:"legend-item"},_hoisted_14=["src"],_hoisted_15=_withScopeId$1(()=>createBaseVNode("span",null,"Palma - GBIF (Global Biodiversity Information Facility)",-1)),_sfc_main$2={__name:"RenderGeo",props:["filteredData"],setup(i){const{filteredData:t}=i,e=ref(null),s=shallowRef(null),n=new VectorSource({url:"/geojson/export.geojson",format:new GeoJSON}),r=new VectorLayer({source:n,style:new Style({stroke:new Stroke({color:"green",width:2}),fill:new Fill({color:"rgba(0, 0, 255, 0.1)"})})}),a=new VectorSource,o=new Style({image:new Icon({src:treeIconPath,scale:.06,anchor:[.5,1]})}),l=new Style({image:new Icon({src:treePalmIconGreenPath,scale:.06,anchor:[.5,1]})}),c=new Style({image:new Icon({src:treeIconGBIFPath,scale:.06,anchor:[.5,1]})}),p=new Style({image:new Icon({src:treePalmIconPinkPath,scale:.06,anchor:[.5,1]})}),m=new VectorLayer({source:a,style:function(b){const u=b.get("source"),g=b.get("habito");if(u==="original"){if(g==="Árbol")return o;if(g==="Palma")return l}else if(u==="gbif"){if(g==="Árbol")return c;if(g==="Palma")return p}return o}});function _(b){s.value=new Map$1({target:e.value,layers:[new TileLayer({source:new OSM}),r,m],view:new View({center:fromLonLat(b),zoom:5,minZoom:6.5,maxZoom:14})}),s.value.getViewport().style.cursor="pointer"}function y(){a.clear();const b=t.map(u=>{const g=new Point(fromLonLat([u.lon,u.lat])),x=new Feature(g);return x.setProperties({source:u.source,habito:u.habito}),x});a.addFeatures(b)}return onMounted(()=>{if(t.length>0){const b=[t[0].lon,t[0].lat];_(b),y()}}),watch(()=>t,b=>{if(b.length>0&&s.value){y();const u=a.getExtent();s.value.getView().fit(u,{padding:[50,50,50,50],maxZoom:14})}},{deep:!0}),(b,u)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",{ref_key:"mapContainer",ref:e},null,512),createBaseVNode("div",_hoisted_2$2,[_hoisted_3$2,createBaseVNode("div",_hoisted_4$2,[createBaseVNode("img",{src:unref(treeIconPath),alt:"Árbol Corpoamazonia",class:"legend-icon"},null,8,_hoisted_5),_hoisted_6]),createBaseVNode("div",_hoisted_7,[createBaseVNode("img",{src:unref(treePalmIconGreenPath),alt:"Palma Corpoamazonia",class:"legend-icon"},null,8,_hoisted_8),_hoisted_9]),createBaseVNode("div",_hoisted_10,[createBaseVNode("img",{src:unref(treeIconGBIFPath),alt:"Árbol GBIF",class:"legend-icon"},null,8,_hoisted_11),_hoisted_12]),createBaseVNode("div",_hoisted_13,[createBaseVNode("img",{src:unref(treePalmIconPinkPath),alt:"Palma GBIF",class:"legend-icon"},null,8,_hoisted_14),_hoisted_15])])]))}},RenderGeo=_export_sfc(_sfc_main$2,[["__scopeId","data-v-f94fd5da"]]),ImageSlider_vue_vue_type_style_index_0_scoped_23772b4f_lang="",_hoisted_1$1={class:"slider__specie"},_hoisted_2$1={class:"slider__specie-content"},_hoisted_3$1={class:"thumbnail__images"},_hoisted_4$1=["src","alt","onClick"],_sfc_main$1={__name:"ImageSlider",setup(i){const t=useGeoCandidateTrees(),e=ref(0),s=n=>{e.value=n};return(n,r)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",{class:"imagen",style:normalizeStyle({transform:`translateX(-${e.value*100}%)`})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(t).validImages,(a,o)=>(openBlock(),createElementBlock("div",{key:o},[createBaseVNode("div",{class:"image__active",style:normalizeStyle({backgroundImage:"url("+a+")"})},null,4)]))),128))],4)]),createBaseVNode("div",_hoisted_3$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(t).validImages,(a,o)=>(openBlock(),createElementBlock("img",{key:"thumb-"+o,src:a,alt:"Miniatura "+o,class:normalizeClass(["image",{active:e.value===o}]),onClick:l=>s(o)},null,10,_hoisted_4$1))),128))])]))}},ImageSlider=_export_sfc(_sfc_main$1,[["__scopeId","data-v-23772b4f"]]);/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function round(i){return i+.5|0}const lim=(i,t,e)=>Math.max(Math.min(i,e),t);function p2b(i){return lim(round(i*2.55),0,255)}function n2b(i){return lim(round(i*255),0,255)}function b2n(i){return lim(round(i/2.55)/100,0,1)}function n2p(i){return lim(round(i*100),0,100)}const map$1={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex=[..."0123456789ABCDEF"],h1=i=>hex[i&15],h2=i=>hex[(i&240)>>4]+hex[i&15],eq=i=>(i&240)>>4===(i&15),isShort=i=>eq(i.r)&&eq(i.g)&&eq(i.b)&&eq(i.a);function hexParse(i){var t=i.length,e;return i[0]==="#"&&(t===4||t===5?e={r:255&map$1[i[1]]*17,g:255&map$1[i[2]]*17,b:255&map$1[i[3]]*17,a:t===5?map$1[i[4]]*17:255}:(t===7||t===9)&&(e={r:map$1[i[1]]<<4|map$1[i[2]],g:map$1[i[3]]<<4|map$1[i[4]],b:map$1[i[5]]<<4|map$1[i[6]],a:t===9?map$1[i[7]]<<4|map$1[i[8]]:255})),e}const alpha=(i,t)=>i<255?t(i):"";function hexString(i){var t=isShort(i)?h1:h2;return i?"#"+t(i.r)+t(i.g)+t(i.b)+alpha(i.a,t):void 0}const HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(i,t,e){const s=t*Math.min(e,1-e),n=(r,a=(r+i/30)%12)=>e-s*Math.max(Math.min(a-3,9-a,1),-1);return[n(0),n(8),n(4)]}function hsv2rgbn(i,t,e){const s=(n,r=(n+i/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[s(5),s(3),s(1)]}function hwb2rgbn(i,t,e){const s=hsl2rgbn(i,1,.5);let n;for(t+e>1&&(n=1/(t+e),t*=n,e*=n),n=0;n<3;n++)s[n]*=1-t-e,s[n]+=t;return s}function hueValue(i,t,e,s,n){return i===n?(t-e)/s+(t<e?6:0):t===n?(e-i)/s+2:(i-t)/s+4}function rgb2hsl(i){const e=i.r/255,s=i.g/255,n=i.b/255,r=Math.max(e,s,n),a=Math.min(e,s,n),o=(r+a)/2;let l,c,p;return r!==a&&(p=r-a,c=o>.5?p/(2-r-a):p/(r+a),l=hueValue(e,s,n,p,r),l=l*60+.5),[l|0,c||0,o]}function calln(i,t,e,s){return(Array.isArray(t)?i(t[0],t[1],t[2]):i(t,e,s)).map(n2b)}function hsl2rgb(i,t,e){return calln(hsl2rgbn,i,t,e)}function hwb2rgb(i,t,e){return calln(hwb2rgbn,i,t,e)}function hsv2rgb(i,t,e){return calln(hsv2rgbn,i,t,e)}function hue(i){return(i%360+360)%360}function hueParse(i){const t=HUE_RE.exec(i);let e=255,s;if(!t)return;t[5]!==s&&(e=t[6]?p2b(+t[5]):n2b(+t[5]));const n=hue(+t[2]),r=+t[3]/100,a=+t[4]/100;return t[1]==="hwb"?s=hwb2rgb(n,r,a):t[1]==="hsv"?s=hsv2rgb(n,r,a):s=hsl2rgb(n,r,a),{r:s[0],g:s[1],b:s[2],a:e}}function rotate(i,t){var e=rgb2hsl(i);e[0]=hue(e[0]+t),e=hsl2rgb(e),i.r=e[0],i.g=e[1],i.b=e[2]}function hslString(i){if(!i)return;const t=rgb2hsl(i),e=t[0],s=n2p(t[1]),n=n2p(t[2]);return i.a<255?`hsla(${e}, ${s}%, ${n}%, ${b2n(i.a)})`:`hsl(${e}, ${s}%, ${n}%)`}const map$2={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names$1={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const i={},t=Object.keys(names$1),e=Object.keys(map$2);let s,n,r,a,o;for(s=0;s<t.length;s++){for(a=o=t[s],n=0;n<e.length;n++)r=e[n],o=o.replace(r,map$2[r]);r=parseInt(names$1[a],16),i[o]=[r>>16&255,r>>8&255,r&255]}return i}let names;function nameParse(i){names||(names=unpack(),names.transparent=[0,0,0,0]);const t=names[i.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(i){const t=RGB_RE.exec(i);let e=255,s,n,r;if(t){if(t[7]!==s){const a=+t[7];e=t[8]?p2b(a):lim(a*255,0,255)}return s=+t[1],n=+t[3],r=+t[5],s=255&(t[2]?p2b(s):lim(s,0,255)),n=255&(t[4]?p2b(n):lim(n,0,255)),r=255&(t[6]?p2b(r):lim(r,0,255)),{r:s,g:n,b:r,a:e}}}function rgbString(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${b2n(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}const to=i=>i<=.0031308?i*12.92:Math.pow(i,1/2.4)*1.055-.055,from=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function interpolate$1(i,t,e){const s=from(b2n(i.r)),n=from(b2n(i.g)),r=from(b2n(i.b));return{r:n2b(to(s+e*(from(b2n(t.r))-s))),g:n2b(to(n+e*(from(b2n(t.g))-n))),b:n2b(to(r+e*(from(b2n(t.b))-r))),a:i.a+e*(t.a-i.a)}}function modHSL(i,t,e){if(i){let s=rgb2hsl(i);s[t]=Math.max(0,Math.min(s[t]+s[t]*e,t===0?360:1)),s=hsl2rgb(s),i.r=s[0],i.g=s[1],i.b=s[2]}}function clone$1(i,t){return i&&Object.assign(t||{},i)}function fromObject(i){var t={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(t={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(t.a=n2b(i[3]))):(t=clone$1(i,{r:0,g:0,b:0,a:1}),t.a=n2b(t.a)),t}function functionParse(i){return i.charAt(0)==="r"?rgbParse(i):hueParse(i)}class Color{constructor(t){if(t instanceof Color)return t;const e=typeof t;let s;e==="object"?s=fromObject(t):e==="string"&&(s=hexParse(t)||nameParse(t)||functionParse(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=clone$1(this._rgb);return t&&(t.a=b2n(t.a)),t}set rgb(t){this._rgb=fromObject(t)}rgbString(){return this._valid?rgbString(this._rgb):void 0}hexString(){return this._valid?hexString(this._rgb):void 0}hslString(){return this._valid?hslString(this._rgb):void 0}mix(t,e){if(t){const s=this.rgb,n=t.rgb;let r;const a=e===r?.5:e,o=2*a-1,l=s.a-n.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;r=1-c,s.r=255&c*s.r+r*n.r+.5,s.g=255&c*s.g+r*n.g+.5,s.b=255&c*s.b+r*n.b+.5,s.a=a*s.a+(1-a)*n.a,this.rgb=s}return this}interpolate(t,e){return t&&(this._rgb=interpolate$1(this._rgb,t._rgb,e)),this}clone(){return new Color(this.rgb)}alpha(t){return this._rgb.a=n2b(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=round(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return modHSL(this._rgb,2,t),this}darken(t){return modHSL(this._rgb,2,-t),this}saturate(t){return modHSL(this._rgb,1,t),this}desaturate(t){return modHSL(this._rgb,1,-t),this}rotate(t){return rotate(this._rgb,t),this}}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function noop(){}const uid=(()=>{let i=0;return()=>i++})();function isNullOrUndef(i){return i===null||typeof i>"u"}function isArray(i){if(Array.isArray&&Array.isArray(i))return!0;const t=Object.prototype.toString.call(i);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function isObject(i){return i!==null&&Object.prototype.toString.call(i)==="[object Object]"}function isNumberFinite(i){return(typeof i=="number"||i instanceof Number)&&isFinite(+i)}function finiteOrDefault(i,t){return isNumberFinite(i)?i:t}function valueOrDefault(i,t){return typeof i>"u"?t:i}const toPercentage=(i,t)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100:+i/t,toDimension=(i,t)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100*t:+i;function callback(i,t,e){if(i&&typeof i.call=="function")return i.apply(e,t)}function each(i,t,e,s){let n,r,a;if(isArray(i))if(r=i.length,s)for(n=r-1;n>=0;n--)t.call(e,i[n],n);else for(n=0;n<r;n++)t.call(e,i[n],n);else if(isObject(i))for(a=Object.keys(i),r=a.length,n=0;n<r;n++)t.call(e,i[a[n]],a[n])}function _elementsEqual(i,t){let e,s,n,r;if(!i||!t||i.length!==t.length)return!1;for(e=0,s=i.length;e<s;++e)if(n=i[e],r=t[e],n.datasetIndex!==r.datasetIndex||n.index!==r.index)return!1;return!0}function clone(i){if(isArray(i))return i.map(clone);if(isObject(i)){const t=Object.create(null),e=Object.keys(i),s=e.length;let n=0;for(;n<s;++n)t[e[n]]=clone(i[e[n]]);return t}return i}function isValidKey(i){return["__proto__","prototype","constructor"].indexOf(i)===-1}function _merger(i,t,e,s){if(!isValidKey(i))return;const n=t[i],r=e[i];isObject(n)&&isObject(r)?merge(n,r,s):t[i]=clone(r)}function merge(i,t,e){const s=isArray(t)?t:[t],n=s.length;if(!isObject(i))return i;e=e||{};const r=e.merger||_merger;let a;for(let o=0;o<n;++o){if(a=s[o],!isObject(a))continue;const l=Object.keys(a);for(let c=0,p=l.length;c<p;++c)r(l[c],i,a,e)}return i}function mergeIf(i,t){return merge(i,t,{merger:_mergerIf})}function _mergerIf(i,t,e){if(!isValidKey(i))return;const s=t[i],n=e[i];isObject(s)&&isObject(n)?mergeIf(s,n):Object.prototype.hasOwnProperty.call(t,i)||(t[i]=clone(n))}const keyResolvers={"":i=>i,x:i=>i.x,y:i=>i.y};function _splitKey(i){const t=i.split("."),e=[];let s="";for(const n of t)s+=n,s.endsWith("\\")?s=s.slice(0,-1)+".":(e.push(s),s="");return e}function _getKeyResolver(i){const t=_splitKey(i);return e=>{for(const s of t){if(s==="")break;e=e&&e[s]}return e}}function resolveObjectKey(i,t){return(keyResolvers[t]||(keyResolvers[t]=_getKeyResolver(t)))(i)}function _capitalize(i){return i.charAt(0).toUpperCase()+i.slice(1)}const defined=i=>typeof i<"u",isFunction=i=>typeof i=="function",setsEqual=(i,t)=>{if(i.size!==t.size)return!1;for(const e of i)if(!t.has(e))return!1;return!0};function _isClickEvent(i){return i.type==="mouseup"||i.type==="click"||i.type==="contextmenu"}const PI=Math.PI,TAU=2*PI,PITAU=TAU+PI,INFINITY=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function almostEquals(i,t,e){return Math.abs(i-t)<e}function niceNum(i){const t=Math.round(i);i=almostEquals(i,t,i/1e3)?t:i;const e=Math.pow(10,Math.floor(log10(i))),s=i/e;return(s<=1?1:s<=2?2:s<=5?5:10)*e}function _factorize(i){const t=[],e=Math.sqrt(i);let s;for(s=1;s<e;s++)i%s===0&&(t.push(s),t.push(i/s));return e===(e|0)&&t.push(e),t.sort((n,r)=>n-r).pop(),t}function isNumber(i){return!isNaN(parseFloat(i))&&isFinite(i)}function almostWhole(i,t){const e=Math.round(i);return e-t<=i&&e+t>=i}function _setMinAndMaxByKey(i,t,e){let s,n,r;for(s=0,n=i.length;s<n;s++)r=i[s][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function toRadians(i){return i*(PI/180)}function toDegrees(i){return i*(180/PI)}function _decimalPlaces(i){if(!isNumberFinite(i))return;let t=1,e=0;for(;Math.round(i*t)/t!==i;)t*=10,e++;return e}function getAngleFromPoint(i,t){const e=t.x-i.x,s=t.y-i.y,n=Math.sqrt(e*e+s*s);let r=Math.atan2(s,e);return r<-.5*PI&&(r+=TAU),{angle:r,distance:n}}function distanceBetweenPoints(i,t){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}function _angleDiff(i,t){return(i-t+PITAU)%TAU-PI}function _normalizeAngle(i){return(i%TAU+TAU)%TAU}function _angleBetween(i,t,e,s){const n=_normalizeAngle(i),r=_normalizeAngle(t),a=_normalizeAngle(e),o=_normalizeAngle(r-n),l=_normalizeAngle(a-n),c=_normalizeAngle(n-r),p=_normalizeAngle(n-a);return n===r||n===a||s&&r===a||o>l&&c<p}function _limitValue(i,t,e){return Math.max(t,Math.min(e,i))}function _int16Range(i){return _limitValue(i,-32768,32767)}function _isBetween(i,t,e,s=1e-6){return i>=Math.min(t,e)-s&&i<=Math.max(t,e)+s}function _lookup(i,t,e){e=e||(a=>i[a]<t);let s=i.length-1,n=0,r;for(;s-n>1;)r=n+s>>1,e(r)?n=r:s=r;return{lo:n,hi:s}}const _lookupByKey=(i,t,e,s)=>_lookup(i,e,s?n=>{const r=i[n][t];return r<e||r===e&&i[n+1][t]===e}:n=>i[n][t]<e),_rlookupByKey=(i,t,e)=>_lookup(i,e,s=>i[s][t]>=e);function _filterBetween(i,t,e){let s=0,n=i.length;for(;s<n&&i[s]<t;)s++;for(;n>s&&i[n-1]>e;)n--;return s>0||n<i.length?i.slice(s,n):i}const arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(i,t){if(i._chartjs){i._chartjs.listeners.push(t);return}Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),arrayEvents.forEach(e=>{const s="_onData"+_capitalize(e),n=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value(...r){const a=n.apply(this,r);return i._chartjs.listeners.forEach(o=>{typeof o[s]=="function"&&o[s](...r)}),a}})})}function unlistenArrayEvents(i,t){const e=i._chartjs;if(!e)return;const s=e.listeners,n=s.indexOf(t);n!==-1&&s.splice(n,1),!(s.length>0)&&(arrayEvents.forEach(r=>{delete i[r]}),delete i._chartjs)}function _arrayUnique(i){const t=new Set(i);return t.size===i.length?i:Array.from(t)}const requestAnimFrame=function(){return typeof window>"u"?function(i){return i()}:window.requestAnimationFrame}();function throttled(i,t){let e=[],s=!1;return function(...n){e=n,s||(s=!0,requestAnimFrame.call(window,()=>{s=!1,i.apply(t,e)}))}}function debounce(i,t){let e;return function(...s){return t?(clearTimeout(e),e=setTimeout(i,t,s)):i.apply(this,s),t}}const _toLeftRightCenter=i=>i==="start"?"left":i==="end"?"right":"center",_alignStartEnd=(i,t,e)=>i==="start"?t:i==="end"?e:(t+e)/2,_textX=(i,t,e,s)=>i===(s?"left":"right")?e:i==="center"?(t+e)/2:t;function _getStartAndCountOfVisiblePoints(i,t,e){const s=t.length;let n=0,r=s;if(i._sorted){const{iScale:a,_parsed:o}=i,l=a.axis,{min:c,max:p,minDefined:m,maxDefined:_}=a.getUserBounds();m&&(n=_limitValue(Math.min(_lookupByKey(o,l,c).lo,e?s:_lookupByKey(t,l,a.getPixelForValue(c)).lo),0,s-1)),_?r=_limitValue(Math.max(_lookupByKey(o,a.axis,p,!0).hi+1,e?0:_lookupByKey(t,l,a.getPixelForValue(p),!0).hi+1),n,s)-n:r=s-n}return{start:n,count:r}}function _scaleRangesChanged(i){const{xScale:t,yScale:e,_scaleRanges:s}=i,n={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!s)return i._scaleRanges=n,!0;const r=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==e.min||s.ymax!==e.max;return Object.assign(s,n),r}const atEdge=i=>i===0||i===1,elasticIn=(i,t,e)=>-(Math.pow(2,10*(i-=1))*Math.sin((i-t)*TAU/e)),elasticOut=(i,t,e)=>Math.pow(2,-10*i)*Math.sin((i-t)*TAU/e)+1,effects={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>-Math.cos(i*HALF_PI)+1,easeOutSine:i=>Math.sin(i*HALF_PI),easeInOutSine:i=>-.5*(Math.cos(PI*i)-1),easeInExpo:i=>i===0?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>i===1?1:-Math.pow(2,-10*i)+1,easeInOutExpo:i=>atEdge(i)?i:i<.5?.5*Math.pow(2,10*(i*2-1)):.5*(-Math.pow(2,-10*(i*2-1))+2),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>atEdge(i)?i:elasticIn(i,.075,.3),easeOutElastic:i=>atEdge(i)?i:elasticOut(i,.075,.3),easeInOutElastic(i){return atEdge(i)?i:i<.5?.5*elasticIn(i*2,.1125,.45):.5+.5*elasticOut(i*2-1,.1125,.45)},easeInBack(i){return i*i*((1.70158+1)*i-1.70158)},easeOutBack(i){return(i-=1)*i*((1.70158+1)*i+1.70158)+1},easeInOutBack(i){let t=1.70158;return(i/=.5)<1?.5*(i*i*(((t*=1.525)+1)*i-t)):.5*((i-=2)*i*(((t*=1.525)+1)*i+t)+2)},easeInBounce:i=>1-effects.easeOutBounce(1-i),easeOutBounce(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},easeInOutBounce:i=>i<.5?effects.easeInBounce(i*2)*.5:effects.easeOutBounce(i*2-1)*.5+.5};function isPatternOrGradient(i){if(i&&typeof i=="object"){const t=i.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function color(i){return isPatternOrGradient(i)?i:new Color(i)}function getHoverColor(i){return isPatternOrGradient(i)?i:new Color(i).saturate(.5).darken(.1).hexString()}const numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];function applyAnimationsDefaults(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),i.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function applyLayoutsDefaults(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const intlCache=new Map;function getNumberFormat(i,t){t=t||{};const e=i+JSON.stringify(t);let s=intlCache.get(e);return s||(s=new Intl.NumberFormat(i,t),intlCache.set(e,s)),s}function formatNumber(i,t,e){return getNumberFormat(t,e).format(i)}const formatters={values(i){return isArray(i)?i:""+i},numeric(i,t,e){if(i===0)return"0";const s=this.chart.options.locale;let n,r=i;if(e.length>1){const c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(n="scientific"),r=calculateDelta(i,e)}const a=log10(Math.abs(r)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:n,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),formatNumber(i,s,l)},logarithmic(i,t,e){if(i===0)return"0";const s=e[t].significand||i/Math.pow(10,Math.floor(log10(i)));return[1,2,3,5,10,15].includes(s)||t>.8*e.length?formatters.numeric.call(this,i,t,e):""}};function calculateDelta(i,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&i!==Math.floor(i)&&(e=i-Math.floor(i)),e}var Ticks={formatters};function applyScaleDefaults(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(i,t){if(!t)return i;const e=t.split(".");for(let s=0,n=e.length;s<n;++s){const r=e[s];i=i[r]||(i[r]=Object.create(null))}return i}function set(i,t,e){return typeof t=="string"?merge(getScope$1(i,t),e):merge(getScope$1(i,""),t)}class Defaults{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,n)=>getHoverColor(n.backgroundColor),this.hoverBorderColor=(s,n)=>getHoverColor(n.borderColor),this.hoverColor=(s,n)=>getHoverColor(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return set(this,t,e)}get(t){return getScope$1(this,t)}describe(t,e){return set(descriptors,t,e)}override(t,e){return set(overrides,t,e)}route(t,e,s,n){const r=getScope$1(this,t),a=getScope$1(this,s),o="_"+e;Object.defineProperties(r,{[o]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const l=this[o],c=a[n];return isObject(l)?Object.assign({},c,l):valueOrDefault(l,c)},set(l){this[o]=l}}})}apply(t){t.forEach(e=>e(this))}}var defaults=new Defaults({_scriptable:i=>!i.startsWith("on"),_indexable:i=>i!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[applyAnimationsDefaults,applyLayoutsDefaults,applyScaleDefaults]);function toFontString(i){return!i||isNullOrUndef(i.size)||isNullOrUndef(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}function _measureText(i,t,e,s,n){let r=t[n];return r||(r=t[n]=i.measureText(n).width,e.push(n)),r>s&&(s=r),s}function _longestText(i,t,e,s){s=s||{};let n=s.data=s.data||{},r=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(n=s.data={},r=s.garbageCollect=[],s.font=t),i.save(),i.font=t;let a=0;const o=e.length;let l,c,p,m,_;for(l=0;l<o;l++)if(m=e[l],m!=null&&!isArray(m))a=_measureText(i,n,r,a,m);else if(isArray(m))for(c=0,p=m.length;c<p;c++)_=m[c],_!=null&&!isArray(_)&&(a=_measureText(i,n,r,a,_));i.restore();const y=r.length/2;if(y>e.length){for(l=0;l<y;l++)delete n[r[l]];r.splice(0,y)}return a}function _alignPixel(i,t,e){const s=i.currentDevicePixelRatio,n=e!==0?Math.max(e/2,.5):0;return Math.round((t-n)*s)/s+n}function clearCanvas(i,t){t=t||i.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,i.width,i.height),t.restore()}function drawPoint(i,t,e,s){drawPointLegend(i,t,e,s,null)}function drawPointLegend(i,t,e,s,n){let r,a,o,l,c,p,m,_;const y=t.pointStyle,b=t.rotation,u=t.radius;let g=(b||0)*RAD_PER_DEG;if(y&&typeof y=="object"&&(r=y.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){i.save(),i.translate(e,s),i.rotate(g),i.drawImage(y,-y.width/2,-y.height/2,y.width,y.height),i.restore();return}if(!(isNaN(u)||u<=0)){switch(i.beginPath(),y){default:n?i.ellipse(e,s,n/2,u,0,0,TAU):i.arc(e,s,u,0,TAU),i.closePath();break;case"triangle":p=n?n/2:u,i.moveTo(e+Math.sin(g)*p,s-Math.cos(g)*u),g+=TWO_THIRDS_PI,i.lineTo(e+Math.sin(g)*p,s-Math.cos(g)*u),g+=TWO_THIRDS_PI,i.lineTo(e+Math.sin(g)*p,s-Math.cos(g)*u),i.closePath();break;case"rectRounded":c=u*.516,l=u-c,a=Math.cos(g+QUARTER_PI)*l,m=Math.cos(g+QUARTER_PI)*(n?n/2-c:l),o=Math.sin(g+QUARTER_PI)*l,_=Math.sin(g+QUARTER_PI)*(n?n/2-c:l),i.arc(e-m,s-o,c,g-PI,g-HALF_PI),i.arc(e+_,s-a,c,g-HALF_PI,g),i.arc(e+m,s+o,c,g,g+HALF_PI),i.arc(e-_,s+a,c,g+HALF_PI,g+PI),i.closePath();break;case"rect":if(!b){l=Math.SQRT1_2*u,p=n?n/2:l,i.rect(e-p,s-l,2*p,2*l);break}g+=QUARTER_PI;case"rectRot":m=Math.cos(g)*(n?n/2:u),a=Math.cos(g)*u,o=Math.sin(g)*u,_=Math.sin(g)*(n?n/2:u),i.moveTo(e-m,s-o),i.lineTo(e+_,s-a),i.lineTo(e+m,s+o),i.lineTo(e-_,s+a),i.closePath();break;case"crossRot":g+=QUARTER_PI;case"cross":m=Math.cos(g)*(n?n/2:u),a=Math.cos(g)*u,o=Math.sin(g)*u,_=Math.sin(g)*(n?n/2:u),i.moveTo(e-m,s-o),i.lineTo(e+m,s+o),i.moveTo(e+_,s-a),i.lineTo(e-_,s+a);break;case"star":m=Math.cos(g)*(n?n/2:u),a=Math.cos(g)*u,o=Math.sin(g)*u,_=Math.sin(g)*(n?n/2:u),i.moveTo(e-m,s-o),i.lineTo(e+m,s+o),i.moveTo(e+_,s-a),i.lineTo(e-_,s+a),g+=QUARTER_PI,m=Math.cos(g)*(n?n/2:u),a=Math.cos(g)*u,o=Math.sin(g)*u,_=Math.sin(g)*(n?n/2:u),i.moveTo(e-m,s-o),i.lineTo(e+m,s+o),i.moveTo(e+_,s-a),i.lineTo(e-_,s+a);break;case"line":a=n?n/2:Math.cos(g)*u,o=Math.sin(g)*u,i.moveTo(e-a,s-o),i.lineTo(e+a,s+o);break;case"dash":i.moveTo(e,s),i.lineTo(e+Math.cos(g)*(n?n/2:u),s+Math.sin(g)*u);break;case!1:i.closePath();break}i.fill(),t.borderWidth>0&&i.stroke()}}function _isPointInArea(i,t,e){return e=e||.5,!t||i&&i.x>t.left-e&&i.x<t.right+e&&i.y>t.top-e&&i.y<t.bottom+e}function clipArea(i,t){i.save(),i.beginPath(),i.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),i.clip()}function unclipArea(i){i.restore()}function _steppedLineTo(i,t,e,s,n){if(!t)return i.lineTo(e.x,e.y);if(n==="middle"){const r=(t.x+e.x)/2;i.lineTo(r,t.y),i.lineTo(r,e.y)}else n==="after"!=!!s?i.lineTo(t.x,e.y):i.lineTo(e.x,t.y);i.lineTo(e.x,e.y)}function _bezierCurveTo(i,t,e,s){if(!t)return i.lineTo(e.x,e.y);i.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?e.cp2x:e.cp1x,s?e.cp2y:e.cp1y,e.x,e.y)}function setRenderOpts(i,t){t.translation&&i.translate(t.translation[0],t.translation[1]),isNullOrUndef(t.rotation)||i.rotate(t.rotation),t.color&&(i.fillStyle=t.color),t.textAlign&&(i.textAlign=t.textAlign),t.textBaseline&&(i.textBaseline=t.textBaseline)}function decorateText(i,t,e,s,n){if(n.strikethrough||n.underline){const r=i.measureText(s),a=t-r.actualBoundingBoxLeft,o=t+r.actualBoundingBoxRight,l=e-r.actualBoundingBoxAscent,c=e+r.actualBoundingBoxDescent,p=n.strikethrough?(l+c)/2:c;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=n.decorationWidth||2,i.moveTo(a,p),i.lineTo(o,p),i.stroke()}}function drawBackdrop(i,t){const e=i.fillStyle;i.fillStyle=t.color,i.fillRect(t.left,t.top,t.width,t.height),i.fillStyle=e}function renderText(i,t,e,s,n,r={}){const a=isArray(t)?t:[t],o=r.strokeWidth>0&&r.strokeColor!=="";let l,c;for(i.save(),i.font=n.string,setRenderOpts(i,r),l=0;l<a.length;++l)c=a[l],r.backdrop&&drawBackdrop(i,r.backdrop),o&&(r.strokeColor&&(i.strokeStyle=r.strokeColor),isNullOrUndef(r.strokeWidth)||(i.lineWidth=r.strokeWidth),i.strokeText(c,e,s,r.maxWidth)),i.fillText(c,e,s,r.maxWidth),decorateText(i,e,s,c,r),s+=Number(n.lineHeight);i.restore()}function addRoundedRectPath(i,t){const{x:e,y:s,w:n,h:r,radius:a}=t;i.arc(e+a.topLeft,s+a.topLeft,a.topLeft,1.5*PI,PI,!0),i.lineTo(e,s+r-a.bottomLeft),i.arc(e+a.bottomLeft,s+r-a.bottomLeft,a.bottomLeft,PI,HALF_PI,!0),i.lineTo(e+n-a.bottomRight,s+r),i.arc(e+n-a.bottomRight,s+r-a.bottomRight,a.bottomRight,HALF_PI,0,!0),i.lineTo(e+n,s+a.topRight),i.arc(e+n-a.topRight,s+a.topRight,a.topRight,0,-HALF_PI,!0),i.lineTo(e+a.topLeft,s)}const LINE_HEIGHT=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,FONT_STYLE=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function toLineHeight(i,t){const e=(""+i).match(LINE_HEIGHT);if(!e||e[1]==="normal")return t*1.2;switch(i=+e[2],e[3]){case"px":return i;case"%":i/=100;break}return t*i}const numberOrZero=i=>+i||0;function _readValueToProps(i,t){const e={},s=isObject(t),n=s?Object.keys(t):t,r=isObject(i)?s?a=>valueOrDefault(i[a],i[t[a]]):a=>i[a]:()=>i;for(const a of n)e[a]=numberOrZero(r(a));return e}function toTRBL(i){return _readValueToProps(i,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(i){return _readValueToProps(i,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(i){const t=toTRBL(i);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function toFont(i,t){i=i||{},t=t||defaults.font;let e=valueOrDefault(i.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let s=valueOrDefault(i.style,t.style);s&&!(""+s).match(FONT_STYLE)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const n={family:valueOrDefault(i.family,t.family),lineHeight:toLineHeight(valueOrDefault(i.lineHeight,t.lineHeight),e),size:e,style:s,weight:valueOrDefault(i.weight,t.weight),string:""};return n.string=toFontString(n),n}function resolve(i,t,e,s){let n=!0,r,a,o;for(r=0,a=i.length;r<a;++r)if(o=i[r],o!==void 0&&(t!==void 0&&typeof o=="function"&&(o=o(t),n=!1),e!==void 0&&isArray(o)&&(o=o[e%o.length],n=!1),o!==void 0))return s&&!n&&(s.cacheable=!1),o}function _addGrace(i,t,e){const{min:s,max:n}=i,r=toDimension(t,(n-s)/2),a=(o,l)=>e&&o===0?0:o+l;return{min:a(s,-Math.abs(r)),max:a(n,r)}}function createContext(i,t){return Object.assign(Object.create(i),t)}function _createResolver(i,t=[""],e,s,n=()=>i[0]){const r=e||i;typeof s>"u"&&(s=_resolve("_fallback",i));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:r,_fallback:s,_getTarget:n,override:o=>_createResolver([o,...i],t,r,s)};return new Proxy(a,{deleteProperty(o,l){return delete o[l],delete o._keys,delete i[0][l],!0},get(o,l){return _cached(o,l,()=>_resolveWithPrefixes(l,t,i,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(i[0])},has(o,l){return getKeysFromAllScopes(o).includes(l)},ownKeys(o){return getKeysFromAllScopes(o)},set(o,l,c){const p=o._storage||(o._storage=n());return o[l]=p[l]=c,delete o._keys,!0}})}function _attachContext(i,t,e,s){const n={_cacheable:!1,_proxy:i,_context:t,_subProxy:e,_stack:new Set,_descriptors:_descriptors(i,s),setContext:r=>_attachContext(i,r,e,s),override:r=>_attachContext(i.override(r),t,e,s)};return new Proxy(n,{deleteProperty(r,a){return delete r[a],delete i[a],!0},get(r,a,o){return _cached(r,a,()=>_resolveWithContext(r,a,o))},getOwnPropertyDescriptor(r,a){return r._descriptors.allKeys?Reflect.has(i,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,a)},getPrototypeOf(){return Reflect.getPrototypeOf(i)},has(r,a){return Reflect.has(i,a)},ownKeys(){return Reflect.ownKeys(i)},set(r,a,o){return i[a]=o,delete r[a],!0}})}function _descriptors(i,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:s=t.indexable,_allKeys:n=t.allKeys}=i;return{allKeys:n,scriptable:e,indexable:s,isScriptable:isFunction(e)?e:()=>e,isIndexable:isFunction(s)?s:()=>s}}const readKey=(i,t)=>i?i+_capitalize(t):t,needsSubResolver=(i,t)=>isObject(t)&&i!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function _cached(i,t,e){if(Object.prototype.hasOwnProperty.call(i,t))return i[t];const s=e();return i[t]=s,s}function _resolveWithContext(i,t,e){const{_proxy:s,_context:n,_subProxy:r,_descriptors:a}=i;let o=s[t];return isFunction(o)&&a.isScriptable(t)&&(o=_resolveScriptable(t,o,i,e)),isArray(o)&&o.length&&(o=_resolveArray(t,o,i,a.isIndexable)),needsSubResolver(t,o)&&(o=_attachContext(o,n,r&&r[t],a)),o}function _resolveScriptable(i,t,e,s){const{_proxy:n,_context:r,_subProxy:a,_stack:o}=e;if(o.has(i))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+i);o.add(i);let l=t(r,a||s);return o.delete(i),needsSubResolver(i,l)&&(l=createSubResolver(n._scopes,n,i,l)),l}function _resolveArray(i,t,e,s){const{_proxy:n,_context:r,_subProxy:a,_descriptors:o}=e;if(typeof r.index<"u"&&s(i))return t[r.index%t.length];if(isObject(t[0])){const l=t,c=n._scopes.filter(p=>p!==l);t=[];for(const p of l){const m=createSubResolver(c,n,i,p);t.push(_attachContext(m,r,a&&a[i],o))}}return t}function resolveFallback(i,t,e){return isFunction(i)?i(t,e):i}const getScope=(i,t)=>i===!0?t:typeof i=="string"?resolveObjectKey(t,i):void 0;function addScopes(i,t,e,s,n){for(const r of t){const a=getScope(e,r);if(a){i.add(a);const o=resolveFallback(a._fallback,e,n);if(typeof o<"u"&&o!==e&&o!==s)return o}else if(a===!1&&typeof s<"u"&&e!==s)return null}return!1}function createSubResolver(i,t,e,s){const n=t._rootScopes,r=resolveFallback(t._fallback,e,s),a=[...i,...n],o=new Set;o.add(s);let l=addScopesFromKey(o,a,e,r||e,s);return l===null||typeof r<"u"&&r!==e&&(l=addScopesFromKey(o,a,r,l,s),l===null)?!1:_createResolver(Array.from(o),[""],n,r,()=>subGetTarget(t,e,s))}function addScopesFromKey(i,t,e,s,n){for(;e;)e=addScopes(i,t,e,s,n);return e}function subGetTarget(i,t,e){const s=i._getTarget();t in s||(s[t]={});const n=s[t];return isArray(n)&&isObject(e)?e:n||{}}function _resolveWithPrefixes(i,t,e,s){let n;for(const r of t)if(n=_resolve(readKey(r,i),e),typeof n<"u")return needsSubResolver(i,n)?createSubResolver(e,s,i,n):n}function _resolve(i,t){for(const e of t){if(!e)continue;const s=e[i];if(typeof s<"u")return s}}function getKeysFromAllScopes(i){let t=i._keys;return t||(t=i._keys=resolveKeysFromAllScopes(i._scopes)),t}function resolveKeysFromAllScopes(i){const t=new Set;for(const e of i)for(const s of Object.keys(e).filter(n=>!n.startsWith("_")))t.add(s);return Array.from(t)}function _parseObjectDataRadialScale(i,t,e,s){const{iScale:n}=i,{key:r="r"}=this._parsing,a=new Array(s);let o,l,c,p;for(o=0,l=s;o<l;++o)c=o+e,p=t[c],a[o]={r:n.parse(resolveObjectKey(p,r),c)};return a}const EPSILON=Number.EPSILON||1e-14,getPoint=(i,t)=>t<i.length&&!i[t].skip&&i[t],getValueAxis=i=>i==="x"?"y":"x";function splineCurve(i,t,e,s){const n=i.skip?t:i,r=t,a=e.skip?t:e,o=distanceBetweenPoints(r,n),l=distanceBetweenPoints(a,r);let c=o/(o+l),p=l/(o+l);c=isNaN(c)?0:c,p=isNaN(p)?0:p;const m=s*c,_=s*p;return{previous:{x:r.x-m*(a.x-n.x),y:r.y-m*(a.y-n.y)},next:{x:r.x+_*(a.x-n.x),y:r.y+_*(a.y-n.y)}}}function monotoneAdjust(i,t,e){const s=i.length;let n,r,a,o,l,c=getPoint(i,0);for(let p=0;p<s-1;++p)if(l=c,c=getPoint(i,p+1),!(!l||!c)){if(almostEquals(t[p],0,EPSILON)){e[p]=e[p+1]=0;continue}n=e[p]/t[p],r=e[p+1]/t[p],o=Math.pow(n,2)+Math.pow(r,2),!(o<=9)&&(a=3/Math.sqrt(o),e[p]=n*a*t[p],e[p+1]=r*a*t[p])}}function monotoneCompute(i,t,e="x"){const s=getValueAxis(e),n=i.length;let r,a,o,l=getPoint(i,0);for(let c=0;c<n;++c){if(a=o,o=l,l=getPoint(i,c+1),!o)continue;const p=o[e],m=o[s];a&&(r=(p-a[e])/3,o[`cp1${e}`]=p-r,o[`cp1${s}`]=m-r*t[c]),l&&(r=(l[e]-p)/3,o[`cp2${e}`]=p+r,o[`cp2${s}`]=m+r*t[c])}}function splineCurveMonotone(i,t="x"){const e=getValueAxis(t),s=i.length,n=Array(s).fill(0),r=Array(s);let a,o,l,c=getPoint(i,0);for(a=0;a<s;++a)if(o=l,l=c,c=getPoint(i,a+1),!!l){if(c){const p=c[t]-l[t];n[a]=p!==0?(c[e]-l[e])/p:0}r[a]=o?c?sign(n[a-1])!==sign(n[a])?0:(n[a-1]+n[a])/2:n[a-1]:n[a]}monotoneAdjust(i,n,r),monotoneCompute(i,r,t)}function capControlPoint(i,t,e){return Math.max(Math.min(i,e),t)}function capBezierPoints(i,t){let e,s,n,r,a,o=_isPointInArea(i[0],t);for(e=0,s=i.length;e<s;++e)a=r,r=o,o=e<s-1&&_isPointInArea(i[e+1],t),r&&(n=i[e],a&&(n.cp1x=capControlPoint(n.cp1x,t.left,t.right),n.cp1y=capControlPoint(n.cp1y,t.top,t.bottom)),o&&(n.cp2x=capControlPoint(n.cp2x,t.left,t.right),n.cp2y=capControlPoint(n.cp2y,t.top,t.bottom)))}function _updateBezierControlPoints(i,t,e,s,n){let r,a,o,l;if(t.spanGaps&&(i=i.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")splineCurveMonotone(i,n);else{let c=s?i[i.length-1]:i[0];for(r=0,a=i.length;r<a;++r)o=i[r],l=splineCurve(c,o,i[Math.min(r+1,a-(s?0:1))%a],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}t.capBezierPoints&&capBezierPoints(i,e)}function _isDomSupported(){return typeof window<"u"&&typeof document<"u"}function _getParentNode(i){let t=i.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function parseMaxStyle(i,t,e){let s;return typeof i=="string"?(s=parseInt(i,10),i.indexOf("%")!==-1&&(s=s/100*t.parentNode[e])):s=i,s}const getComputedStyle$1=i=>i.ownerDocument.defaultView.getComputedStyle(i,null);function getStyle(i,t){return getComputedStyle$1(i).getPropertyValue(t)}const positions=["top","right","bottom","left"];function getPositionedStyle(i,t,e){const s={};e=e?"-"+e:"";for(let n=0;n<4;n++){const r=positions[n];s[r]=parseFloat(i[t+"-"+r+e])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const useOffsetPos=(i,t,e)=>(i>0||t>0)&&(!e||!e.shadowRoot);function getCanvasPosition(i,t){const e=i.touches,s=e&&e.length?e[0]:i,{offsetX:n,offsetY:r}=s;let a=!1,o,l;if(useOffsetPos(n,r,i.target))o=n,l=r;else{const c=t.getBoundingClientRect();o=s.clientX-c.left,l=s.clientY-c.top,a=!0}return{x:o,y:l,box:a}}function getRelativePosition(i,t){if("native"in i)return i;const{canvas:e,currentDevicePixelRatio:s}=t,n=getComputedStyle$1(e),r=n.boxSizing==="border-box",a=getPositionedStyle(n,"padding"),o=getPositionedStyle(n,"border","width"),{x:l,y:c,box:p}=getCanvasPosition(i,e),m=a.left+(p&&o.left),_=a.top+(p&&o.top);let{width:y,height:b}=t;return r&&(y-=a.width+o.width,b-=a.height+o.height),{x:Math.round((l-m)/y*e.width/s),y:Math.round((c-_)/b*e.height/s)}}function getContainerSize(i,t,e){let s,n;if(t===void 0||e===void 0){const r=_getParentNode(i);if(!r)t=i.clientWidth,e=i.clientHeight;else{const a=r.getBoundingClientRect(),o=getComputedStyle$1(r),l=getPositionedStyle(o,"border","width"),c=getPositionedStyle(o,"padding");t=a.width-c.width-l.width,e=a.height-c.height-l.height,s=parseMaxStyle(o.maxWidth,r,"clientWidth"),n=parseMaxStyle(o.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:s||INFINITY,maxHeight:n||INFINITY}}const round1=i=>Math.round(i*10)/10;function getMaximumSize(i,t,e,s){const n=getComputedStyle$1(i),r=getPositionedStyle(n,"margin"),a=parseMaxStyle(n.maxWidth,i,"clientWidth")||INFINITY,o=parseMaxStyle(n.maxHeight,i,"clientHeight")||INFINITY,l=getContainerSize(i,t,e);let{width:c,height:p}=l;if(n.boxSizing==="content-box"){const _=getPositionedStyle(n,"border","width"),y=getPositionedStyle(n,"padding");c-=y.width+_.width,p-=y.height+_.height}return c=Math.max(0,c-r.width),p=Math.max(0,s?c/s:p-r.height),c=round1(Math.min(c,a,l.maxWidth)),p=round1(Math.min(p,o,l.maxHeight)),c&&!p&&(p=round1(c/2)),(t!==void 0||e!==void 0)&&s&&l.height&&p>l.height&&(p=l.height,c=round1(Math.floor(p*s))),{width:c,height:p}}function retinaScale(i,t,e){const s=t||1,n=Math.floor(i.height*s),r=Math.floor(i.width*s);i.height=Math.floor(i.height),i.width=Math.floor(i.width);const a=i.canvas;return a.style&&(e||!a.style.height&&!a.style.width)&&(a.style.height=`${i.height}px`,a.style.width=`${i.width}px`),i.currentDevicePixelRatio!==s||a.height!==n||a.width!==r?(i.currentDevicePixelRatio=s,a.height=n,a.width=r,i.ctx.setTransform(s,0,0,s,0,0),!0):!1}const supportsEventListenerOptions=function(){let i=!1;try{const t={get passive(){return i=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return i}();function readUsedSize(i,t){const e=getStyle(i,t),s=e&&e.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function _pointInLine(i,t,e,s){return{x:i.x+e*(t.x-i.x),y:i.y+e*(t.y-i.y)}}function _steppedInterpolation(i,t,e,s){return{x:i.x+e*(t.x-i.x),y:s==="middle"?e<.5?i.y:t.y:s==="after"?e<1?i.y:t.y:e>0?t.y:i.y}}function _bezierInterpolation(i,t,e,s){const n={x:i.cp2x,y:i.cp2y},r={x:t.cp1x,y:t.cp1y},a=_pointInLine(i,n,e),o=_pointInLine(n,r,e),l=_pointInLine(r,t,e),c=_pointInLine(a,o,e),p=_pointInLine(o,l,e);return _pointInLine(c,p,e)}const getRightToLeftAdapter=function(i,t){return{x(e){return i+i+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,s){return e-s},leftForLtr(e,s){return e-s}}},getLeftToRightAdapter=function(){return{x(i){return i},setWidth(i){},textAlign(i){return i},xPlus(i,t){return i+t},leftForLtr(i,t){return i}}};function getRtlAdapter(i,t,e){return i?getRightToLeftAdapter(t,e):getLeftToRightAdapter()}function overrideTextDirection(i,t){let e,s;(t==="ltr"||t==="rtl")&&(e=i.canvas.style,s=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),i.prevTextDirection=s)}function restoreTextDirection(i,t){t!==void 0&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",t[0],t[1]))}function propertyFn(i){return i==="angle"?{between:_angleBetween,compare:_angleDiff,normalize:_normalizeAngle}:{between:_isBetween,compare:(t,e)=>t-e,normalize:t=>t}}function normalizeSegment({start:i,end:t,count:e,loop:s,style:n}){return{start:i%e,end:t%e,loop:s&&(t-i+1)%e===0,style:n}}function getSegment(i,t,e){const{property:s,start:n,end:r}=e,{between:a,normalize:o}=propertyFn(s),l=t.length;let{start:c,end:p,loop:m}=i,_,y;if(m){for(c+=l,p+=l,_=0,y=l;_<y&&a(o(t[c%l][s]),n,r);++_)c--,p--;c%=l,p%=l}return p<c&&(p+=l),{start:c,end:p,loop:m,style:i.style}}function _boundSegment(i,t,e){if(!e)return[i];const{property:s,start:n,end:r}=e,a=t.length,{compare:o,between:l,normalize:c}=propertyFn(s),{start:p,end:m,loop:_,style:y}=getSegment(i,t,e),b=[];let u=!1,g=null,x,P,A;const h=()=>l(n,A,x)&&o(n,A)!==0,d=()=>o(r,x)===0||l(r,A,x),f=()=>u||h(),v=()=>!u||d();for(let w=p,C=p;w<=m;++w)P=t[w%a],!P.skip&&(x=c(P[s]),x!==A&&(u=l(x,n,r),g===null&&f()&&(g=o(x,n)===0?w:C),g!==null&&v()&&(b.push(normalizeSegment({start:g,end:w,loop:_,count:a,style:y})),g=null),C=w,A=x));return g!==null&&b.push(normalizeSegment({start:g,end:m,loop:_,count:a,style:y})),b}function _boundSegments(i,t){const e=[],s=i.segments;for(let n=0;n<s.length;n++){const r=_boundSegment(s[n],i.points,t);r.length&&e.push(...r)}return e}function findStartAndEnd(i,t,e,s){let n=0,r=t-1;if(e&&!s)for(;n<t&&!i[n].skip;)n++;for(;n<t&&i[n].skip;)n++;for(n%=t,e&&(r+=n);r>n&&i[r%t].skip;)r--;return r%=t,{start:n,end:r}}function solidSegments(i,t,e,s){const n=i.length,r=[];let a=t,o=i[t],l;for(l=t+1;l<=e;++l){const c=i[l%n];c.skip||c.stop?o.skip||(s=!1,r.push({start:t%n,end:(l-1)%n,loop:s}),t=a=c.stop?l:null):(a=l,o.skip&&(t=l)),o=c}return a!==null&&r.push({start:t%n,end:a%n,loop:s}),r}function _computeSegments(i,t){const e=i.points,s=i.options.spanGaps,n=e.length;if(!n)return[];const r=!!i._loop,{start:a,end:o}=findStartAndEnd(e,n,r,s);if(s===!0)return splitByStyles(i,[{start:a,end:o,loop:r}],e,t);const l=o<a?o+n:o,c=!!i._fullLoop&&a===0&&o===n-1;return splitByStyles(i,solidSegments(e,a,l,c),e,t)}function splitByStyles(i,t,e,s){return!s||!s.setContext||!e?t:doSplitByStyles(i,t,e,s)}function doSplitByStyles(i,t,e,s){const n=i._chart.getContext(),r=readStyle(i.options),{_datasetIndex:a,options:{spanGaps:o}}=i,l=e.length,c=[];let p=r,m=t[0].start,_=m;function y(b,u,g,x){const P=o?-1:1;if(b!==u){for(b+=l;e[b%l].skip;)b-=P;for(;e[u%l].skip;)u+=P;b%l!==u%l&&(c.push({start:b%l,end:u%l,loop:g,style:x}),p=x,m=u%l)}}for(const b of t){m=o?m:b.start;let u=e[m%l],g;for(_=m+1;_<=b.end;_++){const x=e[_%l];g=readStyle(s.setContext(createContext(n,{type:"segment",p0:u,p1:x,p0DataIndex:(_-1)%l,p1DataIndex:_%l,datasetIndex:a}))),styleChanged(g,p)&&y(m,_-1,b.loop,p),u=x,p=g}m<_-1&&y(m,_-1,b.loop,p)}return c}function readStyle(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function styleChanged(i,t){if(!t)return!1;const e=[],s=function(n,r){return isPatternOrGradient(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(i,s)!==JSON.stringify(t,s)}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class Animator{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,s,n){const r=e.listeners[n],a=e.duration;r.forEach(o=>o({chart:t,initial:e.initial,numSteps:a,currentStep:Math.min(s-e.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=requestAnimFrame.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((s,n)=>{if(!s.running||!s.items.length)return;const r=s.items;let a=r.length-1,o=!1,l;for(;a>=0;--a)l=r[a],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(t),o=!0):(r[a]=r[r.length-1],r.pop());o&&(n.draw(),this._notify(n,s,t,"progress")),r.length||(s.running=!1,this._notify(n,s,t,"complete"),s.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let s=e.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,s)),s}listen(t,e,s){this._getAnims(t).listeners[e].push(s)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((s,n)=>Math.max(s,n._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const s=e.items;let n=s.length-1;for(;n>=0;--n)s[n].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var animator=new Animator;const transparent="transparent",interpolators={boolean(i,t,e){return e>.5?t:i},color(i,t,e){const s=color(i||transparent),n=s.valid&&color(t||transparent);return n&&n.valid?n.mix(s,e).hexString():t},number(i,t,e){return i+(t-i)*e}};class Animation{constructor(t,e,s,n){const r=e[s];n=resolve([t.to,n,r,t.from]);const a=resolve([t.from,r,n]);this._active=!0,this._fn=t.fn||interpolators[t.type||typeof a],this._easing=effects[t.easing]||effects.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=s,this._from=a,this._to=n,this._promises=void 0}active(){return this._active}update(t,e,s){if(this._active){this._notify(!1);const n=this._target[this._prop],r=s-this._start,a=this._duration-r;this._start=s,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=resolve([t.to,e,n,t.from]),this._from=resolve([t.from,n,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,s=this._duration,n=this._prop,r=this._from,a=this._loop,o=this._to;let l;if(this._active=r!==o&&(a||e<s),!this._active){this._target[n]=o,this._notify(!0);return}if(e<0){this._target[n]=r;return}l=e/s%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[n]=this._fn(r,o,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,s)=>{t.push({res:e,rej:s})})}_notify(t){const e=t?"res":"rej",s=this._promises||[];for(let n=0;n<s.length;n++)s[n][e]()}}class Animations{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!isObject(t))return;const e=Object.keys(defaults.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(n=>{const r=t[n];if(!isObject(r))return;const a={};for(const o of e)a[o]=r[o];(isArray(r.properties)&&r.properties||[n]).forEach(o=>{(o===n||!s.has(o))&&s.set(o,a)})})}_animateOptions(t,e){const s=e.options,n=resolveTargetOptions(t,s);if(!n)return[];const r=this._createAnimations(n,s);return s.$shared&&awaitAll(t.options.$animations,s).then(()=>{t.options=s},()=>{}),r}_createAnimations(t,e){const s=this._properties,n=[],r=t.$animations||(t.$animations={}),a=Object.keys(e),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){n.push(...this._animateOptions(t,e));continue}const p=e[c];let m=r[c];const _=s.get(c);if(m)if(_&&m.active()){m.update(_,p,o);continue}else m.cancel();if(!_||!_.duration){t[c]=p;continue}r[c]=m=new Animation(_,t,c,p),n.push(m)}return n}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const s=this._createAnimations(t,e);if(s.length)return animator.add(this._chart,s),!0}}function awaitAll(i,t){const e=[],s=Object.keys(t);for(let n=0;n<s.length;n++){const r=i[s[n]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function resolveTargetOptions(i,t){if(!t)return;let e=i.options;if(!e){i.options=t;return}return e.$shared&&(i.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function scaleClip(i,t){const e=i&&i.options||{},s=e.reverse,n=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:s?r:n,end:s?n:r}}function defaultClip(i,t,e){if(e===!1)return!1;const s=scaleClip(i,e),n=scaleClip(t,e);return{top:n.end,right:s.end,bottom:n.start,left:s.start}}function toClip(i){let t,e,s,n;return isObject(i)?(t=i.top,e=i.right,s=i.bottom,n=i.left):t=e=s=n=i,{top:t,right:e,bottom:s,left:n,disabled:i===!1}}function getSortedDatasetIndices(i,t){const e=[],s=i._getSortedDatasetMetas(t);let n,r;for(n=0,r=s.length;n<r;++n)e.push(s[n].index);return e}function applyStack(i,t,e,s={}){const n=i.keys,r=s.mode==="single";let a,o,l,c;if(t!==null){for(a=0,o=n.length;a<o;++a){if(l=+n[a],l===e){if(s.all)continue;break}c=i.values[l],isNumberFinite(c)&&(r||t===0||sign(t)===sign(c))&&(t+=c)}return t}}function convertObjectDataToArray(i){const t=Object.keys(i),e=new Array(t.length);let s,n,r;for(s=0,n=t.length;s<n;++s)r=t[s],e[s]={x:r,y:i[r]};return e}function isStacked(i,t){const e=i&&i.options.stacked;return e||e===void 0&&t.stack!==void 0}function getStackKey(i,t,e){return`${i.id}.${t.id}.${e.stack||e.type}`}function getUserBounds(i){const{min:t,max:e,minDefined:s,maxDefined:n}=i.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:n?e:Number.POSITIVE_INFINITY}}function getOrCreateStack(i,t,e){const s=i[t]||(i[t]={});return s[e]||(s[e]={})}function getLastIndexInStack(i,t,e,s){for(const n of t.getMatchingVisibleMetas(s).reverse()){const r=i[n.index];if(e&&r>0||!e&&r<0)return n.index}return null}function updateStacks(i,t){const{chart:e,_cachedMeta:s}=i,n=e._stacks||(e._stacks={}),{iScale:r,vScale:a,index:o}=s,l=r.axis,c=a.axis,p=getStackKey(r,a,s),m=t.length;let _;for(let y=0;y<m;++y){const b=t[y],{[l]:u,[c]:g}=b,x=b._stacks||(b._stacks={});_=x[c]=getOrCreateStack(n,p,u),_[o]=g,_._top=getLastIndexInStack(_,a,!0,s.type),_._bottom=getLastIndexInStack(_,a,!1,s.type);const P=_._visualValues||(_._visualValues={});P[o]=g}}function getFirstScaleId(i,t){const e=i.scales;return Object.keys(e).filter(s=>e[s].axis===t).shift()}function createDatasetContext(i,t){return createContext(i,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function createDataContext(i,t,e){return createContext(i,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function clearStacks(i,t){const e=i.controller.index,s=i.vScale&&i.vScale.axis;if(s){t=t||i._parsed;for(const n of t){const r=n._stacks;if(!r||r[s]===void 0||r[s][e]===void 0)return;delete r[s][e],r[s]._visualValues!==void 0&&r[s]._visualValues[e]!==void 0&&delete r[s]._visualValues[e]}}}const isDirectUpdateMode=i=>i==="reset"||i==="none",cloneIfNotShared=(i,t)=>t?i:Object.assign({},i),createStack=(i,t,e)=>i&&!t.hidden&&t._stacked&&{keys:getSortedDatasetIndices(e,!0),values:null};class DatasetController{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=isStacked(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&clearStacks(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,s=this.getDataset(),n=(m,_,y,b)=>m==="x"?_:m==="r"?b:y,r=e.xAxisID=valueOrDefault(s.xAxisID,getFirstScaleId(t,"x")),a=e.yAxisID=valueOrDefault(s.yAxisID,getFirstScaleId(t,"y")),o=e.rAxisID=valueOrDefault(s.rAxisID,getFirstScaleId(t,"r")),l=e.indexAxis,c=e.iAxisID=n(l,r,a,o),p=e.vAxisID=n(l,a,r,o);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(a),e.rScale=this.getScaleForId(o),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(p)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),t._stacked&&clearStacks(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),s=this._data;if(isObject(e))this._data=convertObjectDataToArray(e);else if(s!==e){if(s){unlistenArrayEvents(s,this);const n=this._cachedMeta;clearStacks(n),n._parsed=[]}e&&Object.isExtensible(e)&&listenArrayEvents(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,s=this.getDataset();let n=!1;this._dataCheck();const r=e._stacked;e._stacked=isStacked(e.vScale,e),e.stack!==s.stack&&(n=!0,clearStacks(e),e.stack=s.stack),this._resyncElements(t),(n||r!==e._stacked)&&updateStacks(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),s=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:s,_data:n}=this,{iScale:r,_stacked:a}=s,o=r.axis;let l=t===0&&e===n.length?!0:s._sorted,c=t>0&&s._parsed[t-1],p,m,_;if(this._parsing===!1)s._parsed=n,s._sorted=!0,_=n;else{isArray(n[t])?_=this.parseArrayData(s,n,t,e):isObject(n[t])?_=this.parseObjectData(s,n,t,e):_=this.parsePrimitiveData(s,n,t,e);const y=()=>m[o]===null||c&&m[o]<c[o];for(p=0;p<e;++p)s._parsed[p+t]=m=_[p],l&&(y()&&(l=!1),c=m);s._sorted=l}a&&updateStacks(this,_)}parsePrimitiveData(t,e,s,n){const{iScale:r,vScale:a}=t,o=r.axis,l=a.axis,c=r.getLabels(),p=r===a,m=new Array(n);let _,y,b;for(_=0,y=n;_<y;++_)b=_+s,m[_]={[o]:p||r.parse(c[b],b),[l]:a.parse(e[b],b)};return m}parseArrayData(t,e,s,n){const{xScale:r,yScale:a}=t,o=new Array(n);let l,c,p,m;for(l=0,c=n;l<c;++l)p=l+s,m=e[p],o[l]={x:r.parse(m[0],p),y:a.parse(m[1],p)};return o}parseObjectData(t,e,s,n){const{xScale:r,yScale:a}=t,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=new Array(n);let p,m,_,y;for(p=0,m=n;p<m;++p)_=p+s,y=e[_],c[p]={x:r.parse(resolveObjectKey(y,o),_),y:a.parse(resolveObjectKey(y,l),_)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,s){const n=this.chart,r=this._cachedMeta,a=e[t.axis],o={keys:getSortedDatasetIndices(n,!0),values:e._stacks[t.axis]._visualValues};return applyStack(o,a,r.index,{mode:s})}updateRangeFromParsed(t,e,s,n){const r=s[e.axis];let a=r===null?NaN:r;const o=n&&s._stacks[e.axis];n&&o&&(n.values=o,a=applyStack(n,r,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,e){const s=this._cachedMeta,n=s._parsed,r=s._sorted&&t===s.iScale,a=n.length,o=this._getOtherScale(t),l=createStack(e,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:p,max:m}=getUserBounds(o);let _,y;function b(){y=n[_];const u=y[o.axis];return!isNumberFinite(y[t.axis])||p>u||m<u}for(_=0;_<a&&!(!b()&&(this.updateRangeFromParsed(c,t,y,l),r));++_);if(r){for(_=a-1;_>=0;--_)if(!b()){this.updateRangeFromParsed(c,t,y,l);break}}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,s=[];let n,r,a;for(n=0,r=e.length;n<r;++n)a=e[n][t.axis],isNumberFinite(a)&&s.push(a);return s}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,s=e.iScale,n=e.vScale,r=this.getParsed(t);return{label:s?""+s.getLabelForValue(r[s.axis]):"",value:n?""+n.getLabelForValue(r[n.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=toClip(valueOrDefault(this.options.clip,defaultClip(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,s=this._cachedMeta,n=s.data||[],r=e.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||n.length-o,c=this.options.drawActiveElementsOnTop;let p;for(s.dataset&&s.dataset.draw(t,r,o,l),p=o;p<o+l;++p){const m=n[p];m.hidden||(m.active&&c?a.push(m):m.draw(t,r))}for(p=0;p<a.length;++p)a[p].draw(t,r)}getStyle(t,e){const s=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(t||0,s)}getContext(t,e,s){const n=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const a=this._cachedMeta.data[t];r=a.$context||(a.$context=createDataContext(this.getContext(),t,a)),r.parsed=this.getParsed(t),r.raw=n.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=createDatasetContext(this.chart.getContext(),this.index)),r.dataset=n,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=s,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",s){const n=e==="active",r=this._cachedDataOpts,a=t+"-"+e,o=r[a],l=this.enableOptionSharing&&defined(s);if(o)return cloneIfNotShared(o,l);const c=this.chart.config,p=c.datasetElementScopeKeys(this._type,t),m=n?[`${t}Hover`,"hover",t,""]:[t,""],_=c.getOptionScopes(this.getDataset(),p),y=Object.keys(defaults.elements[t]),b=()=>this.getContext(s,n,e),u=c.resolveNamedOptions(_,y,b,m);return u.$shared&&(u.$shared=l,r[a]=Object.freeze(cloneIfNotShared(u,l))),u}_resolveAnimations(t,e,s){const n=this.chart,r=this._cachedDataOpts,a=`animation-${e}`,o=r[a];if(o)return o;let l;if(n.options.animation!==!1){const p=this.chart.config,m=p.datasetAnimationScopeKeys(this._type,e),_=p.getOptionScopes(this.getDataset(),m);l=p.createResolver(_,this.getContext(t,s,e))}const c=new Animations(n,l&&l.animations);return l&&l._cacheable&&(r[a]=Object.freeze(c)),c}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||isDirectUpdateMode(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const s=this.resolveDataElementOptions(t,e),n=this._sharedOptions,r=this.getSharedOptions(s),a=this.includeOptions(e,r)||r!==n;return this.updateSharedOptions(r,e,s),{sharedOptions:r,includeOptions:a}}updateElement(t,e,s,n){isDirectUpdateMode(n)?Object.assign(t,s):this._resolveAnimations(e,n).update(t,s)}updateSharedOptions(t,e,s){t&&!isDirectUpdateMode(e)&&this._resolveAnimations(void 0,e).update(t,s)}_setStyle(t,e,s,n){t.active=n;const r=this.getStyle(e,n);this._resolveAnimations(e,s,n).update(t,{options:!n&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,s){this._setStyle(t,s,"active",!1)}setHoverStyle(t,e,s){this._setStyle(t,s,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,s=this._cachedMeta.data;for(const[o,l,c]of this._syncList)this[o](l,c);this._syncList=[];const n=s.length,r=e.length,a=Math.min(r,n);a&&this.parse(0,a),r>n?this._insertElements(n,r-n,t):r<n&&this._removeElements(r,n-r)}_insertElements(t,e,s=!0){const n=this._cachedMeta,r=n.data,a=t+e;let o;const l=c=>{for(c.length+=e,o=c.length-1;o>=a;o--)c[o]=c[o-e]};for(l(r),o=t;o<a;++o)r[o]=new this.dataElementType;this._parsing&&l(n._parsed),this.parse(t,e),s&&this.updateElements(r,t,e,"reset")}updateElements(t,e,s,n){}_removeElements(t,e){const s=this._cachedMeta;if(this._parsing){const n=s._parsed.splice(t,e);s._stacked&&clearStacks(s,n)}s.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,s,n]=t;this[e](s,n)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const s=arguments.length-2;s&&this._sync(["_insertElements",t,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ft(DatasetController,"defaults",{}),ft(DatasetController,"datasetElementType",null),ft(DatasetController,"dataElementType",null);function getAllScaleValues(i,t){if(!i._cache.$bar){const e=i.getMatchingVisibleMetas(t);let s=[];for(let n=0,r=e.length;n<r;n++)s=s.concat(e[n].controller.getAllParsedValues(i));i._cache.$bar=_arrayUnique(s.sort((n,r)=>n-r))}return i._cache.$bar}function computeMinSampleSize(i){const t=i.iScale,e=getAllScaleValues(t,i.type);let s=t._length,n,r,a,o;const l=()=>{a===32767||a===-32768||(defined(o)&&(s=Math.min(s,Math.abs(a-o)||s)),o=a)};for(n=0,r=e.length;n<r;++n)a=t.getPixelForValue(e[n]),l();for(o=void 0,n=0,r=t.ticks.length;n<r;++n)a=t.getPixelForTick(n),l();return s}function computeFitCategoryTraits(i,t,e,s){const n=e.barThickness;let r,a;return isNullOrUndef(n)?(r=t.min*e.categoryPercentage,a=e.barPercentage):(r=n*s,a=1),{chunk:r/s,ratio:a,start:t.pixels[i]-r/2}}function computeFlexCategoryTraits(i,t,e,s){const n=t.pixels,r=n[i];let a=i>0?n[i-1]:null,o=i<n.length-1?n[i+1]:null;const l=e.categoryPercentage;a===null&&(a=r-(o===null?t.end-t.start:o-r)),o===null&&(o=r+r-a);const c=r-(r-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/s,ratio:e.barPercentage,start:c}}function parseFloatBar(i,t,e,s){const n=e.parse(i[0],s),r=e.parse(i[1],s),a=Math.min(n,r),o=Math.max(n,r);let l=a,c=o;Math.abs(a)>Math.abs(o)&&(l=o,c=a),t[e.axis]=c,t._custom={barStart:l,barEnd:c,start:n,end:r,min:a,max:o}}function parseValue(i,t,e,s){return isArray(i)?parseFloatBar(i,t,e,s):t[e.axis]=e.parse(i,s),t}function parseArrayOrPrimitive(i,t,e,s){const n=i.iScale,r=i.vScale,a=n.getLabels(),o=n===r,l=[];let c,p,m,_;for(c=e,p=e+s;c<p;++c)_=t[c],m={},m[n.axis]=o||n.parse(a[c],c),l.push(parseValue(_,m,r,c));return l}function isFloatBar(i){return i&&i.barStart!==void 0&&i.barEnd!==void 0}function barSign(i,t,e){return i!==0?sign(i):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function borderProps(i){let t,e,s,n,r;return i.horizontal?(t=i.base>i.x,e="left",s="right"):(t=i.base<i.y,e="bottom",s="top"),t?(n="end",r="start"):(n="start",r="end"),{start:e,end:s,reverse:t,top:n,bottom:r}}function setBorderSkipped(i,t,e,s){let n=t.borderSkipped;const r={};if(!n){i.borderSkipped=r;return}if(n===!0){i.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:l,top:c,bottom:p}=borderProps(i);n==="middle"&&e&&(i.enableBorderRadius=!0,(e._top||0)===s?n=c:(e._bottom||0)===s?n=p:(r[parseEdge(p,a,o,l)]=!0,n=c)),r[parseEdge(n,a,o,l)]=!0,i.borderSkipped=r}function parseEdge(i,t,e,s){return s?(i=swap(i,t,e),i=startEnd(i,e,t)):i=startEnd(i,t,e),i}function swap(i,t,e){return i===t?e:i===e?t:i}function startEnd(i,t,e){return i==="start"?t:i==="end"?e:i}function setInflateAmount(i,{inflateAmount:t},e){i.inflateAmount=t==="auto"?e===1?.33:0:t}class BarController extends DatasetController{parsePrimitiveData(t,e,s,n){return parseArrayOrPrimitive(t,e,s,n)}parseArrayData(t,e,s,n){return parseArrayOrPrimitive(t,e,s,n)}parseObjectData(t,e,s,n){const{iScale:r,vScale:a}=t,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=r.axis==="x"?o:l,p=a.axis==="x"?o:l,m=[];let _,y,b,u;for(_=s,y=s+n;_<y;++_)u=e[_],b={},b[r.axis]=r.parse(resolveObjectKey(u,c),_),m.push(parseValue(resolveObjectKey(u,p),b,a,_));return m}updateRangeFromParsed(t,e,s,n){super.updateRangeFromParsed(t,e,s,n);const r=s._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:s,vScale:n}=e,r=this.getParsed(t),a=r._custom,o=isFloatBar(a)?"["+a.start+", "+a.end+"]":""+n.getLabelForValue(r[n.axis]);return{label:""+s.getLabelForValue(r[s.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,s,n){const r=n==="reset",{index:a,_cachedMeta:{vScale:o}}=this,l=o.getBasePixel(),c=o.isHorizontal(),p=this._getRuler(),{sharedOptions:m,includeOptions:_}=this._getSharedOptions(e,n);for(let y=e;y<e+s;y++){const b=this.getParsed(y),u=r||isNullOrUndef(b[o.axis])?{base:l,head:l}:this._calculateBarValuePixels(y),g=this._calculateBarIndexPixels(y,p),x=(b._stacks||{})[o.axis],P={horizontal:c,base:u.base,enableBorderRadius:!x||isFloatBar(b._custom)||a===x._top||a===x._bottom,x:c?u.head:g.center,y:c?g.center:u.head,height:c?g.size:Math.abs(u.size),width:c?Math.abs(u.size):g.size};_&&(P.options=m||this.resolveDataElementOptions(y,t[y].active?"active":n));const A=P.options||t[y].options;setBorderSkipped(P,A,x,a),setInflateAmount(P,A,p.ratio),this.updateElement(t[y],y,P,n)}}_getStacks(t,e){const{iScale:s}=this._cachedMeta,n=s.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),r=s.options.stacked,a=[],o=l=>{const c=l.controller.getParsed(e),p=c&&c[l.vScale.axis];if(isNullOrUndef(p)||isNaN(p))return!0};for(const l of n)if(!(e!==void 0&&o(l))&&((r===!1||a.indexOf(l.stack)===-1||r===void 0&&l.stack===void 0)&&a.push(l.stack),l.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,s){const n=this._getStacks(t,s),r=e!==void 0?n.indexOf(e):-1;return r===-1?n.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,s=e.iScale,n=[];let r,a;for(r=0,a=e.data.length;r<a;++r)n.push(s.getPixelForValue(this.getParsed(r)[s.axis],r));const o=t.barThickness;return{min:o||computeMinSampleSize(e),pixels:n,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:s,index:n},options:{base:r,minBarLength:a}}=this,o=r||0,l=this.getParsed(t),c=l._custom,p=isFloatBar(c);let m=l[e.axis],_=0,y=s?this.applyStack(e,l,s):m,b,u;y!==m&&(_=y-m,y=m),p&&(m=c.barStart,y=c.barEnd-c.barStart,m!==0&&sign(m)!==sign(c.barEnd)&&(_=0),_+=m);const g=!isNullOrUndef(r)&&!p?r:_;let x=e.getPixelForValue(g);if(this.chart.getDataVisibility(t)?b=e.getPixelForValue(_+y):b=x,u=b-x,Math.abs(u)<a){u=barSign(u,e,o)*a,m===o&&(x-=u/2);const P=e.getPixelForDecimal(0),A=e.getPixelForDecimal(1),h=Math.min(P,A),d=Math.max(P,A);x=Math.max(Math.min(x,d),h),b=x+u,s&&!p&&(l._stacks[e.axis]._visualValues[n]=e.getValueForPixel(b)-e.getValueForPixel(x))}if(x===e.getPixelForValue(o)){const P=sign(u)*e.getLineWidthForValue(o)/2;x+=P,u-=P}return{size:u,base:x,head:b,center:b+u/2}}_calculateBarIndexPixels(t,e){const s=e.scale,n=this.options,r=n.skipNull,a=valueOrDefault(n.maxBarThickness,1/0);let o,l;if(e.grouped){const c=r?this._getStackCount(t):e.stackCount,p=n.barThickness==="flex"?computeFlexCategoryTraits(t,e,n,c):computeFitCategoryTraits(t,e,n,c),m=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0);o=p.start+p.chunk*m+p.chunk/2,l=Math.min(a,p.chunk*p.ratio)}else o=s.getPixelForValue(this.getParsed(t)[s.axis],t),l=Math.min(a,e.min*e.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}}draw(){const t=this._cachedMeta,e=t.vScale,s=t.data,n=s.length;let r=0;for(;r<n;++r)this.getParsed(r)[e.axis]!==null&&s[r].draw(this._ctx)}}ft(BarController,"id","bar"),ft(BarController,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ft(BarController,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class BubbleController extends DatasetController{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,s,n){const r=super.parsePrimitiveData(t,e,s,n);for(let a=0;a<r.length;a++)r[a]._custom=this.resolveDataElementOptions(a+s).radius;return r}parseArrayData(t,e,s,n){const r=super.parseArrayData(t,e,s,n);for(let a=0;a<r.length;a++){const o=e[s+a];r[a]._custom=valueOrDefault(o[2],this.resolveDataElementOptions(a+s).radius)}return r}parseObjectData(t,e,s,n){const r=super.parseObjectData(t,e,s,n);for(let a=0;a<r.length;a++){const o=e[s+a];r[a]._custom=valueOrDefault(o&&o.r&&+o.r,this.resolveDataElementOptions(a+s).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let s=t.length-1;s>=0;--s)e=Math.max(e,t[s].size(this.resolveDataElementOptions(s))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:n,yScale:r}=e,a=this.getParsed(t),o=n.getLabelForValue(a.x),l=r.getLabelForValue(a.y),c=a._custom;return{label:s[t]||"",value:"("+o+", "+l+(c?", "+c:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,s,n){const r=n==="reset",{iScale:a,vScale:o}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(e,n),p=a.axis,m=o.axis;for(let _=e;_<e+s;_++){const y=t[_],b=!r&&this.getParsed(_),u={},g=u[p]=r?a.getPixelForDecimal(.5):a.getPixelForValue(b[p]),x=u[m]=r?o.getBasePixel():o.getPixelForValue(b[m]);u.skip=isNaN(g)||isNaN(x),c&&(u.options=l||this.resolveDataElementOptions(_,y.active?"active":n),r&&(u.options.radius=0)),this.updateElement(y,_,u,n)}}resolveDataElementOptions(t,e){const s=this.getParsed(t);let n=super.resolveDataElementOptions(t,e);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const r=n.radius;return e!=="active"&&(n.radius=0),n.radius+=valueOrDefault(s&&s._custom,r),n}}ft(BubbleController,"id","bubble"),ft(BubbleController,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),ft(BubbleController,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function getRatioAndOffset(i,t,e){let s=1,n=1,r=0,a=0;if(t<TAU){const o=i,l=o+t,c=Math.cos(o),p=Math.sin(o),m=Math.cos(l),_=Math.sin(l),y=(A,h,d)=>_angleBetween(A,o,l,!0)?1:Math.max(h,h*e,d,d*e),b=(A,h,d)=>_angleBetween(A,o,l,!0)?-1:Math.min(h,h*e,d,d*e),u=y(0,c,m),g=y(HALF_PI,p,_),x=b(PI,c,m),P=b(PI+HALF_PI,p,_);s=(u-x)/2,n=(g-P)/2,r=-(u+x)/2,a=-(g+P)/2}return{ratioX:s,ratioY:n,offsetX:r,offsetY:a}}class DoughnutController extends DatasetController{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const s=this.getDataset().data,n=this._cachedMeta;if(this._parsing===!1)n._parsed=s;else{let r=l=>+s[l];if(isObject(s[t])){const{key:l="value"}=this._parsing;r=c=>+resolveObjectKey(s[c],l)}let a,o;for(a=t,o=t+e;a<o;++a)n._parsed[a]=r(a)}}_getRotation(){return toRadians(this.options.rotation-90)}_getCircumference(){return toRadians(this.options.circumference)}_getRotationExtents(){let t=TAU,e=-TAU;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const n=this.chart.getDatasetMeta(s).controller,r=n._getRotation(),a=n._getCircumference();t=Math.min(t,r),e=Math.max(e,r+a)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:s}=e,n=this._cachedMeta,r=n.data,a=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,o=Math.max((Math.min(s.width,s.height)-a)/2,0),l=Math.min(toPercentage(this.options.cutout,o),1),c=this._getRingWeight(this.index),{circumference:p,rotation:m}=this._getRotationExtents(),{ratioX:_,ratioY:y,offsetX:b,offsetY:u}=getRatioAndOffset(m,p,l),g=(s.width-a)/_,x=(s.height-a)/y,P=Math.max(Math.min(g,x)/2,0),A=toDimension(this.options.radius,P),h=Math.max(A*l,0),d=(A-h)/this._getVisibleDatasetWeightTotal();this.offsetX=b*A,this.offsetY=u*A,n.total=this.calculateTotal(),this.outerRadius=A-d*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-d*c,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const s=this.options,n=this._cachedMeta,r=this._getCircumference();return e&&s.animation.animateRotate||!this.chart.getDataVisibility(t)||n._parsed[t]===null||n.data[t].hidden?0:this.calculateCircumference(n._parsed[t]*r/TAU)}updateElements(t,e,s,n){const r=n==="reset",a=this.chart,o=a.chartArea,c=a.options.animation,p=(o.left+o.right)/2,m=(o.top+o.bottom)/2,_=r&&c.animateScale,y=_?0:this.innerRadius,b=_?0:this.outerRadius,{sharedOptions:u,includeOptions:g}=this._getSharedOptions(e,n);let x=this._getRotation(),P;for(P=0;P<e;++P)x+=this._circumference(P,r);for(P=e;P<e+s;++P){const A=this._circumference(P,r),h=t[P],d={x:p+this.offsetX,y:m+this.offsetY,startAngle:x,endAngle:x+A,circumference:A,outerRadius:b,innerRadius:y};g&&(d.options=u||this.resolveDataElementOptions(P,h.active?"active":n)),x+=A,this.updateElement(h,P,d,n)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let s=0,n;for(n=0;n<e.length;n++){const r=t._parsed[n];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(n)&&!e[n].hidden&&(s+=Math.abs(r))}return s}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?TAU*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,n=s.data.labels||[],r=formatNumber(e._parsed[t],s.options.locale);return{label:n[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const s=this.chart;let n,r,a,o,l;if(!t){for(n=0,r=s.data.datasets.length;n<r;++n)if(s.isDatasetVisible(n)){a=s.getDatasetMeta(n),t=a.data,o=a.controller;break}}if(!t)return 0;for(n=0,r=t.length;n<r;++n)l=o.resolveDataElementOptions(n),l.borderAlign!=="inner"&&(e=Math.max(e,l.borderWidth||0,l.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let s=0,n=t.length;s<n;++s){const r=this.resolveDataElementOptions(s);e=Math.max(e,r.offset||0,r.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let s=0;s<t;++s)this.chart.isDatasetVisible(s)&&(e+=this._getRingWeight(s));return e}_getRingWeight(t){return Math.max(valueOrDefault(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ft(DoughnutController,"id","doughnut"),ft(DoughnutController,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ft(DoughnutController,"descriptors",{_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")}),ft(DoughnutController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:n}}=t.legend.options;return e.labels.map((r,a)=>{const l=t.getDatasetMeta(0).controller.getStyle(a);return{text:r,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:n,lineWidth:l.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}}});class LineController extends DatasetController{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:s,data:n=[],_dataset:r}=e,a=this.chart._animationsDisabled;let{start:o,count:l}=_getStartAndCountOfVisiblePoints(e,n,a);this._drawStart=o,this._drawCount=l,_scaleRangesChanged(e)&&(o=0,l=n.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!r._decimated,s.points=n;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!a,options:c},t),this.updateElements(n,o,l,t)}updateElements(t,e,s,n){const r=n==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:p,includeOptions:m}=this._getSharedOptions(e,n),_=a.axis,y=o.axis,{spanGaps:b,segment:u}=this.options,g=isNumber(b)?b:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||r||n==="none",P=e+s,A=t.length;let h=e>0&&this.getParsed(e-1);for(let d=0;d<A;++d){const f=t[d],v=x?f:{};if(d<e||d>=P){v.skip=!0;continue}const w=this.getParsed(d),C=isNullOrUndef(w[y]),k=v[_]=a.getPixelForValue(w[_],d),R=v[y]=r||C?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,w,l):w[y],d);v.skip=isNaN(k)||isNaN(R)||C,v.stop=d>0&&Math.abs(w[_]-h[_])>g,u&&(v.parsed=w,v.raw=c.data[d]),m&&(v.options=p||this.resolveDataElementOptions(d,f.active?"active":n)),x||this.updateElement(f,d,v,n),h=w}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,s=e.options&&e.options.borderWidth||0,n=t.data||[];if(!n.length)return s;const r=n[0].size(this.resolveDataElementOptions(0)),a=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(s,r,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}ft(LineController,"id","line"),ft(LineController,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),ft(LineController,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class PolarAreaController extends DatasetController{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,s=this.chart,n=s.data.labels||[],r=formatNumber(e._parsed[t].r,s.options.locale);return{label:n[t]||"",value:r}}parseObjectData(t,e,s,n){return _parseObjectDataRadialScale.bind(this)(t,e,s,n)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((s,n)=>{const r=this.getParsed(n).r;!isNaN(r)&&this.chart.getDataVisibility(n)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,s=t.options,n=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(n/2,0),a=Math.max(s.cutoutPercentage?r/100*s.cutoutPercentage:1,0),o=(r-a)/t.getVisibleDatasetCount();this.outerRadius=r-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,e,s,n){const r=n==="reset",a=this.chart,l=a.options.animation,c=this._cachedMeta.rScale,p=c.xCenter,m=c.yCenter,_=c.getIndexAngle(0)-.5*PI;let y=_,b;const u=360/this.countVisibleElements();for(b=0;b<e;++b)y+=this._computeAngle(b,n,u);for(b=e;b<e+s;b++){const g=t[b];let x=y,P=y+this._computeAngle(b,n,u),A=a.getDataVisibility(b)?c.getDistanceFromCenterForValue(this.getParsed(b).r):0;y=P,r&&(l.animateScale&&(A=0),l.animateRotate&&(x=P=_));const h={x:p,y:m,innerRadius:0,outerRadius:A,startAngle:x,endAngle:P,options:this.resolveDataElementOptions(b,g.active?"active":n)};this.updateElement(g,b,h,n)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((s,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&e++}),e}_computeAngle(t,e,s){return this.chart.getDataVisibility(t)?toRadians(this.resolveDataElementOptions(t,e).angle||s):0}}ft(PolarAreaController,"id","polarArea"),ft(PolarAreaController,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),ft(PolarAreaController,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:s,color:n}}=t.legend.options;return e.labels.map((r,a)=>{const l=t.getDatasetMeta(0).controller.getStyle(a);return{text:r,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:n,lineWidth:l.borderWidth,pointStyle:s,hidden:!t.getDataVisibility(a),index:a}})}return[]}},onClick(t,e,s){s.chart.toggleDataVisibility(e.index),s.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class PieController extends DoughnutController{}ft(PieController,"id","pie"),ft(PieController,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class RadarController extends DatasetController{getLabelAndValue(t){const e=this._cachedMeta.vScale,s=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(s[e.axis])}}parseObjectData(t,e,s,n){return _parseObjectDataRadialScale.bind(this)(t,e,s,n)}update(t){const e=this._cachedMeta,s=e.dataset,n=e.data||[],r=e.iScale.getLabels();if(s.points=n,t!=="resize"){const a=this.resolveDatasetElementOptions(t);this.options.showLine||(a.borderWidth=0);const o={_loop:!0,_fullLoop:r.length===n.length,options:a};this.updateElement(s,void 0,o,t)}this.updateElements(n,0,n.length,t)}updateElements(t,e,s,n){const r=this._cachedMeta.rScale,a=n==="reset";for(let o=e;o<e+s;o++){const l=t[o],c=this.resolveDataElementOptions(o,l.active?"active":n),p=r.getPointPositionForValue(o,this.getParsed(o).r),m=a?r.xCenter:p.x,_=a?r.yCenter:p.y,y={x:m,y:_,angle:p.angle,skip:isNaN(m)||isNaN(_),options:c};this.updateElement(l,o,y,n)}}}ft(RadarController,"id","radar"),ft(RadarController,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),ft(RadarController,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class ScatterController extends DatasetController{getLabelAndValue(t){const e=this._cachedMeta,s=this.chart.data.labels||[],{xScale:n,yScale:r}=e,a=this.getParsed(t),o=n.getLabelForValue(a.x),l=r.getLabelForValue(a.y);return{label:s[t]||"",value:"("+o+", "+l+")"}}update(t){const e=this._cachedMeta,{data:s=[]}=e,n=this.chart._animationsDisabled;let{start:r,count:a}=_getStartAndCountOfVisiblePoints(e,s,n);if(this._drawStart=r,this._drawCount=a,_scaleRangesChanged(e)&&(r=0,a=s.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:o,_dataset:l}=e;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!l._decimated,o.points=s;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(o,void 0,{animated:!n,options:c},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(s,r,a,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,s,n){const r=n==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,p=this.resolveDataElementOptions(e,n),m=this.getSharedOptions(p),_=this.includeOptions(n,m),y=a.axis,b=o.axis,{spanGaps:u,segment:g}=this.options,x=isNumber(u)?u:Number.POSITIVE_INFINITY,P=this.chart._animationsDisabled||r||n==="none";let A=e>0&&this.getParsed(e-1);for(let h=e;h<e+s;++h){const d=t[h],f=this.getParsed(h),v=P?d:{},w=isNullOrUndef(f[b]),C=v[y]=a.getPixelForValue(f[y],h),k=v[b]=r||w?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,f,l):f[b],h);v.skip=isNaN(C)||isNaN(k)||w,v.stop=h>0&&Math.abs(f[y]-A[y])>x,g&&(v.parsed=f,v.raw=c.data[h]),_&&(v.options=m||this.resolveDataElementOptions(h,d.active?"active":n)),P||this.updateElement(d,h,v,n),A=f}this.updateSharedOptions(m,n,p)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let o=0;for(let l=e.length-1;l>=0;--l)o=Math.max(o,e[l].size(this.resolveDataElementOptions(l))/2);return o>0&&o}const s=t.dataset,n=s.options&&s.options.borderWidth||0;if(!e.length)return n;const r=e[0].size(this.resolveDataElementOptions(0)),a=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(n,r,a)/2}}ft(ScatterController,"id","scatter"),ft(ScatterController,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),ft(ScatterController,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var controllers=Object.freeze({__proto__:null,BarController,BubbleController,DoughnutController,LineController,PieController,PolarAreaController,RadarController,ScatterController});function abstract(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class DateAdapterBase{constructor(t){ft(this,"options");this.options=t||{}}static override(t){Object.assign(DateAdapterBase.prototype,t)}init(){}formats(){return abstract()}parse(){return abstract()}format(){return abstract()}add(){return abstract()}diff(){return abstract()}startOf(){return abstract()}endOf(){return abstract()}}var adapters={_date:DateAdapterBase};function binarySearch(i,t,e,s){const{controller:n,data:r,_sorted:a}=i,o=n._cachedMeta.iScale;if(o&&t===o.axis&&t!=="r"&&a&&r.length){const l=o._reversePixels?_rlookupByKey:_lookupByKey;if(s){if(n._sharedOptions){const c=r[0],p=typeof c.getRange=="function"&&c.getRange(t);if(p){const m=l(r,t,e-p),_=l(r,t,e+p);return{lo:m.lo,hi:_.hi}}}}else return l(r,t,e)}return{lo:0,hi:r.length-1}}function evaluateInteractionItems(i,t,e,s,n){const r=i.getSortedVisibleDatasetMetas(),a=e[t];for(let o=0,l=r.length;o<l;++o){const{index:c,data:p}=r[o],{lo:m,hi:_}=binarySearch(r[o],t,a,n);for(let y=m;y<=_;++y){const b=p[y];b.skip||s(b,c,y)}}}function getDistanceMetricForAxis(i){const t=i.indexOf("x")!==-1,e=i.indexOf("y")!==-1;return function(s,n){const r=t?Math.abs(s.x-n.x):0,a=e?Math.abs(s.y-n.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(a,2))}}function getIntersectItems(i,t,e,s,n){const r=[];return!n&&!i.isPointInArea(t)||evaluateInteractionItems(i,e,t,function(o,l,c){!n&&!_isPointInArea(o,i.chartArea,0)||o.inRange(t.x,t.y,s)&&r.push({element:o,datasetIndex:l,index:c})},!0),r}function getNearestRadialItems(i,t,e,s){let n=[];function r(a,o,l){const{startAngle:c,endAngle:p}=a.getProps(["startAngle","endAngle"],s),{angle:m}=getAngleFromPoint(a,{x:t.x,y:t.y});_angleBetween(m,c,p)&&n.push({element:a,datasetIndex:o,index:l})}return evaluateInteractionItems(i,e,t,r),n}function getNearestCartesianItems(i,t,e,s,n,r){let a=[];const o=getDistanceMetricForAxis(e);let l=Number.POSITIVE_INFINITY;function c(p,m,_){const y=p.inRange(t.x,t.y,n);if(s&&!y)return;const b=p.getCenterPoint(n);if(!(!!r||i.isPointInArea(b))&&!y)return;const g=o(t,b);g<l?(a=[{element:p,datasetIndex:m,index:_}],l=g):g===l&&a.push({element:p,datasetIndex:m,index:_})}return evaluateInteractionItems(i,e,t,c),a}function getNearestItems(i,t,e,s,n,r){return!r&&!i.isPointInArea(t)?[]:e==="r"&&!s?getNearestRadialItems(i,t,e,n):getNearestCartesianItems(i,t,e,s,n,r)}function getAxisItems(i,t,e,s,n){const r=[],a=e==="x"?"inXRange":"inYRange";let o=!1;return evaluateInteractionItems(i,e,t,(l,c,p)=>{l[a](t[e],n)&&(r.push({element:l,datasetIndex:c,index:p}),o=o||l.inRange(t.x,t.y,n))}),s&&!o?[]:r}var Interaction={evaluateInteractionItems,modes:{index(i,t,e,s){const n=getRelativePosition(t,i),r=e.axis||"x",a=e.includeInvisible||!1,o=e.intersect?getIntersectItems(i,n,r,s,a):getNearestItems(i,n,r,!1,s,a),l=[];return o.length?(i.getSortedVisibleDatasetMetas().forEach(c=>{const p=o[0].index,m=c.data[p];m&&!m.skip&&l.push({element:m,datasetIndex:c.index,index:p})}),l):[]},dataset(i,t,e,s){const n=getRelativePosition(t,i),r=e.axis||"xy",a=e.includeInvisible||!1;let o=e.intersect?getIntersectItems(i,n,r,s,a):getNearestItems(i,n,r,!1,s,a);if(o.length>0){const l=o[0].datasetIndex,c=i.getDatasetMeta(l).data;o=[];for(let p=0;p<c.length;++p)o.push({element:c[p],datasetIndex:l,index:p})}return o},point(i,t,e,s){const n=getRelativePosition(t,i),r=e.axis||"xy",a=e.includeInvisible||!1;return getIntersectItems(i,n,r,s,a)},nearest(i,t,e,s){const n=getRelativePosition(t,i),r=e.axis||"xy",a=e.includeInvisible||!1;return getNearestItems(i,n,r,e.intersect,s,a)},x(i,t,e,s){const n=getRelativePosition(t,i);return getAxisItems(i,n,"x",e.intersect,s)},y(i,t,e,s){const n=getRelativePosition(t,i);return getAxisItems(i,n,"y",e.intersect,s)}}};const STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(i,t){return i.filter(e=>e.pos===t)}function filterDynamicPositionByAxis(i,t){return i.filter(e=>STATIC_POSITIONS.indexOf(e.pos)===-1&&e.box.axis===t)}function sortByWeight(i,t){return i.sort((e,s)=>{const n=t?s:e,r=t?e:s;return n.weight===r.weight?n.index-r.index:n.weight-r.weight})}function wrapBoxes(i){const t=[];let e,s,n,r,a,o;for(e=0,s=(i||[]).length;e<s;++e)n=i[e],{position:r,options:{stack:a,stackWeight:o=1}}=n,t.push({index:e,box:n,pos:r,horizontal:n.isHorizontal(),weight:n.weight,stack:a&&r+a,stackWeight:o});return t}function buildStacks(i){const t={};for(const e of i){const{stack:s,pos:n,stackWeight:r}=e;if(!s||!STATIC_POSITIONS.includes(n))continue;const a=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=r}return t}function setLayoutDims(i,t){const e=buildStacks(i),{vBoxMaxWidth:s,hBoxMaxHeight:n}=t;let r,a,o;for(r=0,a=i.length;r<a;++r){o=i[r];const{fullSize:l}=o.box,c=e[o.stack],p=c&&o.stackWeight/c.weight;o.horizontal?(o.width=p?p*s:l&&t.availableWidth,o.height=n):(o.width=s,o.height=p?p*n:l&&t.availableHeight)}return e}function buildLayoutBoxes(i){const t=wrapBoxes(i),e=sortByWeight(t.filter(c=>c.box.fullSize),!0),s=sortByWeight(filterByPosition(t,"left"),!0),n=sortByWeight(filterByPosition(t,"right")),r=sortByWeight(filterByPosition(t,"top"),!0),a=sortByWeight(filterByPosition(t,"bottom")),o=filterDynamicPositionByAxis(t,"x"),l=filterDynamicPositionByAxis(t,"y");return{fullSize:e,leftAndTop:s.concat(r),rightAndBottom:n.concat(l).concat(a).concat(o),chartArea:filterByPosition(t,"chartArea"),vertical:s.concat(n).concat(l),horizontal:r.concat(a).concat(o)}}function getCombinedMax(i,t,e,s){return Math.max(i[e],t[e])+Math.max(i[s],t[s])}function updateMaxPadding(i,t){i.top=Math.max(i.top,t.top),i.left=Math.max(i.left,t.left),i.bottom=Math.max(i.bottom,t.bottom),i.right=Math.max(i.right,t.right)}function updateDims(i,t,e,s){const{pos:n,box:r}=e,a=i.maxPadding;if(!isObject(n)){e.size&&(i[n]-=e.size);const m=s[e.stack]||{size:0,count:1};m.size=Math.max(m.size,e.horizontal?r.height:r.width),e.size=m.size/m.count,i[n]+=e.size}r.getPadding&&updateMaxPadding(a,r.getPadding());const o=Math.max(0,t.outerWidth-getCombinedMax(a,i,"left","right")),l=Math.max(0,t.outerHeight-getCombinedMax(a,i,"top","bottom")),c=o!==i.w,p=l!==i.h;return i.w=o,i.h=l,e.horizontal?{same:c,other:p}:{same:p,other:c}}function handleMaxPadding(i){const t=i.maxPadding;function e(s){const n=Math.max(t[s]-i[s],0);return i[s]+=n,n}i.y+=e("top"),i.x+=e("left"),e("right"),e("bottom")}function getMargins(i,t){const e=t.maxPadding;function s(n){const r={left:0,top:0,right:0,bottom:0};return n.forEach(a=>{r[a]=Math.max(t[a],e[a])}),r}return s(i?["left","right"]:["top","bottom"])}function fitBoxes(i,t,e,s){const n=[];let r,a,o,l,c,p;for(r=0,a=i.length,c=0;r<a;++r){o=i[r],l=o.box,l.update(o.width||t.w,o.height||t.h,getMargins(o.horizontal,t));const{same:m,other:_}=updateDims(t,e,o,s);c|=m&&n.length,p=p||_,l.fullSize||n.push(o)}return c&&fitBoxes(n,t,e,s)||p}function setBoxDims(i,t,e,s,n){i.top=e,i.left=t,i.right=t+s,i.bottom=e+n,i.width=s,i.height=n}function placeBoxes(i,t,e,s){const n=e.padding;let{x:r,y:a}=t;for(const o of i){const l=o.box,c=s[o.stack]||{count:1,placed:0,weight:1},p=o.stackWeight/c.weight||1;if(o.horizontal){const m=t.w*p,_=c.size||l.height;defined(c.start)&&(a=c.start),l.fullSize?setBoxDims(l,n.left,a,e.outerWidth-n.right-n.left,_):setBoxDims(l,t.left+c.placed,a,m,_),c.start=a,c.placed+=m,a=l.bottom}else{const m=t.h*p,_=c.size||l.width;defined(c.start)&&(r=c.start),l.fullSize?setBoxDims(l,r,n.top,_,e.outerHeight-n.bottom-n.top):setBoxDims(l,r,t.top+c.placed,_,m),c.start=r,c.placed+=m,r=l.right}}t.x=r,t.y=a}var layouts={addBox(i,t){i.boxes||(i.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},i.boxes.push(t)},removeBox(i,t){const e=i.boxes?i.boxes.indexOf(t):-1;e!==-1&&i.boxes.splice(e,1)},configure(i,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(i,t,e,s){if(!i)return;const n=toPadding(i.options.layout.padding),r=Math.max(t-n.width,0),a=Math.max(e-n.height,0),o=buildLayoutBoxes(i.boxes),l=o.vertical,c=o.horizontal;each(i.boxes,u=>{typeof u.beforeLayout=="function"&&u.beforeLayout()});const p=l.reduce((u,g)=>g.box.options&&g.box.options.display===!1?u:u+1,0)||1,m=Object.freeze({outerWidth:t,outerHeight:e,padding:n,availableWidth:r,availableHeight:a,vBoxMaxWidth:r/2/p,hBoxMaxHeight:a/2}),_=Object.assign({},n);updateMaxPadding(_,toPadding(s));const y=Object.assign({maxPadding:_,w:r,h:a,x:n.left,y:n.top},n),b=setLayoutDims(l.concat(c),m);fitBoxes(o.fullSize,y,m,b),fitBoxes(l,y,m,b),fitBoxes(c,y,m,b)&&fitBoxes(l,y,m,b),handleMaxPadding(y),placeBoxes(o.leftAndTop,y,m,b),y.x+=y.w,y.y+=y.h,placeBoxes(o.rightAndBottom,y,m,b),i.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},each(o.chartArea,u=>{const g=u.box;Object.assign(g,i.chartArea),g.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class BasePlatform{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,s){}removeEventListener(t,e,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,s,n){return e=Math.max(0,e||t.width),s=s||t.height,{width:e,height:Math.max(0,n?Math.floor(e/n):s)}}isAttached(t){return!0}updateConfig(t){}}class BasicPlatform extends BasePlatform{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=i=>i===null||i==="";function initCanvas(i,t){const e=i.style,s=i.getAttribute("height"),n=i.getAttribute("width");if(i[EXPANDO_KEY]={initial:{height:s,width:n,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",isNullOrEmpty(n)){const r=readUsedSize(i,"width");r!==void 0&&(i.width=r)}if(isNullOrEmpty(s))if(i.style.height==="")i.height=i.width/(t||2);else{const r=readUsedSize(i,"height");r!==void 0&&(i.height=r)}return i}const eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(i,t,e){i.addEventListener(t,e,eventListenerOptions)}function removeListener(i,t,e){i.canvas.removeEventListener(t,e,eventListenerOptions)}function fromNativeEvent(i,t){const e=EVENT_TYPES[i.type]||i.type,{x:s,y:n}=getRelativePosition(i,t);return{type:e,chart:t,native:i,x:s!==void 0?s:null,y:n!==void 0?n:null}}function nodeListContains(i,t){for(const e of i)if(e===t||e.contains(t))return!0}function createAttachObserver(i,t,e){const s=i.canvas,n=new MutationObserver(r=>{let a=!1;for(const o of r)a=a||nodeListContains(o.addedNodes,s),a=a&&!nodeListContains(o.removedNodes,s);a&&e()});return n.observe(document,{childList:!0,subtree:!0}),n}function createDetachObserver(i,t,e){const s=i.canvas,n=new MutationObserver(r=>{let a=!1;for(const o of r)a=a||nodeListContains(o.removedNodes,s),a=a&&!nodeListContains(o.addedNodes,s);a&&e()});return n.observe(document,{childList:!0,subtree:!0}),n}const drpListeningCharts=new Map;let oldDevicePixelRatio=0;function onWindowResize(){const i=window.devicePixelRatio;i!==oldDevicePixelRatio&&(oldDevicePixelRatio=i,drpListeningCharts.forEach((t,e)=>{e.currentDevicePixelRatio!==i&&t()}))}function listenDevicePixelRatioChanges(i,t){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(i,t)}function unlistenDevicePixelRatioChanges(i){drpListeningCharts.delete(i),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(i,t,e){const s=i.canvas,n=s&&_getParentNode(s);if(!n)return;const r=throttled((o,l)=>{const c=n.clientWidth;e(o,l),c<n.clientWidth&&e()},window),a=new ResizeObserver(o=>{const l=o[0],c=l.contentRect.width,p=l.contentRect.height;c===0&&p===0||r(c,p)});return a.observe(n),listenDevicePixelRatioChanges(i,r),a}function releaseObserver(i,t,e){e&&e.disconnect(),t==="resize"&&unlistenDevicePixelRatioChanges(i)}function createProxyAndListen(i,t,e){const s=i.canvas,n=throttled(r=>{i.ctx!==null&&e(fromNativeEvent(r,i))},i);return addListener(s,t,n),n}class DomPlatform extends BasePlatform{acquireContext(t,e){const s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(initCanvas(t,e),s):null}releaseContext(t){const e=t.canvas;if(!e[EXPANDO_KEY])return!1;const s=e[EXPANDO_KEY].initial;["height","width"].forEach(r=>{const a=s[r];isNullOrUndef(a)?e.removeAttribute(r):e.setAttribute(r,a)});const n=s.style||{};return Object.keys(n).forEach(r=>{e.style[r]=n[r]}),e.width=e.width,delete e[EXPANDO_KEY],!0}addEventListener(t,e,s){this.removeEventListener(t,e);const n=t.$proxies||(t.$proxies={}),a={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[e]||createProxyAndListen;n[e]=a(t,e,s)}removeEventListener(t,e){const s=t.$proxies||(t.$proxies={}),n=s[e];if(!n)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[e]||removeListener)(t,e,n),s[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,s,n){return getMaximumSize(t,e,s,n)}isAttached(t){const e=_getParentNode(t);return!!(e&&e.isConnected)}}function _detectPlatform(i){return!_isDomSupported()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?BasicPlatform:DomPlatform}class Element{constructor(){ft(this,"x");ft(this,"y");ft(this,"active",!1);ft(this,"options");ft(this,"$animations")}tooltipPosition(t){const{x:e,y:s}=this.getProps(["x","y"],t);return{x:e,y:s}}hasValue(){return isNumber(this.x)&&isNumber(this.y)}getProps(t,e){const s=this.$animations;if(!e||!s)return this;const n={};return t.forEach(r=>{n[r]=s[r]&&s[r].active()?s[r]._to:this[r]}),n}}ft(Element,"defaults",{}),ft(Element,"defaultRoutes");function autoSkip(i,t){const e=i.options.ticks,s=determineMaxTicks(i),n=Math.min(e.maxTicksLimit||s,s),r=e.major.enabled?getMajorIndices(t):[],a=r.length,o=r[0],l=r[a-1],c=[];if(a>n)return skipMajors(t,c,r,a/n),c;const p=calculateSpacing(r,t,n);if(a>0){let m,_;const y=a>1?Math.round((l-o)/(a-1)):null;for(skip(t,c,p,isNullOrUndef(y)?0:o-y,o),m=0,_=a-1;m<_;m++)skip(t,c,p,r[m],r[m+1]);return skip(t,c,p,l,isNullOrUndef(y)?t.length:l+y),c}return skip(t,c,p),c}function determineMaxTicks(i){const t=i.options.offset,e=i._tickSize(),s=i._length/e+(t?0:1),n=i._maxLength/e;return Math.floor(Math.min(s,n))}function calculateSpacing(i,t,e){const s=getEvenSpacing(i),n=t.length/e;if(!s)return Math.max(n,1);const r=_factorize(s);for(let a=0,o=r.length-1;a<o;a++){const l=r[a];if(l>n)return l}return Math.max(n,1)}function getMajorIndices(i){const t=[];let e,s;for(e=0,s=i.length;e<s;e++)i[e].major&&t.push(e);return t}function skipMajors(i,t,e,s){let n=0,r=e[0],a;for(s=Math.ceil(s),a=0;a<i.length;a++)a===r&&(t.push(i[a]),n++,r=e[n*s])}function skip(i,t,e,s,n){const r=valueOrDefault(s,0),a=Math.min(valueOrDefault(n,i.length),i.length);let o=0,l,c,p;for(e=Math.ceil(e),n&&(l=n-s,e=l/Math.floor(l/e)),p=r;p<0;)o++,p=Math.round(r+o*e);for(c=Math.max(r,0);c<a;c++)c===p&&(t.push(i[c]),o++,p=Math.round(r+o*e))}function getEvenSpacing(i){const t=i.length;let e,s;if(t<2)return!1;for(s=i[0],e=1;e<t;++e)if(i[e]-i[e-1]!==s)return!1;return s}const reverseAlign=i=>i==="left"?"right":i==="right"?"left":i,offsetFromEdge=(i,t,e)=>t==="top"||t==="left"?i[t]+e:i[t]-e,getTicksLimit=(i,t)=>Math.min(t||i,i);function sample(i,t){const e=[],s=i.length/t,n=i.length;let r=0;for(;r<n;r+=s)e.push(i[Math.floor(r)]);return e}function getPixelForGridLine(i,t,e){const s=i.ticks.length,n=Math.min(t,s-1),r=i._startPixel,a=i._endPixel,o=1e-6;let l=i.getPixelForTick(n),c;if(!(e&&(s===1?c=Math.max(l-r,a-l):t===0?c=(i.getPixelForTick(1)-l)/2:c=(l-i.getPixelForTick(n-1))/2,l+=n<t?c:-c,l<r-o||l>a+o)))return l}function garbageCollect(i,t){each(i,e=>{const s=e.gc,n=s.length/2;let r;if(n>t){for(r=0;r<n;++r)delete e.data[s[r]];s.splice(0,n)}})}function getTickMarkLength(i){return i.drawTicks?i.tickLength:0}function getTitleHeight(i,t){if(!i.display)return 0;const e=toFont(i.font,t),s=toPadding(i.padding);return(isArray(i.text)?i.text.length:1)*e.lineHeight+s.height}function createScaleContext(i,t){return createContext(i,{scale:t,type:"scale"})}function createTickContext(i,t,e){return createContext(i,{tick:e,index:t,type:"tick"})}function titleAlign(i,t,e){let s=_toLeftRightCenter(i);return(e&&t!=="right"||!e&&t==="right")&&(s=reverseAlign(s)),s}function titleArgs(i,t,e,s){const{top:n,left:r,bottom:a,right:o,chart:l}=i,{chartArea:c,scales:p}=l;let m=0,_,y,b;const u=a-n,g=o-r;if(i.isHorizontal()){if(y=_alignStartEnd(s,r,o),isObject(e)){const x=Object.keys(e)[0],P=e[x];b=p[x].getPixelForValue(P)+u-t}else e==="center"?b=(c.bottom+c.top)/2+u-t:b=offsetFromEdge(i,e,t);_=o-r}else{if(isObject(e)){const x=Object.keys(e)[0],P=e[x];y=p[x].getPixelForValue(P)-g+t}else e==="center"?y=(c.left+c.right)/2-g+t:y=offsetFromEdge(i,e,t);b=_alignStartEnd(s,a,n),m=e==="left"?-HALF_PI:HALF_PI}return{titleX:y,titleY:b,maxWidth:_,rotation:m}}class Scale extends Element{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:s,_suggestedMax:n}=this;return t=finiteOrDefault(t,Number.POSITIVE_INFINITY),e=finiteOrDefault(e,Number.NEGATIVE_INFINITY),s=finiteOrDefault(s,Number.POSITIVE_INFINITY),n=finiteOrDefault(n,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(t,s),max:finiteOrDefault(e,n),minDefined:isNumberFinite(t),maxDefined:isNumberFinite(e)}}getMinMax(t){let{min:e,max:s,minDefined:n,maxDefined:r}=this.getUserBounds(),a;if(n&&r)return{min:e,max:s};const o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)a=o[l].controller.getMinMax(this,t),n||(e=Math.min(e,a.min)),r||(s=Math.max(s,a.max));return e=r&&e>s?s:e,s=n&&e>s?e:s,{min:finiteOrDefault(e,finiteOrDefault(s,e)),max:finiteOrDefault(s,finiteOrDefault(e,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(t,e,s){const{beginAtZero:n,grace:r,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_addGrace(this,r,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?sample(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=autoSkip(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,s;this.isHorizontal()?(e=this.left,s=this.right):(e=this.top,s=this.bottom,t=!t),this._startPixel=e,this._endPixel=s,this._reversePixels=t,this._length=s-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),callback(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let s,n,r;for(s=0,n=t.length;s<n;s++)r=t[s],r.label=callback(e.callback,[r.value,s,t],this)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,s=getTicksLimit(this.ticks.length,t.ticks.maxTicksLimit),n=e.minRotation||0,r=e.maxRotation;let a=n,o,l,c;if(!this._isVisible()||!e.display||n>=r||s<=1||!this.isHorizontal()){this.labelRotation=n;return}const p=this._getLabelSizes(),m=p.widest.width,_=p.highest.height,y=_limitValue(this.chart.width-m,0,this.maxWidth);o=t.offset?this.maxWidth/s:y/(s-1),m+6>o&&(o=y/(s-(t.offset?.5:1)),l=this.maxHeight-getTickMarkLength(t.grid)-e.padding-getTitleHeight(t.title,this.chart.options.font),c=Math.sqrt(m*m+_*_),a=toDegrees(Math.min(Math.asin(_limitValue((p.highest.height+6)/o,-1,1)),Math.asin(_limitValue(l/c,-1,1))-Math.asin(_limitValue(_/c,-1,1)))),a=Math.max(n,Math.min(r,a))),this.labelRotation=a}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:s,title:n,grid:r}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=getTitleHeight(n,e.options.font);if(o?(t.width=this.maxWidth,t.height=getTickMarkLength(r)+l):(t.height=this.maxHeight,t.width=getTickMarkLength(r)+l),s.display&&this.ticks.length){const{first:c,last:p,widest:m,highest:_}=this._getLabelSizes(),y=s.padding*2,b=toRadians(this.labelRotation),u=Math.cos(b),g=Math.sin(b);if(o){const x=s.mirror?0:g*m.width+u*_.height;t.height=Math.min(this.maxHeight,t.height+x+y)}else{const x=s.mirror?0:u*m.width+g*_.height;t.width=Math.min(this.maxWidth,t.width+x+y)}this._calculatePadding(c,p,g,u)}}this._handleMargins(),o?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,s,n){const{ticks:{align:r,padding:a},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const p=this.getPixelForTick(0)-this.left,m=this.right-this.getPixelForTick(this.ticks.length-1);let _=0,y=0;l?c?(_=n*t.width,y=s*e.height):(_=s*t.height,y=n*e.width):r==="start"?y=e.width:r==="end"?_=t.width:r!=="inner"&&(_=t.width/2,y=e.width/2),this.paddingLeft=Math.max((_-p+a)*this.width/(this.width-p),0),this.paddingRight=Math.max((y-m+a)*this.width/(this.width-m),0)}else{let p=e.height/2,m=t.height/2;r==="start"?(p=0,m=t.height):r==="end"&&(p=e.height,m=0),this.paddingTop=p+a,this.paddingBottom=m+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,s;for(e=0,s=t.length;e<s;e++)isNullOrUndef(t[e].label)&&(t.splice(e,1),s--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let s=this.ticks;e<s.length&&(s=sample(s,e)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,s){const{ctx:n,_longestTextCache:r}=this,a=[],o=[],l=Math.floor(e/getTicksLimit(e,s));let c=0,p=0,m,_,y,b,u,g,x,P,A,h,d;for(m=0;m<e;m+=l){if(b=t[m].label,u=this._resolveTickFontOptions(m),n.font=g=u.string,x=r[g]=r[g]||{data:{},gc:[]},P=u.lineHeight,A=h=0,!isNullOrUndef(b)&&!isArray(b))A=_measureText(n,x.data,x.gc,A,b),h=P;else if(isArray(b))for(_=0,y=b.length;_<y;++_)d=b[_],!isNullOrUndef(d)&&!isArray(d)&&(A=_measureText(n,x.data,x.gc,A,d),h+=P);a.push(A),o.push(h),c=Math.max(A,c),p=Math.max(h,p)}garbageCollect(r,e);const f=a.indexOf(c),v=o.indexOf(p),w=C=>({width:a[C]||0,height:o[C]||0});return{first:w(0),last:w(e-1),widest:w(f),highest:w(v),widths:a,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return _int16Range(this._alignToPixels?_alignPixel(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const s=e[t];return s.$context||(s.$context=createTickContext(this.getContext(),t,s))}return this.$context||(this.$context=createScaleContext(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=toRadians(this.labelRotation),s=Math.abs(Math.cos(e)),n=Math.abs(Math.sin(e)),r=this._getLabelSizes(),a=t.autoSkipPadding||0,o=r?r.widest.width+a:0,l=r?r.highest.height+a:0;return this.isHorizontal()?l*s>o*n?o/s:l/n:l*n<o*s?l/s:o/n}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,s=this.chart,n=this.options,{grid:r,position:a,border:o}=n,l=r.offset,c=this.isHorizontal(),m=this.ticks.length+(l?1:0),_=getTickMarkLength(r),y=[],b=o.setContext(this.getContext()),u=b.display?b.width:0,g=u/2,x=function(W){return _alignPixel(s,W,u)};let P,A,h,d,f,v,w,C,k,R,H,Z;if(a==="top")P=x(this.bottom),v=this.bottom-_,C=P-g,R=x(t.top)+g,Z=t.bottom;else if(a==="bottom")P=x(this.top),R=t.top,Z=x(t.bottom)-g,v=P+g,C=this.top+_;else if(a==="left")P=x(this.right),f=this.right-_,w=P-g,k=x(t.left)+g,H=t.right;else if(a==="right")P=x(this.left),k=t.left,H=x(t.right)-g,f=P+g,w=this.left+_;else if(e==="x"){if(a==="center")P=x((t.top+t.bottom)/2+.5);else if(isObject(a)){const W=Object.keys(a)[0],$=a[W];P=x(this.chart.scales[W].getPixelForValue($))}R=t.top,Z=t.bottom,v=P+g,C=v+_}else if(e==="y"){if(a==="center")P=x((t.left+t.right)/2);else if(isObject(a)){const W=Object.keys(a)[0],$=a[W];P=x(this.chart.scales[W].getPixelForValue($))}f=P-g,w=f-_,k=t.left,H=t.right}const K=valueOrDefault(n.ticks.maxTicksLimit,m),q=Math.max(1,Math.ceil(m/K));for(A=0;A<m;A+=q){const W=this.getContext(A),$=r.setContext(W),X=o.setContext(W),it=$.lineWidth,lt=$.color,_t=X.dash||[],z=X.dashOffset,E=$.tickWidth,T=$.tickColor,O=$.tickBorderDash||[],N=$.tickBorderDashOffset;h=getPixelForGridLine(this,A,l),h!==void 0&&(d=_alignPixel(s,h,it),c?f=w=k=H=d:v=C=R=Z=d,y.push({tx1:f,ty1:v,tx2:w,ty2:C,x1:k,y1:R,x2:H,y2:Z,width:it,color:lt,borderDash:_t,borderDashOffset:z,tickWidth:E,tickColor:T,tickBorderDash:O,tickBorderDashOffset:N}))}return this._ticksLength=m,this._borderValue=P,y}_computeLabelItems(t){const e=this.axis,s=this.options,{position:n,ticks:r}=s,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:p,mirror:m}=r,_=getTickMarkLength(s.grid),y=_+p,b=m?-p:y,u=-toRadians(this.labelRotation),g=[];let x,P,A,h,d,f,v,w,C,k,R,H,Z="middle";if(n==="top")f=this.bottom-b,v=this._getXAxisLabelAlignment();else if(n==="bottom")f=this.top+b,v=this._getXAxisLabelAlignment();else if(n==="left"){const q=this._getYAxisLabelAlignment(_);v=q.textAlign,d=q.x}else if(n==="right"){const q=this._getYAxisLabelAlignment(_);v=q.textAlign,d=q.x}else if(e==="x"){if(n==="center")f=(t.top+t.bottom)/2+y;else if(isObject(n)){const q=Object.keys(n)[0],W=n[q];f=this.chart.scales[q].getPixelForValue(W)+y}v=this._getXAxisLabelAlignment()}else if(e==="y"){if(n==="center")d=(t.left+t.right)/2-y;else if(isObject(n)){const q=Object.keys(n)[0],W=n[q];d=this.chart.scales[q].getPixelForValue(W)}v=this._getYAxisLabelAlignment(_).textAlign}e==="y"&&(l==="start"?Z="top":l==="end"&&(Z="bottom"));const K=this._getLabelSizes();for(x=0,P=o.length;x<P;++x){A=o[x],h=A.label;const q=r.setContext(this.getContext(x));w=this.getPixelForTick(x)+r.labelOffset,C=this._resolveTickFontOptions(x),k=C.lineHeight,R=isArray(h)?h.length:1;const W=R/2,$=q.color,X=q.textStrokeColor,it=q.textStrokeWidth;let lt=v;a?(d=w,v==="inner"&&(x===P-1?lt=this.options.reverse?"left":"right":x===0?lt=this.options.reverse?"right":"left":lt="center"),n==="top"?c==="near"||u!==0?H=-R*k+k/2:c==="center"?H=-K.highest.height/2-W*k+k:H=-K.highest.height+k/2:c==="near"||u!==0?H=k/2:c==="center"?H=K.highest.height/2-W*k:H=K.highest.height-R*k,m&&(H*=-1),u!==0&&!q.showLabelBackdrop&&(d+=k/2*Math.sin(u))):(f=w,H=(1-R)*k/2);let _t;if(q.showLabelBackdrop){const z=toPadding(q.backdropPadding),E=K.heights[x],T=K.widths[x];let O=H-z.top,N=0-z.left;switch(Z){case"middle":O-=E/2;break;case"bottom":O-=E;break}switch(v){case"center":N-=T/2;break;case"right":N-=T;break}_t={left:N,top:O,width:T+z.width,height:E+z.height,color:q.backdropColor}}g.push({label:h,font:C,textOffset:H,options:{rotation:u,color:$,strokeColor:X,strokeWidth:it,textAlign:lt,textBaseline:Z,translation:[d,f],backdrop:_t}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-toRadians(this.labelRotation))return t==="top"?"left":"right";let n="center";return e.align==="start"?n="left":e.align==="end"?n="right":e.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:s,mirror:n,padding:r}}=this.options,a=this._getLabelSizes(),o=t+r,l=a.widest.width;let c,p;return e==="left"?n?(p=this.right+r,s==="near"?c="left":s==="center"?(c="center",p+=l/2):(c="right",p+=l)):(p=this.right-o,s==="near"?c="right":s==="center"?(c="center",p-=l/2):(c="left",p=this.left)):e==="right"?n?(p=this.left+r,s==="near"?c="right":s==="center"?(c="center",p-=l/2):(c="left",p-=l)):(p=this.left+o,s==="near"?c="left":s==="center"?(c="center",p+=l/2):(c="right",p=this.right)):c="right",{textAlign:c,x:p}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:s,top:n,width:r,height:a}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(s,n,r,a),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks.findIndex(r=>r.value===t);return n>=0?e.setContext(this.getContext(n)).lineWidth:0}drawGrid(t){const e=this.options.grid,s=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,a;const o=(l,c,p)=>{!p.width||!p.color||(s.save(),s.lineWidth=p.width,s.strokeStyle=p.color,s.setLineDash(p.borderDash||[]),s.lineDashOffset=p.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(e.display)for(r=0,a=n.length;r<a;++r){const l=n[r];e.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:s,grid:n}}=this,r=s.setContext(this.getContext()),a=s.display?r.width:0;if(!a)return;const o=n.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,p,m,_;this.isHorizontal()?(c=_alignPixel(t,this.left,a)-a/2,p=_alignPixel(t,this.right,o)+o/2,m=_=l):(m=_alignPixel(t,this.top,a)-a/2,_=_alignPixel(t,this.bottom,o)+o/2,c=p=l),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(c,m),e.lineTo(p,_),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const s=this.ctx,n=this._computeLabelArea();n&&clipArea(s,n);const r=this.getLabelItems(t);for(const a of r){const o=a.options,l=a.font,c=a.label,p=a.textOffset;renderText(s,c,0,p,l,o)}n&&unclipArea(s)}drawTitle(){const{ctx:t,options:{position:e,title:s,reverse:n}}=this;if(!s.display)return;const r=toFont(s.font),a=toPadding(s.padding),o=s.align;let l=r.lineHeight/2;e==="bottom"||e==="center"||isObject(e)?(l+=a.bottom,isArray(s.text)&&(l+=r.lineHeight*(s.text.length-1))):l+=a.top;const{titleX:c,titleY:p,maxWidth:m,rotation:_}=titleArgs(this,l,e,o);renderText(t,s.text,0,0,r,{color:s.color,maxWidth:m,rotation:_,textAlign:titleAlign(o,e,n),textBaseline:"middle",translation:[c,p]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,s=valueOrDefault(t.grid&&t.grid.z,-1),n=valueOrDefault(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Scale.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:s,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",n=[];let r,a;for(r=0,a=e.length;r<a;++r){const o=e[r];o[s]===this.id&&(!t||o.type===t)&&n.push(o)}return n}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return toFont(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class TypedRegistry{constructor(t,e,s){this.type=t,this.scope=e,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let s;isIChartComponent(e)&&(s=this.register(e));const n=this.items,r=t.id,a=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in n||(n[r]=t,registerDefaults(t,a,s),this.override&&defaults.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const e=this.items,s=t.id,n=this.scope;s in e&&delete e[s],n&&s in defaults[n]&&(delete defaults[n][s],this.override&&delete overrides[s])}}function registerDefaults(i,t,e){const s=merge(Object.create(null),[e?defaults.get(e):{},defaults.get(t),i.defaults]);defaults.set(t,s),i.defaultRoutes&&routeDefaults(t,i.defaultRoutes),i.descriptors&&defaults.describe(t,i.descriptors)}function routeDefaults(i,t){Object.keys(t).forEach(e=>{const s=e.split("."),n=s.pop(),r=[i].concat(s).join("."),a=t[e].split("."),o=a.pop(),l=a.join(".");defaults.route(r,n,l,o)})}function isIChartComponent(i){return"id"in i&&"defaults"in i}class Registry{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,s){[...e].forEach(n=>{const r=s||this._getRegistryForType(n);s||r.isForType(n)||r===this.plugins&&n.id?this._exec(t,r,n):each(n,a=>{const o=s||this._getRegistryForType(a);this._exec(t,o,a)})})}_exec(t,e,s){const n=_capitalize(t);callback(s["before"+n],[],s),e[t](s),callback(s["after"+n],[],s)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const s=this._typedRegistries[e];if(s.isForType(t))return s}return this.plugins}_get(t,e,s){const n=e.get(t);if(n===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return n}}var registry=new Registry;class PluginService{constructor(){this._init=[]}notify(t,e,s,n){e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const r=n?this._descriptors(t).filter(n):this._descriptors(t),a=this._notify(r,t,e,s);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall")),a}_notify(t,e,s,n){n=n||{};for(const r of t){const a=r.plugin,o=a[s],l=[e,n,r.options];if(callback(o,l,a)===!1&&n.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const s=t&&t.config,n=valueOrDefault(s.options&&s.options.plugins,{}),r=allPlugins(s);return n===!1&&!e?[]:createDescriptors(t,r,n,e)}_notifyStateChanges(t){const e=this._oldCache||[],s=this._cache,n=(r,a)=>r.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(n(e,s),t,"stop"),this._notify(n(s,e),t,"start")}}function allPlugins(i){const t={},e=[],s=Object.keys(registry.plugins.items);for(let r=0;r<s.length;r++)e.push(registry.getPlugin(s[r]));const n=i.plugins||[];for(let r=0;r<n.length;r++){const a=n[r];e.indexOf(a)===-1&&(e.push(a),t[a.id]=!0)}return{plugins:e,localIds:t}}function getOpts(i,t){return!t&&i===!1?null:i===!0?{}:i}function createDescriptors(i,{plugins:t,localIds:e},s,n){const r=[],a=i.getContext();for(const o of t){const l=o.id,c=getOpts(s[l],n);c!==null&&r.push({plugin:o,options:pluginOpts(i.config,{plugin:o,local:e[l]},c,a)})}return r}function pluginOpts(i,{plugin:t,local:e},s,n){const r=i.pluginScopeKeys(t),a=i.getOptionScopes(s,r);return e&&t.defaults&&a.push(t.defaults),i.createResolver(a,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(i,t){const e=defaults.datasets[i]||{};return((t.datasets||{})[i]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function getAxisFromDefaultScaleID(i,t){let e=i;return i==="_index_"?e=t:i==="_value_"&&(e=t==="x"?"y":"x"),e}function getDefaultScaleIDFromAxis(i,t){return i===t?"_index_":"_value_"}function idMatchesAxis(i){if(i==="x"||i==="y"||i==="r")return i}function axisFromPosition(i){if(i==="top"||i==="bottom")return"x";if(i==="left"||i==="right")return"y"}function determineAxis(i,...t){if(idMatchesAxis(i))return i;for(const e of t){const s=e.axis||axisFromPosition(e.position)||i.length>1&&idMatchesAxis(i[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${i}' axis. Please provide 'axis' or 'position' option.`)}function getAxisFromDataset(i,t,e){if(e[t+"AxisID"]===i)return{axis:t}}function retrieveAxisFromDatasets(i,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(s=>s.xAxisID===i||s.yAxisID===i);if(e.length)return getAxisFromDataset(i,"x",e[0])||getAxisFromDataset(i,"y",e[0])}return{}}function mergeScaleConfig(i,t){const e=overrides[i.type]||{scales:{}},s=t.scales||{},n=getIndexAxis(i.type,t),r=Object.create(null);return Object.keys(s).forEach(a=>{const o=s[a];if(!isObject(o))return console.error(`Invalid scale configuration for scale: ${a}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${a}`);const l=determineAxis(a,o,retrieveAxisFromDatasets(a,i),defaults.scales[o.type]),c=getDefaultScaleIDFromAxis(l,n),p=e.scales||{};r[a]=mergeIf(Object.create(null),[{axis:l},o,p[l],p[c]])}),i.data.datasets.forEach(a=>{const o=a.type||i.type,l=a.indexAxis||getIndexAxis(o,t),p=(overrides[o]||{}).scales||{};Object.keys(p).forEach(m=>{const _=getAxisFromDefaultScaleID(m,l),y=a[_+"AxisID"]||_;r[y]=r[y]||Object.create(null),mergeIf(r[y],[{axis:_},s[y],p[m]])})}),Object.keys(r).forEach(a=>{const o=r[a];mergeIf(o,[defaults.scales[o.type],defaults.scale])}),r}function initOptions(i){const t=i.options||(i.options={});t.plugins=valueOrDefault(t.plugins,{}),t.scales=mergeScaleConfig(i,t)}function initData(i){return i=i||{},i.datasets=i.datasets||[],i.labels=i.labels||[],i}function initConfig(i){return i=i||{},i.data=initData(i.data),initOptions(i),i}const keyCache=new Map,keysCached=new Set;function cachedKeys(i,t){let e=keyCache.get(i);return e||(e=t(),keyCache.set(i,e),keysCached.add(e)),e}const addIfFound=(i,t,e)=>{const s=resolveObjectKey(t,e);s!==void 0&&i.add(s)};class Config{constructor(t){this._config=initConfig(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=initData(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),initOptions(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return cachedKeys(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return cachedKeys(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return cachedKeys(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,s=this.type;return cachedKeys(`${s}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const s=this._scopeCache;let n=s.get(t);return(!n||e)&&(n=new Map,s.set(t,n)),n}getOptionScopes(t,e,s){const{options:n,type:r}=this,a=this._cachedScopes(t,s),o=a.get(e);if(o)return o;const l=new Set;e.forEach(p=>{t&&(l.add(t),p.forEach(m=>addIfFound(l,t,m))),p.forEach(m=>addIfFound(l,n,m)),p.forEach(m=>addIfFound(l,overrides[r]||{},m)),p.forEach(m=>addIfFound(l,defaults,m)),p.forEach(m=>addIfFound(l,descriptors,m))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),keysCached.has(e)&&a.set(e,c),c}chartOptionScopes(){const{options:t,type:e}=this;return[t,overrides[e]||{},defaults.datasets[e]||{},{type:e},defaults,descriptors]}resolveNamedOptions(t,e,s,n=[""]){const r={$shared:!0},{resolver:a,subPrefixes:o}=getResolver(this._resolverCache,t,n);let l=a;if(needContext(a,e)){r.$shared=!1,s=isFunction(s)?s():s;const c=this.createResolver(t,s,o);l=_attachContext(a,s,c)}for(const c of e)r[c]=l[c];return r}createResolver(t,e,s=[""],n){const{resolver:r}=getResolver(this._resolverCache,t,s);return isObject(e)?_attachContext(r,e,void 0,n):r}}function getResolver(i,t,e){let s=i.get(t);s||(s=new Map,i.set(t,s));const n=e.join();let r=s.get(n);return r||(r={resolver:_createResolver(t,e),subPrefixes:e.filter(o=>!o.toLowerCase().includes("hover"))},s.set(n,r)),r}const hasFunction=i=>isObject(i)&&Object.getOwnPropertyNames(i).reduce((t,e)=>t||isFunction(i[e]),!1);function needContext(i,t){const{isScriptable:e,isIndexable:s}=_descriptors(i);for(const n of t){const r=e(n),a=s(n),o=(a||r)&&i[n];if(r&&(isFunction(o)||hasFunction(o))||a&&isArray(o))return!0}return!1}var version="4.4.0";const KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(i,t){return i==="top"||i==="bottom"||KNOWN_POSITIONS.indexOf(i)===-1&&t==="x"}function compare2Level(i,t){return function(e,s){return e[i]===s[i]?e[t]-s[t]:e[i]-s[i]}}function onAnimationsComplete(i){const t=i.chart,e=t.options.animation;t.notifyPlugins("afterRender"),callback(e&&e.onComplete,[i],t)}function onAnimationProgress(i){const t=i.chart,e=t.options.animation;callback(e&&e.onProgress,[i],t)}function getCanvas(i){return _isDomSupported()&&typeof i=="string"?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}const instances={},getChart=i=>{const t=getCanvas(i);return Object.values(instances).filter(e=>e.canvas===t).pop()};function moveNumericKeys(i,t,e){const s=Object.keys(i);for(const n of s){const r=+n;if(r>=t){const a=i[n];delete i[n],(e>0||r>t)&&(i[r+e]=a)}}}function determineLastEvent(i,t,e,s){return!e||i.type==="mouseout"?null:s?t:i}function getSizeForArea(i,t,e){return i.options.clip?i[e]:t[e]}function getDatasetArea(i,t){const{xScale:e,yScale:s}=i;return e&&s?{left:getSizeForArea(e,t,"left"),right:getSizeForArea(e,t,"right"),top:getSizeForArea(s,t,"top"),bottom:getSizeForArea(s,t,"bottom")}:t}class Chart{static register(...t){registry.add(...t),invalidatePlugins()}static unregister(...t){registry.remove(...t),invalidatePlugins()}constructor(t,e){const s=this.config=new Config(e),n=getCanvas(t),r=getChart(n);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const a=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||_detectPlatform(n)),this.platform.updateConfig(s);const o=this.platform.acquireContext(n,a.aspectRatio),l=o&&o.canvas,c=l&&l.height,p=l&&l.width;if(this.id=uid(),this.ctx=o,this.canvas=l,this.width=p,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce(m=>this.update(m),a.resizeDelay||0),this._dataChanges=[],instances[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(this,"complete",onAnimationsComplete),animator.listen(this,"progress",onAnimationProgress),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:s,height:n,_aspectRatio:r}=this;return isNullOrUndef(t)?e&&r?r:n?s/n:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return registry}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(t,e){animator.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const s=this.options,n=this.canvas,r=s.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(n,t,e,r),o=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,retinaScale(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),callback(s.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};each(e,(s,n)=>{s.id=n})}buildOrUpdateScales(){const t=this.options,e=t.scales,s=this.scales,n=Object.keys(s).reduce((a,o)=>(a[o]=!1,a),{});let r=[];e&&(r=r.concat(Object.keys(e).map(a=>{const o=e[a],l=determineAxis(a,o),c=l==="r",p=l==="x";return{options:o,dposition:c?"chartArea":p?"bottom":"left",dtype:c?"radialLinear":p?"category":"linear"}}))),each(r,a=>{const o=a.options,l=o.id,c=determineAxis(l,o),p=valueOrDefault(o.type,a.dtype);(o.position===void 0||positionIsHorizontal(o.position,c)!==positionIsHorizontal(a.dposition))&&(o.position=a.dposition),n[l]=!0;let m=null;if(l in s&&s[l].type===p)m=s[l];else{const _=registry.getScale(p);m=new _({id:l,type:p,ctx:this.ctx,chart:this}),s[m.id]=m}m.init(o,t)}),each(n,(a,o)=>{a||delete s[o]}),each(s,a=>{layouts.configure(this,a,a.options),layouts.addBox(this,a)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,s=t.length;if(t.sort((n,r)=>n.index-r.index),s>e){for(let n=e;n<s;++n)this._destroyDatasetMeta(n);t.splice(e,s-e)}this._sortedMetasets=t.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((s,n)=>{e.filter(r=>r===s._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let s,n;for(this._removeUnreferencedMetasets(),s=0,n=e.length;s<n;s++){const r=e[s];let a=this.getDatasetMeta(s);const o=r.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(s),a=this.getDatasetMeta(s)),a.type=o,a.indexAxis=r.indexAxis||getIndexAxis(o,this.options),a.order=r.order||0,a.index=s,a.label=""+r.label,a.visible=this.isDatasetVisible(s),a.controller)a.controller.updateIndex(s),a.controller.linkScales();else{const l=registry.getController(o),{datasetElementType:c,dataElementType:p}=defaults.datasets[o];Object.assign(l,{dataElementType:registry.getElement(p),datasetElementType:c&&registry.getElement(c)}),a.controller=new l(this,s),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){each(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const s=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,p=this.data.datasets.length;c<p;c++){const{controller:m}=this.getDatasetMeta(c),_=!n&&r.indexOf(m)===-1;m.buildOrUpdateElements(_),a=Math.max(+m.getMaxOverflow(),a)}a=this._minPadding=s.layout.autoPadding?a:0,this._updateLayout(a),n||each(r,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(compare2Level("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){each(this.scales,t=>{layouts.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),s=new Set(t.events);(!setsEqual(e,s)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:s,start:n,count:r}of e){const a=s==="_removeElements"?-r:r;moveNumericKeys(t,n,a)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,s=r=>new Set(t.filter(a=>a[0]===r).map((a,o)=>o+","+a.splice(1).join(","))),n=s(0);for(let r=1;r<e;r++)if(!setsEqual(n,s(r)))return;return Array.from(n).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(this,this.width,this.height,t);const e=this.chartArea,s=e.width<=0||e.height<=0;this._layers=[],each(this.boxes,n=>{s&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,r)=>{n._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,s=this.data.datasets.length;e<s;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,s=this.data.datasets.length;e<s;++e)this._updateDataset(e,isFunction(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const s=this.getDatasetMeta(t),n={meta:s,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(s.controller._update(e),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(this)?this.attached&&!animator.running(this)&&animator.start(this):(this.draw(),onAnimationsComplete({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:s,height:n}=this._resizeBeforeDraw;this._resize(s,n),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,s=[];let n,r;for(n=0,r=e.length;n<r;++n){const a=e[n];(!t||a.visible)&&s.push(a)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,s=t._clip,n=!s.disabled,r=getDatasetArea(t,this.chartArea),a={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(n&&clipArea(e,{left:s.left===!1?0:r.left-s.left,right:s.right===!1?this.width:r.right+s.right,top:s.top===!1?0:r.top-s.top,bottom:s.bottom===!1?this.height:r.bottom+s.bottom}),t.controller.draw(),n&&unclipArea(e),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return _isPointInArea(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,s,n){const r=Interaction.modes[e];return typeof r=="function"?r(this,t,s,n):[]}getDatasetMeta(t){const e=this.data.datasets[t],s=this._metasets;let n=s.filter(r=>r&&r._dataset===e).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},s.push(n)),n}getContext(){return this.$context||(this.$context=createContext(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const s=this.getDatasetMeta(t);return typeof s.hidden=="boolean"?!s.hidden:!e.hidden}setDatasetVisibility(t,e){const s=this.getDatasetMeta(t);s.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,s){const n=s?"show":"hide",r=this.getDatasetMeta(t),a=r.controller._resolveAnimations(void 0,n);defined(e)?(r.data[e].hidden=!s,this.update()):(this.setDatasetVisibility(t,s),a.update(r,{visible:s}),this.update(o=>o.datasetIndex===t?n:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),animator.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),clearCanvas(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete instances[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,s=(r,a)=>{e.addEventListener(this,r,a),t[r]=a},n=(r,a,o)=>{r.offsetX=a,r.offsetY=o,this._eventHandler(r)};each(this.options.events,r=>s(r,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,s=(l,c)=>{e.addEventListener(this,l,c),t[l]=c},n=(l,c)=>{t[l]&&(e.removeEventListener(this,l,c),delete t[l])},r=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const o=()=>{n("attach",o),this.attached=!0,this.resize(),s("resize",r),s("detach",a)};a=()=>{this.attached=!1,n("resize",r),this._stop(),this._resize(0,0),s("attach",o)},e.isAttached(this.canvas)?o():a()}unbindEvents(){each(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},each(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,s){const n=s?"set":"remove";let r,a,o,l;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+n+"DatasetHoverStyle"]()),o=0,l=t.length;o<l;++o){a=t[o];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[n+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],s=t.map(({datasetIndex:r,index:a})=>{const o=this.getDatasetMeta(r);if(!o)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:o.data[a],index:a}});!_elementsEqual(s,e)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,e))}notifyPlugins(t,e,s){return this._plugins.notify(this,t,e,s)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,s){const n=this.options.hover,r=(l,c)=>l.filter(p=>!c.some(m=>p.datasetIndex===m.datasetIndex&&p.index===m.index)),a=r(e,t),o=s?t:r(t,e);a.length&&this.updateHoverStyle(a,n.mode,!1),o.length&&n.mode&&this.updateHoverStyle(o,n.mode,!0)}_eventHandler(t,e){const s={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},n=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",s,n)===!1)return;const r=this._handleEvent(t,e,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,n),(r||s.changed)&&this.render(),this}_handleEvent(t,e,s){const{_active:n=[],options:r}=this,a=e,o=this._getActiveElements(t,n,s,a),l=_isClickEvent(t),c=determineLastEvent(t,this._lastEvent,s,l);s&&(this._lastEvent=null,callback(r.onHover,[t,o,this],this),l&&callback(r.onClick,[t,o,this],this));const p=!_elementsEqual(o,n);return(p||e)&&(this._active=o,this._updateHoverStyles(o,n,e)),this._lastEvent=c,p}_getActiveElements(t,e,s,n){if(t.type==="mouseout")return[];if(!s)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,n)}}ft(Chart,"defaults",defaults),ft(Chart,"instances",instances),ft(Chart,"overrides",overrides),ft(Chart,"registry",registry),ft(Chart,"version",version),ft(Chart,"getChart",getChart);function invalidatePlugins(){return each(Chart.instances,i=>i._plugins.invalidate())}function clipArc(i,t,e){const{startAngle:s,pixelMargin:n,x:r,y:a,outerRadius:o,innerRadius:l}=t;let c=n/o;i.beginPath(),i.arc(r,a,o,s-c,e+c),l>n?(c=n/l,i.arc(r,a,l,e+c,s-c,!0)):i.arc(r,a,n,e+HALF_PI,s-HALF_PI),i.closePath(),i.clip()}function toRadiusCorners(i){return _readValueToProps(i,["outerStart","outerEnd","innerStart","innerEnd"])}function parseBorderRadius$1(i,t,e,s){const n=toRadiusCorners(i.options.borderRadius),r=(e-t)/2,a=Math.min(r,s*t/2),o=l=>{const c=(e-Math.min(r,l))*s/2;return _limitValue(l,0,Math.min(r,c))};return{outerStart:o(n.outerStart),outerEnd:o(n.outerEnd),innerStart:_limitValue(n.innerStart,0,a),innerEnd:_limitValue(n.innerEnd,0,a)}}function rThetaToXY(i,t,e,s){return{x:e+i*Math.cos(t),y:s+i*Math.sin(t)}}function pathArc(i,t,e,s,n,r){const{x:a,y:o,startAngle:l,pixelMargin:c,innerRadius:p}=t,m=Math.max(t.outerRadius+s+e-c,0),_=p>0?p+s+e+c:0;let y=0;const b=n-l;if(s){const q=p>0?p-s:0,W=m>0?m-s:0,$=(q+W)/2,X=$!==0?b*$/($+s):b;y=(b-X)/2}const u=Math.max(.001,b*m-e/PI)/m,g=(b-u)/2,x=l+g+y,P=n-g-y,{outerStart:A,outerEnd:h,innerStart:d,innerEnd:f}=parseBorderRadius$1(t,_,m,P-x),v=m-A,w=m-h,C=x+A/v,k=P-h/w,R=_+d,H=_+f,Z=x+d/R,K=P-f/H;if(i.beginPath(),r){const q=(C+k)/2;if(i.arc(a,o,m,C,q),i.arc(a,o,m,q,k),h>0){const it=rThetaToXY(w,k,a,o);i.arc(it.x,it.y,h,k,P+HALF_PI)}const W=rThetaToXY(H,P,a,o);if(i.lineTo(W.x,W.y),f>0){const it=rThetaToXY(H,K,a,o);i.arc(it.x,it.y,f,P+HALF_PI,K+Math.PI)}const $=(P-f/_+(x+d/_))/2;if(i.arc(a,o,_,P-f/_,$,!0),i.arc(a,o,_,$,x+d/_,!0),d>0){const it=rThetaToXY(R,Z,a,o);i.arc(it.x,it.y,d,Z+Math.PI,x-HALF_PI)}const X=rThetaToXY(v,x,a,o);if(i.lineTo(X.x,X.y),A>0){const it=rThetaToXY(v,C,a,o);i.arc(it.x,it.y,A,x-HALF_PI,C)}}else{i.moveTo(a,o);const q=Math.cos(C)*m+a,W=Math.sin(C)*m+o;i.lineTo(q,W);const $=Math.cos(k)*m+a,X=Math.sin(k)*m+o;i.lineTo($,X)}i.closePath()}function drawArc(i,t,e,s,n){const{fullCircles:r,startAngle:a,circumference:o}=t;let l=t.endAngle;if(r){pathArc(i,t,e,s,l,n);for(let c=0;c<r;++c)i.fill();isNaN(o)||(l=a+(o%TAU||TAU))}return pathArc(i,t,e,s,l,n),i.fill(),l}function drawBorder(i,t,e,s,n){const{fullCircles:r,startAngle:a,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:p,borderDash:m,borderDashOffset:_}=l,y=l.borderAlign==="inner";if(!c)return;i.setLineDash(m||[]),i.lineDashOffset=_,y?(i.lineWidth=c*2,i.lineJoin=p||"round"):(i.lineWidth=c,i.lineJoin=p||"bevel");let b=t.endAngle;if(r){pathArc(i,t,e,s,b,n);for(let u=0;u<r;++u)i.stroke();isNaN(o)||(b=a+(o%TAU||TAU))}y&&clipArc(i,t,b),r||(pathArc(i,t,e,s,b,n),i.stroke())}class ArcElement extends Element{constructor(e){super();ft(this,"circumference");ft(this,"endAngle");ft(this,"fullCircles");ft(this,"innerRadius");ft(this,"outerRadius");ft(this,"pixelMargin");ft(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,s,n){const r=this.getProps(["x","y"],n),{angle:a,distance:o}=getAngleFromPoint(r,{x:e,y:s}),{startAngle:l,endAngle:c,innerRadius:p,outerRadius:m,circumference:_}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),y=(this.options.spacing+this.options.borderWidth)/2,u=valueOrDefault(_,c-l)>=TAU||_angleBetween(a,l,c),g=_isBetween(o,p+y,m+y);return u&&g}getCenterPoint(e){const{x:s,y:n,startAngle:r,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:p}=this.options,m=(r+a)/2,_=(o+l+p+c)/2;return{x:s+Math.cos(m)*_,y:n+Math.sin(m)*_}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:s,circumference:n}=this,r=(s.offset||0)/4,a=(s.spacing||0)/2,o=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=n>TAU?Math.floor(n/TAU):0,n===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*r,Math.sin(l)*r);const c=1-Math.sin(Math.min(PI,n||0)),p=r*c;e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,drawArc(e,this,p,a,o),drawBorder(e,this,p,a,o),e.restore()}}ft(ArcElement,"id","arc"),ft(ArcElement,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),ft(ArcElement,"defaultRoutes",{backgroundColor:"backgroundColor"}),ft(ArcElement,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"});function setStyle(i,t,e=t){i.lineCap=valueOrDefault(e.borderCapStyle,t.borderCapStyle),i.setLineDash(valueOrDefault(e.borderDash,t.borderDash)),i.lineDashOffset=valueOrDefault(e.borderDashOffset,t.borderDashOffset),i.lineJoin=valueOrDefault(e.borderJoinStyle,t.borderJoinStyle),i.lineWidth=valueOrDefault(e.borderWidth,t.borderWidth),i.strokeStyle=valueOrDefault(e.borderColor,t.borderColor)}function lineTo(i,t,e){i.lineTo(e.x,e.y)}function getLineMethod(i){return i.stepped?_steppedLineTo:i.tension||i.cubicInterpolationMode==="monotone"?_bezierCurveTo:lineTo}function pathVars(i,t,e={}){const s=i.length,{start:n=0,end:r=s-1}=e,{start:a,end:o}=t,l=Math.max(n,a),c=Math.min(r,o),p=n<a&&r<a||n>o&&r>o;return{count:s,start:l,loop:t.loop,ilen:c<l&&!p?s+c-l:c-l}}function pathSegment(i,t,e,s){const{points:n,options:r}=t,{count:a,start:o,loop:l,ilen:c}=pathVars(n,e,s),p=getLineMethod(r);let{move:m=!0,reverse:_}=s||{},y,b,u;for(y=0;y<=c;++y)b=n[(o+(_?c-y:y))%a],!b.skip&&(m?(i.moveTo(b.x,b.y),m=!1):p(i,u,b,_,r.stepped),u=b);return l&&(b=n[(o+(_?c:0))%a],p(i,u,b,_,r.stepped)),!!l}function fastPathSegment(i,t,e,s){const n=t.points,{count:r,start:a,ilen:o}=pathVars(n,e,s),{move:l=!0,reverse:c}=s||{};let p=0,m=0,_,y,b,u,g,x;const P=h=>(a+(c?o-h:h))%r,A=()=>{u!==g&&(i.lineTo(p,g),i.lineTo(p,u),i.lineTo(p,x))};for(l&&(y=n[P(0)],i.moveTo(y.x,y.y)),_=0;_<=o;++_){if(y=n[P(_)],y.skip)continue;const h=y.x,d=y.y,f=h|0;f===b?(d<u?u=d:d>g&&(g=d),p=(m*p+h)/++m):(A(),i.lineTo(h,d),b=f,m=0,u=g=d),x=d}A()}function _getSegmentMethod(i){const t=i.options,e=t.borderDash&&t.borderDash.length;return!i._decimated&&!i._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?fastPathSegment:pathSegment}function _getInterpolationMethod(i){return i.stepped?_steppedInterpolation:i.tension||i.cubicInterpolationMode==="monotone"?_bezierInterpolation:_pointInLine}function strokePathWithCache(i,t,e,s){let n=t._path;n||(n=t._path=new Path2D,t.path(n,e,s)&&n.closePath()),setStyle(i,t.options),i.stroke(n)}function strokePathDirect(i,t,e,s){const{segments:n,options:r}=t,a=_getSegmentMethod(t);for(const o of n)setStyle(i,r,o.style),i.beginPath(),a(i,t,o,{start:e,end:e+s-1})&&i.closePath(),i.stroke()}const usePath2D=typeof Path2D=="function";function draw(i,t,e,s){usePath2D&&!t.options.segment?strokePathWithCache(i,t,e,s):strokePathDirect(i,t,e,s)}class LineElement extends Element{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const n=s.spanGaps?this._loop:this._fullLoop;_updateBezierControlPoints(this._points,s,t,n,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_computeSegments(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,s=t.length;return s&&e[t[s-1].end]}interpolate(t,e){const s=this.options,n=t[e],r=this.points,a=_boundSegments(this,{property:e,start:n,end:n});if(!a.length)return;const o=[],l=_getInterpolationMethod(s);let c,p;for(c=0,p=a.length;c<p;++c){const{start:m,end:_}=a[c],y=r[m],b=r[_];if(y===b){o.push(y);continue}const u=Math.abs((n-y[e])/(b[e]-y[e])),g=l(y,b,u,s.stepped);g[e]=t[e],o.push(g)}return o.length===1?o[0]:o}pathSegment(t,e,s){return _getSegmentMethod(this)(t,this,e,s)}path(t,e,s){const n=this.segments,r=_getSegmentMethod(this);let a=this._loop;e=e||0,s=s||this.points.length-e;for(const o of n)a&=r(t,this,o,{start:e,end:e+s-1});return!!a}draw(t,e,s,n){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),draw(t,this,s,n),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}ft(LineElement,"id","line"),ft(LineElement,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),ft(LineElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),ft(LineElement,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"});function inRange$1(i,t,e,s){const n=i.options,{[e]:r}=i.getProps([e],s);return Math.abs(t-r)<n.radius+n.hitRadius}class PointElement extends Element{constructor(e){super();ft(this,"parsed");ft(this,"skip");ft(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,s,n){const r=this.options,{x:a,y:o}=this.getProps(["x","y"],n);return Math.pow(e-a,2)+Math.pow(s-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,s){return inRange$1(this,e,"x",s)}inYRange(e,s){return inRange$1(this,e,"y",s)}getCenterPoint(e){const{x:s,y:n}=this.getProps(["x","y"],e);return{x:s,y:n}}size(e){e=e||this.options||{};let s=e.radius||0;s=Math.max(s,s&&e.hoverRadius||0);const n=s&&e.borderWidth||0;return(s+n)*2}draw(e,s){const n=this.options;this.skip||n.radius<.1||!_isPointInArea(this,s,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,drawPoint(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}ft(PointElement,"id","point"),ft(PointElement,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),ft(PointElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function getBarBounds(i,t){const{x:e,y:s,base:n,width:r,height:a}=i.getProps(["x","y","base","width","height"],t);let o,l,c,p,m;return i.horizontal?(m=a/2,o=Math.min(e,n),l=Math.max(e,n),c=s-m,p=s+m):(m=r/2,o=e-m,l=e+m,c=Math.min(s,n),p=Math.max(s,n)),{left:o,top:c,right:l,bottom:p}}function skipOrLimit(i,t,e,s){return i?0:_limitValue(t,e,s)}function parseBorderWidth(i,t,e){const s=i.options.borderWidth,n=i.borderSkipped,r=toTRBL(s);return{t:skipOrLimit(n.top,r.top,0,e),r:skipOrLimit(n.right,r.right,0,t),b:skipOrLimit(n.bottom,r.bottom,0,e),l:skipOrLimit(n.left,r.left,0,t)}}function parseBorderRadius(i,t,e){const{enableBorderRadius:s}=i.getProps(["enableBorderRadius"]),n=i.options.borderRadius,r=toTRBLCorners(n),a=Math.min(t,e),o=i.borderSkipped,l=s||isObject(n);return{topLeft:skipOrLimit(!l||o.top||o.left,r.topLeft,0,a),topRight:skipOrLimit(!l||o.top||o.right,r.topRight,0,a),bottomLeft:skipOrLimit(!l||o.bottom||o.left,r.bottomLeft,0,a),bottomRight:skipOrLimit(!l||o.bottom||o.right,r.bottomRight,0,a)}}function boundingRects(i){const t=getBarBounds(i),e=t.right-t.left,s=t.bottom-t.top,n=parseBorderWidth(i,e/2,s/2),r=parseBorderRadius(i,e/2,s/2);return{outer:{x:t.left,y:t.top,w:e,h:s,radius:r},inner:{x:t.left+n.l,y:t.top+n.t,w:e-n.l-n.r,h:s-n.t-n.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(n.t,n.l)),topRight:Math.max(0,r.topRight-Math.max(n.t,n.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(n.b,n.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(n.b,n.r))}}}}function inRange(i,t,e,s){const n=t===null,r=e===null,o=i&&!(n&&r)&&getBarBounds(i,s);return o&&(n||_isBetween(t,o.left,o.right))&&(r||_isBetween(e,o.top,o.bottom))}function hasRadius(i){return i.topLeft||i.topRight||i.bottomLeft||i.bottomRight}function addNormalRectPath(i,t){i.rect(t.x,t.y,t.w,t.h)}function inflateRect(i,t,e={}){const s=i.x!==e.x?-t:0,n=i.y!==e.y?-t:0,r=(i.x+i.w!==e.x+e.w?t:0)-s,a=(i.y+i.h!==e.y+e.h?t:0)-n;return{x:i.x+s,y:i.y+n,w:i.w+r,h:i.h+a,radius:i.radius}}class BarElement extends Element{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:s,backgroundColor:n}}=this,{inner:r,outer:a}=boundingRects(this),o=hasRadius(a.radius)?addRoundedRectPath:addNormalRectPath;t.save(),(a.w!==r.w||a.h!==r.h)&&(t.beginPath(),o(t,inflateRect(a,e,r)),t.clip(),o(t,inflateRect(r,-e,a)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),o(t,inflateRect(r,e)),t.fillStyle=n,t.fill(),t.restore()}inRange(t,e,s){return inRange(this,t,e,s)}inXRange(t,e){return inRange(this,t,null,e)}inYRange(t,e){return inRange(this,null,t,e)}getCenterPoint(t){const{x:e,y:s,base:n,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+n)/2:e,y:r?s:(s+n)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}ft(BarElement,"id","bar"),ft(BarElement,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ft(BarElement,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var elements=Object.freeze({__proto__:null,ArcElement,BarElement,LineElement,PointElement});const BORDER_COLORS=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],BACKGROUND_COLORS=BORDER_COLORS.map(i=>i.replace("rgb(","rgba(").replace(")",", 0.5)"));function getBorderColor(i){return BORDER_COLORS[i%BORDER_COLORS.length]}function getBackgroundColor(i){return BACKGROUND_COLORS[i%BACKGROUND_COLORS.length]}function colorizeDefaultDataset(i,t){return i.borderColor=getBorderColor(t),i.backgroundColor=getBackgroundColor(t),++t}function colorizeDoughnutDataset(i,t){return i.backgroundColor=i.data.map(()=>getBorderColor(t++)),t}function colorizePolarAreaDataset(i,t){return i.backgroundColor=i.data.map(()=>getBackgroundColor(t++)),t}function getColorizer(i){let t=0;return(e,s)=>{const n=i.getDatasetMeta(s).controller;n instanceof DoughnutController?t=colorizeDoughnutDataset(e,t):n instanceof PolarAreaController?t=colorizePolarAreaDataset(e,t):n&&(t=colorizeDefaultDataset(e,t))}}function containsColorsDefinitions(i){let t;for(t in i)if(i[t].borderColor||i[t].backgroundColor)return!0;return!1}function containsColorsDefinition(i){return i&&(i.borderColor||i.backgroundColor)}var plugin_colors={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(i,t,e){if(!e.enabled)return;const{data:{datasets:s},options:n}=i.config,{elements:r}=n;if(!e.forceOverride&&(containsColorsDefinitions(s)||containsColorsDefinition(n)||r&&containsColorsDefinitions(r)))return;const a=getColorizer(i);s.forEach(a)}};function lttbDecimation(i,t,e,s,n){const r=n.samples||s;if(r>=e)return i.slice(t,t+e);const a=[],o=(e-2)/(r-2);let l=0;const c=t+e-1;let p=t,m,_,y,b,u;for(a[l++]=i[p],m=0;m<r-2;m++){let g=0,x=0,P;const A=Math.floor((m+1)*o)+1+t,h=Math.min(Math.floor((m+2)*o)+1,e)+t,d=h-A;for(P=A;P<h;P++)g+=i[P].x,x+=i[P].y;g/=d,x/=d;const f=Math.floor(m*o)+1+t,v=Math.min(Math.floor((m+1)*o)+1,e)+t,{x:w,y:C}=i[p];for(y=b=-1,P=f;P<v;P++)b=.5*Math.abs((w-g)*(i[P].y-C)-(w-i[P].x)*(x-C)),b>y&&(y=b,_=i[P],u=P);a[l++]=_,p=u}return a[l++]=i[c],a}function minMaxDecimation(i,t,e,s){let n=0,r=0,a,o,l,c,p,m,_,y,b,u;const g=[],x=t+e-1,P=i[t].x,h=i[x].x-P;for(a=t;a<t+e;++a){o=i[a],l=(o.x-P)/h*s,c=o.y;const d=l|0;if(d===p)c<b?(b=c,m=a):c>u&&(u=c,_=a),n=(r*n+o.x)/++r;else{const f=a-1;if(!isNullOrUndef(m)&&!isNullOrUndef(_)){const v=Math.min(m,_),w=Math.max(m,_);v!==y&&v!==f&&g.push({...i[v],x:n}),w!==y&&w!==f&&g.push({...i[w],x:n})}a>0&&f!==y&&g.push(i[f]),g.push(o),p=d,r=0,b=u=c,m=_=y=a}}return g}function cleanDecimatedDataset(i){if(i._decimated){const t=i._data;delete i._decimated,delete i._data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function cleanDecimatedData(i){i.data.datasets.forEach(t=>{cleanDecimatedDataset(t)})}function getStartAndCountOfVisiblePointsSimplified(i,t){const e=t.length;let s=0,n;const{iScale:r}=i,{min:a,max:o,minDefined:l,maxDefined:c}=r.getUserBounds();return l&&(s=_limitValue(_lookupByKey(t,r.axis,a).lo,0,e-1)),c?n=_limitValue(_lookupByKey(t,r.axis,o).hi+1,s,e)-s:n=e-s,{start:s,count:n}}var plugin_decimation={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(i,t,e)=>{if(!e.enabled){cleanDecimatedData(i);return}const s=i.width;i.data.datasets.forEach((n,r)=>{const{_data:a,indexAxis:o}=n,l=i.getDatasetMeta(r),c=a||n.data;if(resolve([o,i.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const p=i.scales[l.xAxisID];if(p.type!=="linear"&&p.type!=="time"||i.options.parsing)return;let{start:m,count:_}=getStartAndCountOfVisiblePointsSimplified(l,c);const y=e.threshold||4*s;if(_<=y){cleanDecimatedDataset(n);return}isNullOrUndef(a)&&(n._data=c,delete n.data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(u){this._data=u}}));let b;switch(e.algorithm){case"lttb":b=lttbDecimation(c,m,_,s,e);break;case"min-max":b=minMaxDecimation(c,m,_,s);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}n._decimated=b})},destroy(i){cleanDecimatedData(i)}};function _segments(i,t,e){const s=i.segments,n=i.points,r=t.points,a=[];for(const o of s){let{start:l,end:c}=o;c=_findSegmentEnd(l,c,n);const p=_getBounds(e,n[l],n[c],o.loop);if(!t.segments){a.push({source:o,target:p,start:n[l],end:n[c]});continue}const m=_boundSegments(t,p);for(const _ of m){const y=_getBounds(e,r[_.start],r[_.end],_.loop),b=_boundSegment(o,n,y);for(const u of b)a.push({source:u,target:_,start:{[e]:_getEdge(p,y,"start",Math.max)},end:{[e]:_getEdge(p,y,"end",Math.min)}})}}return a}function _getBounds(i,t,e,s){if(s)return;let n=t[i],r=e[i];return i==="angle"&&(n=_normalizeAngle(n),r=_normalizeAngle(r)),{property:i,start:n,end:r}}function _pointsFromSegments(i,t){const{x:e=null,y:s=null}=i||{},n=t.points,r=[];return t.segments.forEach(({start:a,end:o})=>{o=_findSegmentEnd(a,o,n);const l=n[a],c=n[o];s!==null?(r.push({x:l.x,y:s}),r.push({x:c.x,y:s})):e!==null&&(r.push({x:e,y:l.y}),r.push({x:e,y:c.y}))}),r}function _findSegmentEnd(i,t,e){for(;t>i;t--){const s=e[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function _getEdge(i,t,e,s){return i&&t?s(i[e],t[e]):i?i[e]:t?t[e]:0}function _createBoundaryLine(i,t){let e=[],s=!1;return isArray(i)?(s=!0,e=i):e=_pointsFromSegments(i,t),e.length?new LineElement({points:e,options:{tension:0},_loop:s,_fullLoop:s}):null}function _shouldApplyFill(i){return i&&i.fill!==!1}function _resolveTarget(i,t,e){let n=i[t].fill;const r=[t];let a;if(!e)return n;for(;n!==!1&&r.indexOf(n)===-1;){if(!isNumberFinite(n))return n;if(a=i[n],!a)return!1;if(a.visible)return n;r.push(n),n=a.fill}return!1}function _decodeFill(i,t,e){const s=parseFillOption(i);if(isObject(s))return isNaN(s.value)?!1:s;let n=parseFloat(s);return isNumberFinite(n)&&Math.floor(n)===n?decodeTargetIndex(s[0],t,n,e):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function decodeTargetIndex(i,t,e,s){return(i==="-"||i==="+")&&(e=t+e),e===t||e<0||e>=s?!1:e}function _getTargetPixel(i,t){let e=null;return i==="start"?e=t.bottom:i==="end"?e=t.top:isObject(i)?e=t.getPixelForValue(i.value):t.getBasePixel&&(e=t.getBasePixel()),e}function _getTargetValue(i,t,e){let s;return i==="start"?s=e:i==="end"?s=t.options.reverse?t.min:t.max:isObject(i)?s=i.value:s=t.getBaseValue(),s}function parseFillOption(i){const t=i.options,e=t.fill;let s=valueOrDefault(e&&e.target,e);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function _buildStackLine(i){const{scale:t,index:e,line:s}=i,n=[],r=s.segments,a=s.points,o=getLinesBelow(t,e);o.push(_createBoundaryLine({x:null,y:t.bottom},s));for(let l=0;l<r.length;l++){const c=r[l];for(let p=c.start;p<=c.end;p++)addPointsBelow(n,a[p],o)}return new LineElement({points:n,options:{}})}function getLinesBelow(i,t){const e=[],s=i.getMatchingVisibleMetas("line");for(let n=0;n<s.length;n++){const r=s[n];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}function addPointsBelow(i,t,e){const s=[];for(let n=0;n<e.length;n++){const r=e[n],{first:a,last:o,point:l}=findPoint(r,t,"x");if(!(!l||a&&o)){if(a)s.unshift(l);else if(i.push(l),!o)break}}i.push(...s)}function findPoint(i,t,e){const s=i.interpolate(t,e);if(!s)return{};const n=s[e],r=i.segments,a=i.points;let o=!1,l=!1;for(let c=0;c<r.length;c++){const p=r[c],m=a[p.start][e],_=a[p.end][e];if(_isBetween(n,m,_)){o=n===m,l=n===_;break}}return{first:o,last:l,point:s}}class simpleArc{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,s){const{x:n,y:r,radius:a}=this;return e=e||{start:0,end:TAU},t.arc(n,r,a,e.end,e.start,!0),!s.bounds}interpolate(t){const{x:e,y:s,radius:n}=this,r=t.angle;return{x:e+Math.cos(r)*n,y:s+Math.sin(r)*n,angle:r}}}function _getTarget(i){const{chart:t,fill:e,line:s}=i;if(isNumberFinite(e))return getLineByIndex(t,e);if(e==="stack")return _buildStackLine(i);if(e==="shape")return!0;const n=computeBoundary(i);return n instanceof simpleArc?n:_createBoundaryLine(n,s)}function getLineByIndex(i,t){const e=i.getDatasetMeta(t);return e&&i.isDatasetVisible(t)?e.dataset:null}function computeBoundary(i){return(i.scale||{}).getPointPositionForValue?computeCircularBoundary(i):computeLinearBoundary(i)}function computeLinearBoundary(i){const{scale:t={},fill:e}=i,s=_getTargetPixel(e,t);if(isNumberFinite(s)){const n=t.isHorizontal();return{x:n?s:null,y:n?null:s}}return null}function computeCircularBoundary(i){const{scale:t,fill:e}=i,s=t.options,n=t.getLabels().length,r=s.reverse?t.max:t.min,a=_getTargetValue(e,t,r),o=[];if(s.grid.circular){const l=t.getPointPositionForValue(0,r);return new simpleArc({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(a)})}for(let l=0;l<n;++l)o.push(t.getPointPositionForValue(l,a));return o}function _drawfill(i,t,e){const s=_getTarget(t),{line:n,scale:r,axis:a}=t,o=n.options,l=o.fill,c=o.backgroundColor,{above:p=c,below:m=c}=l||{};s&&n.points.length&&(clipArea(i,e),doFill(i,{line:n,target:s,above:p,below:m,area:e,scale:r,axis:a}),unclipArea(i))}function doFill(i,t){const{line:e,target:s,above:n,below:r,area:a,scale:o}=t,l=e._loop?"angle":t.axis;i.save(),l==="x"&&r!==n&&(clipVertical(i,s,a.top),fill(i,{line:e,target:s,color:n,scale:o,property:l}),i.restore(),i.save(),clipVertical(i,s,a.bottom)),fill(i,{line:e,target:s,color:r,scale:o,property:l}),i.restore()}function clipVertical(i,t,e){const{segments:s,points:n}=t;let r=!0,a=!1;i.beginPath();for(const o of s){const{start:l,end:c}=o,p=n[l],m=n[_findSegmentEnd(l,c,n)];r?(i.moveTo(p.x,p.y),r=!1):(i.lineTo(p.x,e),i.lineTo(p.x,p.y)),a=!!t.pathSegment(i,o,{move:a}),a?i.closePath():i.lineTo(m.x,e)}i.lineTo(t.first().x,e),i.closePath(),i.clip()}function fill(i,t){const{line:e,target:s,property:n,color:r,scale:a}=t,o=_segments(e,s,n);for(const{source:l,target:c,start:p,end:m}of o){const{style:{backgroundColor:_=r}={}}=l,y=s!==!0;i.save(),i.fillStyle=_,clipBounds(i,a,y&&_getBounds(n,p,m)),i.beginPath();const b=!!e.pathSegment(i,l);let u;if(y){b?i.closePath():interpolatedLineTo(i,s,m,n);const g=!!s.pathSegment(i,c,{move:b,reverse:!0});u=b&&g,u||interpolatedLineTo(i,s,p,n)}i.closePath(),i.fill(u?"evenodd":"nonzero"),i.restore()}}function clipBounds(i,t,e){const{top:s,bottom:n}=t.chart.chartArea,{property:r,start:a,end:o}=e||{};r==="x"&&(i.beginPath(),i.rect(a,s,o-a,n-s),i.clip())}function interpolatedLineTo(i,t,e,s){const n=t.interpolate(e,s);n&&i.lineTo(n.x,n.y)}var index={id:"filler",afterDatasetsUpdate(i,t,e){const s=(i.data.datasets||[]).length,n=[];let r,a,o,l;for(a=0;a<s;++a)r=i.getDatasetMeta(a),o=r.dataset,l=null,o&&o.options&&o instanceof LineElement&&(l={visible:i.isDatasetVisible(a),index:a,fill:_decodeFill(o,a,s),chart:i,axis:r.controller.options.indexAxis,scale:r.vScale,line:o}),r.$filler=l,n.push(l);for(a=0;a<s;++a)l=n[a],!(!l||l.fill===!1)&&(l.fill=_resolveTarget(n,a,e.propagate))},beforeDraw(i,t,e){const s=e.drawTime==="beforeDraw",n=i.getSortedVisibleDatasetMetas(),r=i.chartArea;for(let a=n.length-1;a>=0;--a){const o=n[a].$filler;o&&(o.line.updateControlPoints(r,o.axis),s&&o.fill&&_drawfill(i.ctx,o,r))}},beforeDatasetsDraw(i,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const s=i.getSortedVisibleDatasetMetas();for(let n=s.length-1;n>=0;--n){const r=s[n].$filler;_shouldApplyFill(r)&&_drawfill(i.ctx,r,i.chartArea)}},beforeDatasetDraw(i,t,e){const s=t.meta.$filler;!_shouldApplyFill(s)||e.drawTime!=="beforeDatasetDraw"||_drawfill(i.ctx,s,i.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const getBoxSize=(i,t)=>{let{boxHeight:e=t,boxWidth:s=t}=i;return i.usePointStyle&&(e=Math.min(e,t),s=i.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:e,itemHeight:Math.max(t,e)}},itemsEqual=(i,t)=>i!==null&&t!==null&&i.datasetIndex===t.datasetIndex&&i.index===t.index;class Legend extends Element{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,s){this.maxWidth=t,this.maxHeight=e,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=callback(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(s=>t.filter(s,this.chart.data))),t.sort&&(e=e.sort((s,n)=>t.sort(s,n,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const s=t.labels,n=toFont(s.font),r=n.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=getBoxSize(s,r);let c,p;e.font=n.string,this.isHorizontal()?(c=this.maxWidth,p=this._fitRows(a,r,o,l)+10):(p=this.maxHeight,c=this._fitCols(a,n,o,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(p,t.maxHeight||this.maxHeight)}_fitRows(t,e,s,n){const{ctx:r,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],p=n+o;let m=t;r.textAlign="left",r.textBaseline="middle";let _=-1,y=-p;return this.legendItems.forEach((b,u)=>{const g=s+e/2+r.measureText(b.text).width;(u===0||c[c.length-1]+g+2*o>a)&&(m+=p,c[c.length-(u>0?0:1)]=0,y+=p,_++),l[u]={left:0,top:y,row:_,width:g,height:n},c[c.length-1]+=g+o}),m}_fitCols(t,e,s,n){const{ctx:r,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],p=a-t;let m=o,_=0,y=0,b=0,u=0;return this.legendItems.forEach((g,x)=>{const{itemWidth:P,itemHeight:A}=calculateItemSize(s,e,r,g,n);x>0&&y+A+2*o>p&&(m+=_+o,c.push({width:_,height:y}),b+=_+o,u++,_=y=0),l[x]={left:b,top:y,col:u,width:P,height:A},_=Math.max(_,P),y+=A+o}),m+=_,c.push({width:_,height:y}),m}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:s,labels:{padding:n},rtl:r}}=this,a=getRtlAdapter(r,this.left,this.width);if(this.isHorizontal()){let o=0,l=_alignStartEnd(s,this.left+n,this.right-this.lineWidths[o]);for(const c of e)o!==c.row&&(o=c.row,l=_alignStartEnd(s,this.left+n,this.right-this.lineWidths[o])),c.top+=this.top+t+n,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+n}else{let o=0,l=_alignStartEnd(s,this.top+t+n,this.bottom-this.columnSizes[o].height);for(const c of e)c.col!==o&&(o=c.col,l=_alignStartEnd(s,this.top+t+n,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+n,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;clipArea(t,this),this._draw(),unclipArea(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:s,ctx:n}=this,{align:r,labels:a}=t,o=defaults.color,l=getRtlAdapter(t.rtl,this.left,this.width),c=toFont(a.font),{padding:p}=a,m=c.size,_=m/2;let y;this.drawTitle(),n.textAlign=l.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=c.string;const{boxWidth:b,boxHeight:u,itemHeight:g}=getBoxSize(a,m),x=function(f,v,w){if(isNaN(b)||b<=0||isNaN(u)||u<0)return;n.save();const C=valueOrDefault(w.lineWidth,1);if(n.fillStyle=valueOrDefault(w.fillStyle,o),n.lineCap=valueOrDefault(w.lineCap,"butt"),n.lineDashOffset=valueOrDefault(w.lineDashOffset,0),n.lineJoin=valueOrDefault(w.lineJoin,"miter"),n.lineWidth=C,n.strokeStyle=valueOrDefault(w.strokeStyle,o),n.setLineDash(valueOrDefault(w.lineDash,[])),a.usePointStyle){const k={radius:u*Math.SQRT2/2,pointStyle:w.pointStyle,rotation:w.rotation,borderWidth:C},R=l.xPlus(f,b/2),H=v+_;drawPointLegend(n,k,R,H,a.pointStyleWidth&&b)}else{const k=v+Math.max((m-u)/2,0),R=l.leftForLtr(f,b),H=toTRBLCorners(w.borderRadius);n.beginPath(),Object.values(H).some(Z=>Z!==0)?addRoundedRectPath(n,{x:R,y:k,w:b,h:u,radius:H}):n.rect(R,k,b,u),n.fill(),C!==0&&n.stroke()}n.restore()},P=function(f,v,w){renderText(n,w.text,f,v+g/2,c,{strikethrough:w.hidden,textAlign:l.textAlign(w.textAlign)})},A=this.isHorizontal(),h=this._computeTitleHeight();A?y={x:_alignStartEnd(r,this.left+p,this.right-s[0]),y:this.top+p+h,line:0}:y={x:this.left+p,y:_alignStartEnd(r,this.top+h+p,this.bottom-e[0].height),line:0},overrideTextDirection(this.ctx,t.textDirection);const d=g+p;this.legendItems.forEach((f,v)=>{n.strokeStyle=f.fontColor,n.fillStyle=f.fontColor;const w=n.measureText(f.text).width,C=l.textAlign(f.textAlign||(f.textAlign=a.textAlign)),k=b+_+w;let R=y.x,H=y.y;l.setWidth(this.width),A?v>0&&R+k+p>this.right&&(H=y.y+=d,y.line++,R=y.x=_alignStartEnd(r,this.left+p,this.right-s[y.line])):v>0&&H+d>this.bottom&&(R=y.x=R+e[y.line].width+p,y.line++,H=y.y=_alignStartEnd(r,this.top+h+p,this.bottom-e[y.line].height));const Z=l.x(R);if(x(Z,H,f),R=_textX(C,R+b+_,A?R+k:this.right,t.rtl),P(l.x(R),H,f),A)y.x+=k+p;else if(typeof f.text!="string"){const K=c.lineHeight;y.y+=calculateLegendItemHeight(f,K)+p}else y.y+=d}),restoreTextDirection(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,s=toFont(e.font),n=toPadding(e.padding);if(!e.display)return;const r=getRtlAdapter(t.rtl,this.left,this.width),a=this.ctx,o=e.position,l=s.size/2,c=n.top+l;let p,m=this.left,_=this.width;if(this.isHorizontal())_=Math.max(...this.lineWidths),p=this.top+c,m=_alignStartEnd(t.align,m,this.right-_);else{const b=this.columnSizes.reduce((u,g)=>Math.max(u,g.height),0);p=c+_alignStartEnd(t.align,this.top,this.bottom-b-t.labels.padding-this._computeTitleHeight())}const y=_alignStartEnd(o,m,m+_);a.textAlign=r.textAlign(_toLeftRightCenter(o)),a.textBaseline="middle",a.strokeStyle=e.color,a.fillStyle=e.color,a.font=s.string,renderText(a,e.text,y,p,s)}_computeTitleHeight(){const t=this.options.title,e=toFont(t.font),s=toPadding(t.padding);return t.display?e.lineHeight+s.height:0}_getLegendItemAt(t,e){let s,n,r;if(_isBetween(t,this.left,this.right)&&_isBetween(e,this.top,this.bottom)){for(r=this.legendHitBoxes,s=0;s<r.length;++s)if(n=r[s],_isBetween(t,n.left,n.left+n.width)&&_isBetween(e,n.top,n.top+n.height))return this.legendItems[s]}return null}handleEvent(t){const e=this.options;if(!isListened(t.type,e))return;const s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const n=this._hoveredItem,r=itemsEqual(n,s);n&&!r&&callback(e.onLeave,[t,n,this],this),this._hoveredItem=s,s&&!r&&callback(e.onHover,[t,s,this],this)}else s&&callback(e.onClick,[t,s,this],this)}}function calculateItemSize(i,t,e,s,n){const r=calculateItemWidth(s,i,t,e),a=calculateItemHeight(n,s,t.lineHeight);return{itemWidth:r,itemHeight:a}}function calculateItemWidth(i,t,e,s){let n=i.text;return n&&typeof n!="string"&&(n=n.reduce((r,a)=>r.length>a.length?r:a)),t+e.size/2+s.measureText(n).width}function calculateItemHeight(i,t,e){let s=i;return typeof t.text!="string"&&(s=calculateLegendItemHeight(t,e)),s}function calculateLegendItemHeight(i,t){const e=i.text?i.text.length:0;return t*e}function isListened(i,t){return!!((i==="mousemove"||i==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(i==="click"||i==="mouseup"))}var plugin_legend={id:"legend",_element:Legend,start(i,t,e){const s=i.legend=new Legend({ctx:i.ctx,options:e,chart:i});layouts.configure(i,s,e),layouts.addBox(i,s)},stop(i){layouts.removeBox(i,i.legend),delete i.legend},beforeUpdate(i,t,e){const s=i.legend;layouts.configure(i,s,e),s.options=e},afterUpdate(i){const t=i.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(i,t){t.replay||i.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(i,t,e){const s=t.datasetIndex,n=e.chart;n.isDatasetVisible(s)?(n.hide(s),t.hidden=!0):(n.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:i=>i.chart.options.color,boxWidth:40,padding:10,generateLabels(i){const t=i.data.datasets,{labels:{usePointStyle:e,pointStyle:s,textAlign:n,color:r,useBorderRadius:a,borderRadius:o}}=i.legend.options;return i._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(e?0:void 0),p=toPadding(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:r,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(p.width+p.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:n||c.textAlign,borderRadius:a&&(o||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:i=>i.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:i=>!i.startsWith("on"),labels:{_scriptable:i=>!["generateLabels","filter","sort"].includes(i)}}};class Title extends Element{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const n=isArray(s.text)?s.text.length:1;this._padding=toPadding(s.padding);const r=n*toFont(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:s,bottom:n,right:r,options:a}=this,o=a.align;let l=0,c,p,m;return this.isHorizontal()?(p=_alignStartEnd(o,s,r),m=e+t,c=r-s):(a.position==="left"?(p=s+t,m=_alignStartEnd(o,n,e),l=PI*-.5):(p=r-t,m=_alignStartEnd(o,e,n),l=PI*.5),c=n-e),{titleX:p,titleY:m,maxWidth:c,rotation:l}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const s=toFont(e.font),r=s.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:l,rotation:c}=this._drawArgs(r);renderText(t,e.text,0,0,s,{color:e.color,maxWidth:l,rotation:c,textAlign:_toLeftRightCenter(e.align),textBaseline:"middle",translation:[a,o]})}}function createTitle(i,t){const e=new Title({ctx:i.ctx,options:t,chart:i});layouts.configure(i,e,t),layouts.addBox(i,e),i.titleBlock=e}var plugin_title={id:"title",_element:Title,start(i,t,e){createTitle(i,e)},stop(i){const t=i.titleBlock;layouts.removeBox(i,t),delete i.titleBlock},beforeUpdate(i,t,e){const s=i.titleBlock;layouts.configure(i,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const map=new WeakMap;var plugin_subtitle={id:"subtitle",start(i,t,e){const s=new Title({ctx:i.ctx,options:e,chart:i});layouts.configure(i,s,e),layouts.addBox(i,s),map.set(i,s)},stop(i){layouts.removeBox(i,map.get(i)),map.delete(i)},beforeUpdate(i,t,e){const s=map.get(i);layouts.configure(i,s,e),s.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const positioners={average(i){if(!i.length)return!1;let t,e,s=0,n=0,r=0;for(t=0,e=i.length;t<e;++t){const a=i[t].element;if(a&&a.hasValue()){const o=a.tooltipPosition();s+=o.x,n+=o.y,++r}}return{x:s/r,y:n/r}},nearest(i,t){if(!i.length)return!1;let e=t.x,s=t.y,n=Number.POSITIVE_INFINITY,r,a,o;for(r=0,a=i.length;r<a;++r){const l=i[r].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),p=distanceBetweenPoints(t,c);p<n&&(n=p,o=l)}}if(o){const l=o.tooltipPosition();e=l.x,s=l.y}return{x:e,y:s}}};function pushOrConcat(i,t){return t&&(isArray(t)?Array.prototype.push.apply(i,t):i.push(t)),i}function splitNewlines(i){return(typeof i=="string"||i instanceof String)&&i.indexOf(`
`)>-1?i.split(`
`):i}function createTooltipItem(i,t){const{element:e,datasetIndex:s,index:n}=t,r=i.getDatasetMeta(s).controller,{label:a,value:o}=r.getLabelAndValue(n);return{chart:i,label:a,parsed:r.getParsed(n),raw:i.data.datasets[s].data[n],formattedValue:o,dataset:r.getDataset(),dataIndex:n,datasetIndex:s,element:e}}function getTooltipSize(i,t){const e=i.chart.ctx,{body:s,footer:n,title:r}=i,{boxWidth:a,boxHeight:o}=t,l=toFont(t.bodyFont),c=toFont(t.titleFont),p=toFont(t.footerFont),m=r.length,_=n.length,y=s.length,b=toPadding(t.padding);let u=b.height,g=0,x=s.reduce((h,d)=>h+d.before.length+d.lines.length+d.after.length,0);if(x+=i.beforeBody.length+i.afterBody.length,m&&(u+=m*c.lineHeight+(m-1)*t.titleSpacing+t.titleMarginBottom),x){const h=t.displayColors?Math.max(o,l.lineHeight):l.lineHeight;u+=y*h+(x-y)*l.lineHeight+(x-1)*t.bodySpacing}_&&(u+=t.footerMarginTop+_*p.lineHeight+(_-1)*t.footerSpacing);let P=0;const A=function(h){g=Math.max(g,e.measureText(h).width+P)};return e.save(),e.font=c.string,each(i.title,A),e.font=l.string,each(i.beforeBody.concat(i.afterBody),A),P=t.displayColors?a+2+t.boxPadding:0,each(s,h=>{each(h.before,A),each(h.lines,A),each(h.after,A)}),P=0,e.font=p.string,each(i.footer,A),e.restore(),g+=b.width,{width:g,height:u}}function determineYAlign(i,t){const{y:e,height:s}=t;return e<s/2?"top":e>i.height-s/2?"bottom":"center"}function doesNotFitWithAlign(i,t,e,s){const{x:n,width:r}=s,a=e.caretSize+e.caretPadding;if(i==="left"&&n+r+a>t.width||i==="right"&&n-r-a<0)return!0}function determineXAlign(i,t,e,s){const{x:n,width:r}=e,{width:a,chartArea:{left:o,right:l}}=i;let c="center";return s==="center"?c=n<=(o+l)/2?"left":"right":n<=r/2?c="left":n>=a-r/2&&(c="right"),doesNotFitWithAlign(c,i,t,e)&&(c="center"),c}function determineAlignment(i,t,e){const s=e.yAlign||t.yAlign||determineYAlign(i,e);return{xAlign:e.xAlign||t.xAlign||determineXAlign(i,t,e,s),yAlign:s}}function alignX(i,t){let{x:e,width:s}=i;return t==="right"?e-=s:t==="center"&&(e-=s/2),e}function alignY(i,t,e){let{y:s,height:n}=i;return t==="top"?s+=e:t==="bottom"?s-=n+e:s-=n/2,s}function getBackgroundPoint(i,t,e,s){const{caretSize:n,caretPadding:r,cornerRadius:a}=i,{xAlign:o,yAlign:l}=e,c=n+r,{topLeft:p,topRight:m,bottomLeft:_,bottomRight:y}=toTRBLCorners(a);let b=alignX(t,o);const u=alignY(t,l,c);return l==="center"?o==="left"?b+=c:o==="right"&&(b-=c):o==="left"?b-=Math.max(p,_)+n:o==="right"&&(b+=Math.max(m,y)+n),{x:_limitValue(b,0,s.width-t.width),y:_limitValue(u,0,s.height-t.height)}}function getAlignedX(i,t,e){const s=toPadding(e.padding);return t==="center"?i.x+i.width/2:t==="right"?i.x+i.width-s.right:i.x+s.left}function getBeforeAfterBodyLines(i){return pushOrConcat([],splitNewlines(i))}function createTooltipContext(i,t,e){return createContext(i,{tooltip:t,tooltipItems:e,type:"tooltip"})}function overrideCallbacks(i,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?i.override(e):i}const defaultCallbacks={beforeTitle:noop,title(i){if(i.length>0){const t=i[0],e=t.chart.data.labels,s=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return e[t.dataIndex]}return""},afterTitle:noop,beforeBody:noop,beforeLabel:noop,label(i){if(this&&this.options&&this.options.mode==="dataset")return i.label+": "+i.formattedValue||i.formattedValue;let t=i.dataset.label||"";t&&(t+=": ");const e=i.formattedValue;return isNullOrUndef(e)||(t+=e),t},labelColor(i){const e=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){const e=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:noop,afterBody:noop,beforeFooter:noop,footer:noop,afterFooter:noop};function invokeCallbackWithFallback(i,t,e,s){const n=i[t].call(e,s);return typeof n>"u"?defaultCallbacks[t].call(e,s):n}class Tooltip extends Element{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,s=this.options.setContext(this.getContext()),n=s.enabled&&e.options.animation&&s.animations,r=new Animations(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=createTooltipContext(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:s}=e,n=invokeCallbackWithFallback(s,"beforeTitle",this,t),r=invokeCallbackWithFallback(s,"title",this,t),a=invokeCallbackWithFallback(s,"afterTitle",this,t);let o=[];return o=pushOrConcat(o,splitNewlines(n)),o=pushOrConcat(o,splitNewlines(r)),o=pushOrConcat(o,splitNewlines(a)),o}getBeforeBody(t,e){return getBeforeAfterBodyLines(invokeCallbackWithFallback(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:s}=e,n=[];return each(t,r=>{const a={before:[],lines:[],after:[]},o=overrideCallbacks(s,r);pushOrConcat(a.before,splitNewlines(invokeCallbackWithFallback(o,"beforeLabel",this,r))),pushOrConcat(a.lines,invokeCallbackWithFallback(o,"label",this,r)),pushOrConcat(a.after,splitNewlines(invokeCallbackWithFallback(o,"afterLabel",this,r))),n.push(a)}),n}getAfterBody(t,e){return getBeforeAfterBodyLines(invokeCallbackWithFallback(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:s}=e,n=invokeCallbackWithFallback(s,"beforeFooter",this,t),r=invokeCallbackWithFallback(s,"footer",this,t),a=invokeCallbackWithFallback(s,"afterFooter",this,t);let o=[];return o=pushOrConcat(o,splitNewlines(n)),o=pushOrConcat(o,splitNewlines(r)),o=pushOrConcat(o,splitNewlines(a)),o}_createItems(t){const e=this._active,s=this.chart.data,n=[],r=[],a=[];let o=[],l,c;for(l=0,c=e.length;l<c;++l)o.push(createTooltipItem(this.chart,e[l]));return t.filter&&(o=o.filter((p,m,_)=>t.filter(p,m,_,s))),t.itemSort&&(o=o.sort((p,m)=>t.itemSort(p,m,s))),each(o,p=>{const m=overrideCallbacks(t.callbacks,p);n.push(invokeCallbackWithFallback(m,"labelColor",this,p)),r.push(invokeCallbackWithFallback(m,"labelPointStyle",this,p)),a.push(invokeCallbackWithFallback(m,"labelTextColor",this,p))}),this.labelColors=n,this.labelPointStyles=r,this.labelTextColors=a,this.dataPoints=o,o}update(t,e){const s=this.options.setContext(this.getContext()),n=this._active;let r,a=[];if(!n.length)this.opacity!==0&&(r={opacity:0});else{const o=positioners[s.position].call(this,n,this._eventPosition);a=this._createItems(s),this.title=this.getTitle(a,s),this.beforeBody=this.getBeforeBody(a,s),this.body=this.getBody(a,s),this.afterBody=this.getAfterBody(a,s),this.footer=this.getFooter(a,s);const l=this._size=getTooltipSize(this,s),c=Object.assign({},o,l),p=determineAlignment(this.chart,s,c),m=getBackgroundPoint(s,c,p,this.chart);this.xAlign=p.xAlign,this.yAlign=p.yAlign,r={opacity:1,x:m.x,y:m.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,s,n){const r=this.getCaretPosition(t,s,n);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,s){const{xAlign:n,yAlign:r}=this,{caretSize:a,cornerRadius:o}=s,{topLeft:l,topRight:c,bottomLeft:p,bottomRight:m}=toTRBLCorners(o),{x:_,y}=t,{width:b,height:u}=e;let g,x,P,A,h,d;return r==="center"?(h=y+u/2,n==="left"?(g=_,x=g-a,A=h+a,d=h-a):(g=_+b,x=g+a,A=h-a,d=h+a),P=g):(n==="left"?x=_+Math.max(l,p)+a:n==="right"?x=_+b-Math.max(c,m)-a:x=this.caretX,r==="top"?(A=y,h=A-a,g=x-a,P=x+a):(A=y+u,h=A+a,g=x+a,P=x-a),d=A),{x1:g,x2:x,x3:P,y1:A,y2:h,y3:d}}drawTitle(t,e,s){const n=this.title,r=n.length;let a,o,l;if(r){const c=getRtlAdapter(s.rtl,this.x,this.width);for(t.x=getAlignedX(this,s.titleAlign,s),e.textAlign=c.textAlign(s.titleAlign),e.textBaseline="middle",a=toFont(s.titleFont),o=s.titleSpacing,e.fillStyle=s.titleColor,e.font=a.string,l=0;l<r;++l)e.fillText(n[l],c.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+o,l+1===r&&(t.y+=s.titleMarginBottom-o)}}_drawColorBox(t,e,s,n,r){const a=this.labelColors[s],o=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=r,p=toFont(r.bodyFont),m=getAlignedX(this,"left",r),_=n.x(m),y=l<p.lineHeight?(p.lineHeight-l)/2:0,b=e.y+y;if(r.usePointStyle){const u={radius:Math.min(c,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},g=n.leftForLtr(_,c)+c/2,x=b+l/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,drawPoint(t,u,g,x),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,drawPoint(t,u,g,x)}else{t.lineWidth=isObject(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const u=n.leftForLtr(_,c),g=n.leftForLtr(n.xPlus(_,1),c-2),x=toTRBLCorners(a.borderRadius);Object.values(x).some(P=>P!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,addRoundedRectPath(t,{x:u,y:b,w:c,h:l,radius:x}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),addRoundedRectPath(t,{x:g,y:b+1,w:c-2,h:l-2,radius:x}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(u,b,c,l),t.strokeRect(u,b,c,l),t.fillStyle=a.backgroundColor,t.fillRect(g,b+1,c-2,l-2))}t.fillStyle=this.labelTextColors[s]}drawBody(t,e,s){const{body:n}=this,{bodySpacing:r,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:c,boxPadding:p}=s,m=toFont(s.bodyFont);let _=m.lineHeight,y=0;const b=getRtlAdapter(s.rtl,this.x,this.width),u=function(w){e.fillText(w,b.x(t.x+y),t.y+_/2),t.y+=_+r},g=b.textAlign(a);let x,P,A,h,d,f,v;for(e.textAlign=a,e.textBaseline="middle",e.font=m.string,t.x=getAlignedX(this,g,s),e.fillStyle=s.bodyColor,each(this.beforeBody,u),y=o&&g!=="right"?a==="center"?c/2+p:c+2+p:0,h=0,f=n.length;h<f;++h){for(x=n[h],P=this.labelTextColors[h],e.fillStyle=P,each(x.before,u),A=x.lines,o&&A.length&&(this._drawColorBox(e,t,h,b,s),_=Math.max(m.lineHeight,l)),d=0,v=A.length;d<v;++d)u(A[d]),_=m.lineHeight;each(x.after,u)}y=0,_=m.lineHeight,each(this.afterBody,u),t.y-=r}drawFooter(t,e,s){const n=this.footer,r=n.length;let a,o;if(r){const l=getRtlAdapter(s.rtl,this.x,this.width);for(t.x=getAlignedX(this,s.footerAlign,s),t.y+=s.footerMarginTop,e.textAlign=l.textAlign(s.footerAlign),e.textBaseline="middle",a=toFont(s.footerFont),e.fillStyle=s.footerColor,e.font=a.string,o=0;o<r;++o)e.fillText(n[o],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+s.footerSpacing}}drawBackground(t,e,s,n){const{xAlign:r,yAlign:a}=this,{x:o,y:l}=t,{width:c,height:p}=s,{topLeft:m,topRight:_,bottomLeft:y,bottomRight:b}=toTRBLCorners(n.cornerRadius);e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.beginPath(),e.moveTo(o+m,l),a==="top"&&this.drawCaret(t,e,s,n),e.lineTo(o+c-_,l),e.quadraticCurveTo(o+c,l,o+c,l+_),a==="center"&&r==="right"&&this.drawCaret(t,e,s,n),e.lineTo(o+c,l+p-b),e.quadraticCurveTo(o+c,l+p,o+c-b,l+p),a==="bottom"&&this.drawCaret(t,e,s,n),e.lineTo(o+y,l+p),e.quadraticCurveTo(o,l+p,o,l+p-y),a==="center"&&r==="left"&&this.drawCaret(t,e,s,n),e.lineTo(o,l+m),e.quadraticCurveTo(o,l,o+m,l),e.closePath(),e.fill(),n.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,s=this.$animations,n=s&&s.x,r=s&&s.y;if(n||r){const a=positioners[t.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=getTooltipSize(this,t),l=Object.assign({},a,this._size),c=determineAlignment(e,t,l),p=getBackgroundPoint(t,l,c,e);(n._to!==p.x||r._to!==p.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,p))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(e);const n={width:this.width,height:this.height},r={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const a=toPadding(e.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&o&&(t.save(),t.globalAlpha=s,this.drawBackground(r,t,n,e),overrideTextDirection(t,e.textDirection),r.y+=a.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),restoreTextDirection(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const s=this._active,n=t.map(({datasetIndex:o,index:l})=>{const c=this.chart.getDatasetMeta(o);if(!c)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:c.data[l],index:l}}),r=!_elementsEqual(s,n),a=this._positionChanged(n,e);(r||a)&&(this._active=n,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,s=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,r=this._active||[],a=this._getActiveElements(t,r,e,s),o=this._positionChanged(a,t),l=e||!_elementsEqual(a,r)||o;return l&&(this._active=a,(n.enabled||n.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),l}_getActiveElements(t,e,s,n){const r=this.options;if(t.type==="mouseout")return[];if(!n)return e;const a=this.chart.getElementsAtEventForMode(t,r.mode,r,s);return r.reverse&&a.reverse(),a}_positionChanged(t,e){const{caretX:s,caretY:n,options:r}=this,a=positioners[r.position].call(this,t,e);return a!==!1&&(s!==a.x||n!==a.y)}}ft(Tooltip,"positioners",positioners);var plugin_tooltip={id:"tooltip",_element:Tooltip,positioners,afterInit(i,t,e){e&&(i.tooltip=new Tooltip({chart:i,options:e}))},beforeUpdate(i,t,e){i.tooltip&&i.tooltip.initialize(e)},reset(i,t,e){i.tooltip&&i.tooltip.initialize(e)},afterDraw(i){const t=i.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(i.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",e)}},afterEvent(i,t){if(i.tooltip){const e=t.replay;i.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,t)=>t.bodyFont.size,boxWidth:(i,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:defaultCallbacks},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>i!=="filter"&&i!=="itemSort"&&i!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},plugins=Object.freeze({__proto__:null,Colors:plugin_colors,Decimation:plugin_decimation,Filler:index,Legend:plugin_legend,SubTitle:plugin_subtitle,Title:plugin_title,Tooltip:plugin_tooltip});const addIfString=(i,t,e,s)=>(typeof t=="string"?(e=i.push(t)-1,s.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function findOrAddLabel(i,t,e,s){const n=i.indexOf(t);if(n===-1)return addIfString(i,t,e,s);const r=i.lastIndexOf(t);return n!==r?e:n}const validIndex=(i,t)=>i===null?null:_limitValue(Math.round(i),0,t);function _getLabelForValue(i){const t=this.getLabels();return i>=0&&i<t.length?t[i]:i}class CategoryScale extends Scale{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const s=this.getLabels();for(const{index:n,label:r}of e)s[n]===r&&s.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(isNullOrUndef(t))return null;const s=this.getLabels();return e=isFinite(e)&&s[e]===t?e:findOrAddLabel(s,t,valueOrDefault(e,t),this._addedLabels),validIndex(e,s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:s,max:n}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(s=0),e||(n=this.getLabels().length-1)),this.min=s,this.max=n}buildTicks(){const t=this.min,e=this.max,s=this.options.offset,n=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let a=t;a<=e;a++)n.push({value:a});return n}getLabelForValue(t){return _getLabelForValue.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}ft(CategoryScale,"id","category"),ft(CategoryScale,"defaults",{ticks:{callback:_getLabelForValue}});function generateTicks$1(i,t){const e=[],{bounds:n,step:r,min:a,max:o,precision:l,count:c,maxTicks:p,maxDigits:m,includeBounds:_}=i,y=r||1,b=p-1,{min:u,max:g}=t,x=!isNullOrUndef(a),P=!isNullOrUndef(o),A=!isNullOrUndef(c),h=(g-u)/(m+1);let d=niceNum((g-u)/b/y)*y,f,v,w,C;if(d<1e-14&&!x&&!P)return[{value:u},{value:g}];C=Math.ceil(g/d)-Math.floor(u/d),C>b&&(d=niceNum(C*d/b/y)*y),isNullOrUndef(l)||(f=Math.pow(10,l),d=Math.ceil(d*f)/f),n==="ticks"?(v=Math.floor(u/d)*d,w=Math.ceil(g/d)*d):(v=u,w=g),x&&P&&r&&almostWhole((o-a)/r,d/1e3)?(C=Math.round(Math.min((o-a)/d,p)),d=(o-a)/C,v=a,w=o):A?(v=x?a:v,w=P?o:w,C=c-1,d=(w-v)/C):(C=(w-v)/d,almostEquals(C,Math.round(C),d/1e3)?C=Math.round(C):C=Math.ceil(C));const k=Math.max(_decimalPlaces(d),_decimalPlaces(v));f=Math.pow(10,isNullOrUndef(l)?k:l),v=Math.round(v*f)/f,w=Math.round(w*f)/f;let R=0;for(x&&(_&&v!==a?(e.push({value:a}),v<a&&R++,almostEquals(Math.round((v+R*d)*f)/f,a,relativeLabelSize(a,h,i))&&R++):v<a&&R++);R<C;++R){const H=Math.round((v+R*d)*f)/f;if(P&&H>o)break;e.push({value:H})}return P&&_&&w!==o?e.length&&almostEquals(e[e.length-1].value,o,relativeLabelSize(o,h,i))?e[e.length-1].value=o:e.push({value:o}):(!P||w===o)&&e.push({value:w}),e}function relativeLabelSize(i,t,{horizontal:e,minRotation:s}){const n=toRadians(s),r=(e?Math.sin(n):Math.cos(n))||.001,a=.75*t*(""+i).length;return Math.min(t/r,a)}class LinearScaleBase extends Scale{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return isNullOrUndef(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:s}=this.getUserBounds();let{min:n,max:r}=this;const a=l=>n=e?n:l,o=l=>r=s?r:l;if(t){const l=sign(n),c=sign(r);l<0&&c<0?o(0):l>0&&c>0&&a(0)}if(n===r){let l=r===0?1:Math.abs(r*.05);o(r+l),t||a(n-l)}this.min=n,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:s}=t,n;return s?(n=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,n>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${n} ticks. Limiting to 1000.`),n=1e3)):(n=this.computeTickLimit(),e=e||11),e&&(n=Math.min(e,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const n={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,a=generateTicks$1(n,r);return t.bounds==="ticks"&&_setMinAndMaxByKey(a,this,"value"),t.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const t=this.ticks;let e=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){const n=(s-e)/Math.max(t.length-1,1)/2;e-=n,s+=n}this._startValue=e,this._endValue=s,this._valueRange=s-e}getLabelForValue(t){return formatNumber(t,this.chart.options.locale,this.options.ticks.format)}}class LinearScale extends LinearScaleBase{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=isNumberFinite(t)?t:0,this.max=isNumberFinite(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,s=toRadians(this.options.ticks.minRotation),n=(t?Math.sin(s):Math.cos(s))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/n))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}ft(LinearScale,"id","linear"),ft(LinearScale,"defaults",{ticks:{callback:Ticks.formatters.numeric}});const log10Floor=i=>Math.floor(log10(i)),changeExponent=(i,t)=>Math.pow(10,log10Floor(i)+t);function isMajor(i){return i/Math.pow(10,log10Floor(i))===1}function steps(i,t,e){const s=Math.pow(10,e),n=Math.floor(i/s);return Math.ceil(t/s)-n}function startExp(i,t){const e=t-i;let s=log10Floor(e);for(;steps(i,t,s)>10;)s++;for(;steps(i,t,s)<10;)s--;return Math.min(s,log10Floor(i))}function generateTicks(i,{min:t,max:e}){t=finiteOrDefault(i.min,t);const s=[],n=log10Floor(t);let r=startExp(t,e),a=r<0?Math.pow(10,Math.abs(r)):1;const o=Math.pow(10,r),l=n>r?Math.pow(10,n):0,c=Math.round((t-l)*a)/a,p=Math.floor((t-l)/o/10)*o*10;let m=Math.floor((c-p)/Math.pow(10,r)),_=finiteOrDefault(i.min,Math.round((l+p+m*Math.pow(10,r))*a)/a);for(;_<e;)s.push({value:_,major:isMajor(_),significand:m}),m>=10?m=m<15?15:20:m++,m>=20&&(r++,m=2,a=r>=0?1:a),_=Math.round((l+p+m*Math.pow(10,r))*a)/a;const y=finiteOrDefault(i.max,_);return s.push({value:y,major:isMajor(y),significand:m}),s}class LogarithmicScale extends Scale{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const s=LinearScaleBase.prototype.parse.apply(this,[t,e]);if(s===0){this._zero=!0;return}return isNumberFinite(s)&&s>0?s:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=isNumberFinite(t)?Math.max(0,t):null,this.max=isNumberFinite(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!isNumberFinite(this._userMin)&&(this.min=t===changeExponent(this.min,0)?changeExponent(this.min,-1):changeExponent(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let s=this.min,n=this.max;const r=o=>s=t?s:o,a=o=>n=e?n:o;s===n&&(s<=0?(r(1),a(10)):(r(changeExponent(s,-1)),a(changeExponent(n,1)))),s<=0&&r(changeExponent(n,-1)),n<=0&&a(changeExponent(s,1)),this.min=s,this.max=n}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},s=generateTicks(e,this);return t.bounds==="ticks"&&_setMinAndMaxByKey(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":formatNumber(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=log10(t),this._valueRange=log10(this.max)-log10(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(log10(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}ft(LogarithmicScale,"id","logarithmic"),ft(LogarithmicScale,"defaults",{ticks:{callback:Ticks.formatters.logarithmic,major:{enabled:!0}}});function getTickBackdropHeight(i){const t=i.ticks;if(t.display&&i.display){const e=toPadding(t.backdropPadding);return valueOrDefault(t.font&&t.font.size,defaults.font.size)+e.height}return 0}function measureLabelSize(i,t,e){return e=isArray(e)?e:[e],{w:_longestText(i,t.string,e),h:e.length*t.lineHeight}}function determineLimits(i,t,e,s,n){return i===s||i===n?{start:t-e/2,end:t+e/2}:i<s||i>n?{start:t-e,end:t}:{start:t,end:t+e}}function fitWithPointLabels(i){const t={l:i.left+i._padding.left,r:i.right-i._padding.right,t:i.top+i._padding.top,b:i.bottom-i._padding.bottom},e=Object.assign({},t),s=[],n=[],r=i._pointLabels.length,a=i.options.pointLabels,o=a.centerPointLabels?PI/r:0;for(let l=0;l<r;l++){const c=a.setContext(i.getPointLabelContext(l));n[l]=c.padding;const p=i.getPointPosition(l,i.drawingArea+n[l],o),m=toFont(c.font),_=measureLabelSize(i.ctx,m,i._pointLabels[l]);s[l]=_;const y=_normalizeAngle(i.getIndexAngle(l)+o),b=Math.round(toDegrees(y)),u=determineLimits(b,p.x,_.w,0,180),g=determineLimits(b,p.y,_.h,90,270);updateLimits(e,t,y,u,g)}i.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),i._pointLabelItems=buildPointLabelItems(i,s,n)}function updateLimits(i,t,e,s,n){const r=Math.abs(Math.sin(e)),a=Math.abs(Math.cos(e));let o=0,l=0;s.start<t.l?(o=(t.l-s.start)/r,i.l=Math.min(i.l,t.l-o)):s.end>t.r&&(o=(s.end-t.r)/r,i.r=Math.max(i.r,t.r+o)),n.start<t.t?(l=(t.t-n.start)/a,i.t=Math.min(i.t,t.t-l)):n.end>t.b&&(l=(n.end-t.b)/a,i.b=Math.max(i.b,t.b+l))}function createPointLabelItem(i,t,e){const s=i.drawingArea,{extra:n,additionalAngle:r,padding:a,size:o}=e,l=i.getPointPosition(t,s+n+a,r),c=Math.round(toDegrees(_normalizeAngle(l.angle+HALF_PI))),p=yForAngle(l.y,o.h,c),m=getTextAlignForAngle(c),_=leftForTextAlign(l.x,o.w,m);return{visible:!0,x:l.x,y:p,textAlign:m,left:_,top:p,right:_+o.w,bottom:p+o.h}}function isNotOverlapped(i,t){if(!t)return!0;const{left:e,top:s,right:n,bottom:r}=i;return!(_isPointInArea({x:e,y:s},t)||_isPointInArea({x:e,y:r},t)||_isPointInArea({x:n,y:s},t)||_isPointInArea({x:n,y:r},t))}function buildPointLabelItems(i,t,e){const s=[],n=i._pointLabels.length,r=i.options,{centerPointLabels:a,display:o}=r.pointLabels,l={extra:getTickBackdropHeight(r)/2,additionalAngle:a?PI/n:0};let c;for(let p=0;p<n;p++){l.padding=e[p],l.size=t[p];const m=createPointLabelItem(i,p,l);s.push(m),o==="auto"&&(m.visible=isNotOverlapped(m,c),m.visible&&(c=m))}return s}function getTextAlignForAngle(i){return i===0||i===180?"center":i<180?"left":"right"}function leftForTextAlign(i,t,e){return e==="right"?i-=t:e==="center"&&(i-=t/2),i}function yForAngle(i,t,e){return e===90||e===270?i-=t/2:(e>270||e<90)&&(i-=t),i}function drawPointLabelBox(i,t,e){const{left:s,top:n,right:r,bottom:a}=e,{backdropColor:o}=t;if(!isNullOrUndef(o)){const l=toTRBLCorners(t.borderRadius),c=toPadding(t.backdropPadding);i.fillStyle=o;const p=s-c.left,m=n-c.top,_=r-s+c.width,y=a-n+c.height;Object.values(l).some(b=>b!==0)?(i.beginPath(),addRoundedRectPath(i,{x:p,y:m,w:_,h:y,radius:l}),i.fill()):i.fillRect(p,m,_,y)}}function drawPointLabels(i,t){const{ctx:e,options:{pointLabels:s}}=i;for(let n=t-1;n>=0;n--){const r=i._pointLabelItems[n];if(!r.visible)continue;const a=s.setContext(i.getPointLabelContext(n));drawPointLabelBox(e,a,r);const o=toFont(a.font),{x:l,y:c,textAlign:p}=r;renderText(e,i._pointLabels[n],l,c+o.lineHeight/2,o,{color:a.color,textAlign:p,textBaseline:"middle"})}}function pathRadiusLine(i,t,e,s){const{ctx:n}=i;if(e)n.arc(i.xCenter,i.yCenter,t,0,TAU);else{let r=i.getPointPosition(0,t);n.moveTo(r.x,r.y);for(let a=1;a<s;a++)r=i.getPointPosition(a,t),n.lineTo(r.x,r.y)}}function drawRadiusLine(i,t,e,s,n){const r=i.ctx,a=t.circular,{color:o,lineWidth:l}=t;!a&&!s||!o||!l||e<0||(r.save(),r.strokeStyle=o,r.lineWidth=l,r.setLineDash(n.dash),r.lineDashOffset=n.dashOffset,r.beginPath(),pathRadiusLine(i,e,a,s),r.closePath(),r.stroke(),r.restore())}function createPointLabelContext(i,t,e){return createContext(i,{label:e,index:t,type:"pointLabel"})}class RadialLinearScale extends LinearScaleBase{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=toPadding(getTickBackdropHeight(this.options)/2),e=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(e,s)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=isNumberFinite(t)&&!isNaN(t)?t:0,this.max=isNumberFinite(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options))}generateTickLabels(t){LinearScaleBase.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,s)=>{const n=callback(this.options.pointLabels.callback,[e,s],this);return n||n===0?n:""}).filter((e,s)=>this.chart.getDataVisibility(s))}fit(){const t=this.options;t.display&&t.pointLabels.display?fitWithPointLabels(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,s,n){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((s-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,s,n))}getIndexAngle(t){const e=TAU/(this._pointLabels.length||1),s=this.options.startAngle||0;return _normalizeAngle(t*e+toRadians(s))}getDistanceFromCenterForValue(t){if(isNullOrUndef(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(isNullOrUndef(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const s=e[t];return createPointLabelContext(this.getContext(),t,s)}}getPointPosition(t,e,s=0){const n=this.getIndexAngle(t)-HALF_PI+s;return{x:Math.cos(n)*e+this.xCenter,y:Math.sin(n)*e+this.yCenter,angle:n}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:s,right:n,bottom:r}=this._pointLabelItems[t];return{left:e,top:s,right:n,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const s=this.ctx;s.save(),s.beginPath(),pathRadiusLine(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:s,grid:n,border:r}=e,a=this._pointLabels.length;let o,l,c;if(e.pointLabels.display&&drawPointLabels(this,a),n.display&&this.ticks.forEach((p,m)=>{if(m!==0){l=this.getDistanceFromCenterForValue(p.value);const _=this.getContext(m),y=n.setContext(_),b=r.setContext(_);drawRadiusLine(this,y,l,a,b)}}),s.display){for(t.save(),o=a-1;o>=0;o--){const p=s.setContext(this.getPointLabelContext(o)),{color:m,lineWidth:_}=p;!_||!m||(t.lineWidth=_,t.strokeStyle=m,t.setLineDash(p.borderDash),t.lineDashOffset=p.borderDashOffset,l=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),c=this.getPointPosition(o,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,s=e.ticks;if(!s.display)return;const n=this.getIndexAngle(0);let r,a;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(n),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((o,l)=>{if(l===0&&!e.reverse)return;const c=s.setContext(this.getContext(l)),p=toFont(c.font);if(r=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=p.string,a=t.measureText(o.label).width,t.fillStyle=c.backdropColor;const m=toPadding(c.backdropPadding);t.fillRect(-a/2-m.left,-r-p.size/2-m.top,a+m.width,p.size+m.height)}renderText(t,o.label,0,-r,p,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}}ft(RadialLinearScale,"id","radialLinear"),ft(RadialLinearScale,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Ticks.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}}),ft(RadialLinearScale,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),ft(RadialLinearScale,"descriptors",{angleLines:{_fallback:"grid"}});const INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(i,t){return i-t}function parse(i,t){if(isNullOrUndef(t))return null;const e=i._adapter,{parser:s,round:n,isoWeekday:r}=i._parseOpts;let a=t;return typeof s=="function"&&(a=s(a)),isNumberFinite(a)||(a=typeof s=="string"?e.parse(a,s):e.parse(a)),a===null?null:(n&&(a=n==="week"&&(isNumber(r)||r===!0)?e.startOf(a,"isoWeek",r):e.startOf(a,n)),+a)}function determineUnitForAutoTicks(i,t,e,s){const n=UNITS.length;for(let r=UNITS.indexOf(i);r<n-1;++r){const a=INTERVALS[UNITS[r]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((e-t)/(o*a.size))<=s)return UNITS[r]}return UNITS[n-1]}function determineUnitForFormatting(i,t,e,s,n){for(let r=UNITS.length-1;r>=UNITS.indexOf(e);r--){const a=UNITS[r];if(INTERVALS[a].common&&i._adapter.diff(n,s,a)>=t-1)return a}return UNITS[e?UNITS.indexOf(e):0]}function determineMajorUnit(i){for(let t=UNITS.indexOf(i)+1,e=UNITS.length;t<e;++t)if(INTERVALS[UNITS[t]].common)return UNITS[t]}function addTick(i,t,e){if(!e)i[t]=!0;else if(e.length){const{lo:s,hi:n}=_lookup(e,t),r=e[s]>=t?e[s]:e[n];i[r]=!0}}function setMajorTicks(i,t,e,s){const n=i._adapter,r=+n.startOf(t[0].value,s),a=t[t.length-1].value;let o,l;for(o=r;o<=a;o=+n.add(o,1,s))l=e[o],l>=0&&(t[l].major=!0);return t}function ticksFromTimestamps(i,t,e){const s=[],n={},r=t.length;let a,o;for(a=0;a<r;++a)o=t[a],n[o]=a,s.push({value:o,major:!1});return r===0||!e?s:setMajorTicks(i,s,n,e)}class TimeScale extends Scale{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const s=t.time||(t.time={}),n=this._adapter=new adapters._date(t.adapters.date);n.init(e),mergeIf(s.displayFormats,n.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:parse(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,s=t.time.unit||"day";let{min:n,max:r,minDefined:a,maxDefined:o}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(n=Math.min(n,c.min)),!o&&!isNaN(c.max)&&(r=Math.max(r,c.max))}(!a||!o)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),n=isNumberFinite(n)&&!isNaN(n)?n:+e.startOf(Date.now(),s),r=isNumberFinite(r)&&!isNaN(r)?r:+e.endOf(Date.now(),s)+1,this.min=Math.min(n,r-1),this.max=Math.max(n+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],s=t[t.length-1]),{min:e,max:s}}buildTicks(){const t=this.options,e=t.time,s=t.ticks,n=s.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const r=this.min,a=this.max,o=_filterBetween(n,r,a);return this._unit=e.unit||(s.autoSkip?determineUnitForAutoTicks(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):determineUnitForFormatting(this,o.length,e.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:determineMajorUnit(this._unit),this.initOffsets(n),t.reverse&&o.reverse(),ticksFromTimestamps(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,s=0,n,r;this.options.offset&&t.length&&(n=this.getDecimalForValue(t[0]),t.length===1?e=1-n:e=(this.getDecimalForValue(t[1])-n)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?s=r:s=(r-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;e=_limitValue(e,0,a),s=_limitValue(s,0,a),this._offsets={start:e,end:s,factor:1/(e+1+s)}}_generate(){const t=this._adapter,e=this.min,s=this.max,n=this.options,r=n.time,a=r.unit||determineUnitForAutoTicks(r.minUnit,e,s,this._getLabelCapacity(e)),o=valueOrDefault(n.ticks.stepSize,1),l=a==="week"?r.isoWeekday:!1,c=isNumber(l)||l===!0,p={};let m=e,_,y;if(c&&(m=+t.startOf(m,"isoWeek",l)),m=+t.startOf(m,c?"day":a),t.diff(s,e,a)>1e5*o)throw new Error(e+" and "+s+" are too far apart with stepSize of "+o+" "+a);const b=n.ticks.source==="data"&&this.getDataTimestamps();for(_=m,y=0;_<s;_=+t.add(_,o,a),y++)addTick(p,_,b);return(_===s||n.bounds==="ticks"||y===1)&&addTick(p,_,b),Object.keys(p).sort(sorter).map(u=>+u)}getLabelForValue(t){const e=this._adapter,s=this.options.time;return s.tooltipFormat?e.format(t,s.tooltipFormat):e.format(t,s.displayFormats.datetime)}format(t,e){const n=this.options.time.displayFormats,r=this._unit,a=e||n[r];return this._adapter.format(t,a)}_tickFormatFunction(t,e,s,n){const r=this.options,a=r.ticks.callback;if(a)return callback(a,[t,e,s],this);const o=r.time.displayFormats,l=this._unit,c=this._majorUnit,p=l&&o[l],m=c&&o[c],_=s[e],y=c&&m&&_&&_.major;return this._adapter.format(t,n||(y?m:p))}generateTickLabels(t){let e,s,n;for(e=0,s=t.length;e<s;++e)n=t[e],n.label=this._tickFormatFunction(n.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,s=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+s)*e.factor)}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+s*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,s=this.ctx.measureText(t).width,n=toRadians(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(n),a=Math.sin(n),o=this._resolveTickFontOptions(0).size;return{w:s*r+o*a,h:s*a+o*r}}_getLabelCapacity(t){const e=this.options.time,s=e.displayFormats,n=s[e.unit]||s.millisecond,r=this._tickFormatFunction(t,0,ticksFromTimestamps(this,[t],this._majorUnit),n),a=this._getLabelSize(r),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let t=this._cache.data||[],e,s;if(t.length)return t;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(e=0,s=n.length;e<s;++e)t=t.concat(n[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,s;if(t.length)return t;const n=this.getLabels();for(e=0,s=n.length;e<s;++e)t.push(parse(this,n[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return _arrayUnique(t.sort(sorter))}}ft(TimeScale,"id","time"),ft(TimeScale,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function interpolate(i,t,e){let s=0,n=i.length-1,r,a,o,l;e?(t>=i[s].pos&&t<=i[n].pos&&({lo:s,hi:n}=_lookupByKey(i,"pos",t)),{pos:r,time:o}=i[s],{pos:a,time:l}=i[n]):(t>=i[s].time&&t<=i[n].time&&({lo:s,hi:n}=_lookupByKey(i,"time",t)),{time:r,pos:o}=i[s],{time:a,pos:l}=i[n]);const c=a-r;return c?o+(l-o)*(t-r)/c:o}class TimeSeriesScale extends TimeScale{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=interpolate(e,this.min),this._tableRange=interpolate(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:s}=this,n=[],r=[];let a,o,l,c,p;for(a=0,o=t.length;a<o;++a)c=t[a],c>=e&&c<=s&&n.push(c);if(n.length<2)return[{time:e,pos:0},{time:s,pos:1}];for(a=0,o=n.length;a<o;++a)p=n[a+1],l=n[a-1],c=n[a],Math.round((p+l)/2)!==c&&r.push({time:c,pos:a/(o-1)});return r}_generate(){const t=this.min,e=this.max;let s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(e)||s.length===1)&&s.push(e),s.sort((n,r)=>n-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),s=this.getLabelTimestamps();return e.length&&s.length?t=this.normalize(e.concat(s)):t=e.length?e:s,t=this._cache.all=t,t}getDecimalForValue(t){return(interpolate(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,s=this.getDecimalForPixel(t)/e.factor-e.end;return interpolate(this._table,s*this._tableRange+this._minPos,!0)}}ft(TimeSeriesScale,"id","timeseries"),ft(TimeSeriesScale,"defaults",TimeScale.defaults);var scales=Object.freeze({__proto__:null,CategoryScale,LinearScale,LogarithmicScale,RadialLinearScale,TimeScale,TimeSeriesScale});const registerables=[controllers,elements,plugins,scales];Chart.register(...registerables);const ModalSpecieComponent_vue_vue_type_style_index_0_scoped_6922332a_lang="",FlowerCalendar_vue_vue_type_style_index_0_scoped_eb85c6cf_lang="",FruitCalendar_vue_vue_type_style_index_0_scoped_28dedf67_lang="",specieSoughtView_vue_vue_type_style_index_0_scoped_db6f83a8_lang="",_withScopeId=i=>(pushScopeId("data-v-db6f83a8"),i=i(),popScopeId(),i),_hoisted_1=_withScopeId(()=>createBaseVNode("div",{class:"shadow"},null,-1)),_hoisted_2={class:"sought__content"},_hoisted_3=["src","alt"],_hoisted_4={class:"sought__nav"},pageWidth=600,pageHeight=800,_sfc_main={__name:"specieSoughtView",setup(i){pdfExports.GlobalWorkerOptions.workerSrc="https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.worker.min.js";const t=useRouter(),e=useConsultaStore(),s=useGeoCandidateTrees(),n=e.specie.code_specie;e.specie.vernacularName;const r=ref([]),a=ref("protocol"),o=A=>{a.value=A},{vernacularName:l,scientificName:c}=e.specie;(()=>{window.scrollTo(0,0)})();const m=ref([]),_=ref(null);let y;const b=ref(0),u=computed(()=>m.value.length);computed(()=>b.value===0),computed(()=>b.value===u.value-1),computed(()=>b.value===0);const g=ref(!1),x=async A=>{if(!A||A==="/img/sin_img.png"){console.log("URL del PDF no proporcionada o vacía. No se procesará nada.");return}try{const h=await pdfExports.getDocument(A).promise,d=h.numPages,f=[];for(let v=1;v<=d;v++)f.push(h.getPage(v).then(async w=>{const C=w.getViewport({scale:1}),k=document.createElement("canvas"),R=k.getContext("2d");return k.height=C.height,k.width=C.width,await w.render({canvasContext:R,viewport:C}).promise,k.toDataURL("image/png")}));m.value=await Promise.all(f),console.log("Imágenes cargadas:",m.value.length)}catch(h){console.error("Error al convertir PDF a imágenes:",h)}},P=()=>{try{y=new pageFlip_browserExports.PageFlip(_.value,{width:pageWidth,height:pageHeight,size:"fixed",minWidth:pageWidth,maxWidth:pageWidth,minHeight:pageHeight,maxHeight:pageHeight,maxShadowOpacity:.5,showCover:!0,mobileScrollSupport:!1}),y.loadFromHTML(document.querySelectorAll(".page")),y.on("flip",A=>{b.value=A.data}),g.value=!0}catch{console.log("no se puedo crear el flipbook"),g.value=!1}};return onMounted(async()=>{if(!e.specie.code_specie){t.push({name:"especies"});return}const A=getFullImageUrl(e.specie.images[0].protocol);await x(A),P(),s.validateUrl([getFullImageUrl(e.specie.images[0].img_general),getFullImageUrl(e.specie.images[0].img_landscape_one),getFullImageUrl(e.specie.images[0].img_landscape_two),getFullImageUrl(e.specie.images[0].img_landscape_three),getFullImageUrl(e.specie.images[0].img_leafs),getFullImageUrl(e.specie.images[0].img_flowers),getFullImageUrl(e.specie.images[0].img_fruits)]),await s.fetchData(n),r.value=s.geoDataNew}),(A,h)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:"sought",style:normalizeStyle({backgroundImage:"url("+unref(getFullImageUrl)(unref(e).specie.images[0].img_leafs)+")"})},[_hoisted_1,createBaseVNode("div",_hoisted_2,[withDirectives(createBaseVNode("div",{class:normalizeClass(["flipbook",{show__content:a.value==="protocol"}])},[m.value.length===0?(openBlock(),createBlock(LoadingData,{key:0,color:"white"})):createCommentVNode("",!0),createBaseVNode("div",{id:"book",class:normalizeClass(["book",{"cover-view":b.value===0}]),ref_key:"bookRef",ref:_},[(openBlock(!0),createElementBlock(Fragment,null,renderList(m.value,(d,f)=>(openBlock(),createElementBlock("div",{key:f,class:"page"},[createBaseVNode("img",{src:d,alt:`Page ${f+1}`},null,8,_hoisted_3)]))),128))],2)],2),[[vShow,g.value]]),createBaseVNode("div",{class:normalizeClass(["map",{show__content:a.value==="map"}])},[r.value.length<=0?(openBlock(),createBlock(LoadingData,{key:0,color:"white"})):createCommentVNode("",!0),r.value.length>0?(openBlock(),createBlock(RenderGeo,{key:1,filteredData:r.value},null,8,["filteredData"])):createCommentVNode("",!0)],2),createBaseVNode("div",{class:normalizeClass(["gallery",{show__content:a.value==="gallery"}])},[unref(s).validImages.length<=0?(openBlock(),createBlock(LoadingData,{key:0,color:"white"})):createCommentVNode("",!0),unref(s).validImages.length>0?(openBlock(),createBlock(ImageSlider,{key:1,class:"slider"})):createCommentVNode("",!0)],2)]),createBaseVNode("div",_hoisted_4,[createBaseVNode("ul",null,[createBaseVNode("li",{onClick:h[0]||(h[0]=d=>o("protocol")),class:normalizeClass({border__nav:a.value==="protocol"})},"Protocolo",2),createBaseVNode("li",{onClick:h[1]||(h[1]=d=>o("map")),class:normalizeClass({border__nav:a.value==="map"})},"Mapa",2),createBaseVNode("li",{onClick:h[2]||(h[2]=d=>o("gallery")),class:normalizeClass({border__nav:a.value==="gallery"})},"Galería",2)])])],4),createBaseVNode("div",null,[createVNode(QuoteButton),createVNode(PagesQueries,{scientificName:unref(c),vernacularName:unref(l)},null,8,["scientificName","vernacularName"])])],64))}},specieSoughtView=_export_sfc(_sfc_main,[["__scopeId","data-v-db6f83a8"]]);export{specieSoughtView as default};
