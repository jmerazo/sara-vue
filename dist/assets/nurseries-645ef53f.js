import{B as z,r,o as G,C as n,E as H,h as S}from"./index-58a73ee5.js";import{u as J}from"./modal-07ceaae3.js";const l=J(),R=z("nurseriesDashboard",()=>{const a=r([]),o=r([]),d=r([]),v=r([]),y=r([]),C=r([]),N=r([]),p=r("");r([]);const L=r(0),f=r([]),g=r(!1),h=r(""),m=r(""),x=r(""),u=r(1),c=r(12);G(async()=>{g.value=!0;const{data:e}=await n.listNurseriesAdmin();a.value=e,o.value=e,L.value=o.value.length,A(),g.value=!1});const A=async()=>{const{data:e}=await n.listNurseries();d.value=e,v.value=e},P=async e=>{try{a.value=e}catch(s){console.log(s)}};function M(){a.value.forEach(e=>{f.value.push(e)})}H(()=>a.value,()=>{f.value=[],M()},{deep:!0});const _=e=>{h.value=e,l.handleClickModalNurseryAdd()},E=e=>{m.value=e,l.handleClickModalNurseryAssignSpecie()},I=e=>{const s=v.value.filter(t=>t.vivero_id===e);y.value=s[0]||[],l.handleClickModalNurserySpecieList()},D=e=>{p.value=e,N.value=o.value.filter(s=>s.id===e),l.handleClickModalNurseryUpdate()},T=async e=>{try{const s=await n.createNurseries(e);s.status===201?(a.value.push(s.data),console.log("Nursery data: ",a.value)):console.error("Error al agregar el vivero: ",s.statusText)}catch(s){console.error("Error al comunicarse con el servidor: ",s)}},U=async(e,s)=>{const t=a.value.findIndex(i=>i.id===e);t!==-1?(Object.assign(a.value[t],s),await n.updateNurseries(e,s)):console.error(`Vivero con ID ${e} no encontrado.`)},b=async e=>{try{const s=await n.createNurseriesAssign(e);s.status===201?a.value.push(s.data):console.error("Error al asignar la especie al vivero: ",s.statusText)}catch(s){console.error("Error al comunicarse con el servidor: ",s)}};async function k(e){const s=a.value.findIndex(t=>t.id===e);return s===-1?{message:"Vivero no encontrado"}:(a.value.splice(s,1),await n.deleteNurseries(e),{message:"Vivero eliminado con Ã©xito"})}const w=S(()=>Math.ceil(a.value.length/c.value)),F=S(()=>{const e=(u.value-1)*c.value,s=e+c.value;return a.value.slice(e,s)});function O(e){e>=1&&e<=w.value&&(u.value=e)}function V(){o.value&&(a.value=o.value)}function j(e){a.value=o.value.filter(s=>{const t=e.toLowerCase(),i=s.nombre_vivero?s.nombre_vivero.toLowerCase():"",B=s.nit?s.nit.toLowerCase():"",$=s.first_name?s.first_name.toLowerCase():"",q=s.last_name?s.last_name.toLowerCase():"";return i.includes(t)||B.includes(t)||$.includes(t)||q.includes(t)})}return{nurseries:a,nurseriesOriginal:o,getNursery:P,nursery:C,createNursery:T,changePage:O,removeFilterProperty:V,searchTerm:j,deleteNursery:k,selectedUserCreateNursery:_,userSelected:h,displayedNursery:F,totalPages:w,currentPage:u,itemsPerPage:c,selectedNurseryAssignSpecie:E,selectedNurseryAssign:m,AssignSpecieNursery:b,selectedNurserySpeciesList:I,nurseriesSpeciesList:y,nurseriesSpecies:d,selectedUpdateNursery:D,userUpdateSelected:x,updateNursery:U,nurserySelected:N,nurseryUpdateSelected:p}});export{R as u};
