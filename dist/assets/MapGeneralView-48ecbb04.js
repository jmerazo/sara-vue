import{_ as se,r as v,o as ae,E,v as ne,b as a,c as n,d as e,q as d,k as _,t as m,m as y,l as S,p as re,e as ie,h as fe,w as B,H as L,F as T,i as j}from"./index-58a73ee5.js";import{V as J,G as ve,a as W,S as C,b as q,F as K,P as Q,g as N,h as U,M as he,T as we,O as ye,f as be,I as D,t as X,c as Y,d as ee,e as oe,i as te}from"./icon_tree_palm_pink-32875086.js";import{u as le}from"./candidate-bb7863ad.js";import{u as Pe}from"./species-f69c1e72.js";import{l as Se}from"./locates-b3be1fc3.js";import"./modal-07ceaae3.js";const G=w=>(re("data-v-79f8772e"),w=w(),ie(),w),ke={class:"map-container"},Ce={key:0,class:"contenedor"},Ie={key:0,class:"map__datos"},Fe={class:"dato"},Ge={class:"map__datos"},Ve={class:"dato"},$e={class:"map__datos"},Me={class:"dato"},xe={key:1,class:"map__datos"},Be={class:"dato"},Le={class:"map__datos"},Ne={class:"dato"},De={key:2,class:"map__datos"},Ee={class:"dato"},Ze={key:3,class:"map__datos"},ze={class:"dato"},Oe={key:4,class:"map__datos"},Re={class:"dato"},Te={key:5,class:"map__datos"},je={class:"dato"},qe={class:"legend"},Ke=G(()=>e("h4",null,"Leyenda",-1)),Ue={class:"legend-item"},Ae=["src"],He=G(()=>e("span",null,"Árbol - Corpoamazonia",-1)),Je={class:"legend-item"},We=["src"],Qe=G(()=>e("span",null,"Palma - Corpoamazonia",-1)),Xe={class:"legend-item"},Ye=["src"],eo=G(()=>e("span",null,"Árbol - GBIF (Global Biodiversity Information Facility)",-1)),oo={class:"legend-item"},to=["src"],so=G(()=>e("span",null,"Palma - GBIF (Global Biodiversity Information Facility)",-1)),ao={__name:"RenderGeoMap",setup(w,{expose:V}){const c=le(),$=v(null),f=v(null),s=v(null),p=v("");let t=null,g=8.4;const Z=new J({url:"/geojson/export.geojson",format:new ve}),z=new W({source:Z,style:new C({stroke:new q({color:"green",width:2}),fill:new K({color:"rgba(0, 0, 255, 0.1)"})})}),u=new J({features:[]});function M(){u.clear();const r=c.coordinatesPolygon;O(r)}V({onlyPerimeter:M});function O(r){if(r&&r.length>0){const o=r.map(R=>N(R)),i=new te([o]),k=new U({geometry:i});k.setStyle(new C({stroke:new q({color:"green",width:2}),fill:new K({color:"rgba(0, 255, 0, 0.1)"})})),u.addFeature(k)}}ae(()=>{F()}),E(()=>c.geoDataNew,()=>{b(),F()}),E(()=>p.value,()=>{F()});function F(){if(c.geoDataNew.length>0)if(t&&(t.setTarget(null),t=null),b(),p.value==="original"){c.calculatePerimeterCoordinates();const r=c.coordinatesPolygon;l(r,u)}else l([],u)}function b(){const r=c.geoDataNew.map(o=>{const i=new Q(N([o.lon,o.lat])),k=new U(i);return k.setProperties({codigo:o.codigo,nombre_comun:o.nombre_comun,nombre_cientifico:o.nombre_cientifico,numero_placa:o.numero_placa,coordenadas:o.coordenadas,departamento:o.departamento,municipio:o.municipio,vereda:o.vereda,nombre_del_predio:o.nombre_del_predio,resultado:o.resultado,habito:o.habito,source:o.source}),k});u.clear(),u.addFeatures(r)}function l(r,o){const i=[-75.5277,1.1961],k=[i[0]-.3,i[1]];t=new he({target:$.value,layers:[new we({source:new ye({opacity:.8})}),z],view:new be({center:N(k),zoom:g,minZoom:7.15,maxZoom:30})}),t.getViewport().style.cursor="pointer";const R=new C({image:new D({src:X,scale:.06,anchor:[.5,1]})}),ce=new C({image:new D({src:Y,scale:.06,anchor:[.5,1]})}),de=new C({image:new D({src:ee,scale:.06,anchor:[.5,1]})}),ue=new C({image:new D({src:oe,scale:.06,anchor:[.5,1]})}),_e=new W({source:o,style:function(I){const x=I.get("source"),P=I.get("habito");if(x==="original"){if(P==="Árbol")return R;if(P==="Palma")return ce}else if(x==="gbif"){if(P==="Árbol")return de;if(P==="Palma")return ue}}}),me=r.map(I=>N(I)),pe=new te([me]),A=new U({geometry:pe});A.setStyle(new C({stroke:new q({color:"green",width:2}),fill:new K({color:"rgba(0, 255, 0, 0.1)"})})),o.addFeature(A),t.addLayer(_e),t.on("pointermove",I=>{t.getView().setZoom(t.getView().getZoom());const x=t.getEventPixel(I.originalEvent),P=t.forEachFeatureAtPixel(x,ge=>ge);P&&P.getGeometry()instanceof Q?(t.getViewport().style.cursor="pointer",s.value=P,f.value&&(f.value.style.display="block")):(t.getViewport().style.cursor="",f.value&&(f.value.style.display="none"))}),window.addEventListener("resize",H);function H(){t&&t.getView()&&(window.innerWidth<768?t.getView().setZoom(5.5):t.getView().setZoom(g))}H()}return(r,o)=>{const i=ne("font-awesome-icon");return a(),n("div",ke,[e("div",{ref_key:"mapContainer",ref:$},null,512),e("div",{class:"info__map",ref_key:"infoContainer",ref:f},[s.value?(a(),n("div",Ce,[s.value.getProperties().source==="original"?(a(),n("p",Ie,[d(i,{icon:["fas","fingerprint"]}),_(" Código especie: "),e("span",Fe,m(s.value.getProperties().codigo),1)])):y("",!0),e("p",Ge,[d(i,{icon:["fab","glide"]}),_(" Nombre común: "),e("span",Ve,m(s.value.getProperties().nombre_comun),1)]),e("p",$e,[d(i,{icon:["fas","signature"]}),_(" Nombre científico: "),e("span",Me,m(s.value.getProperties().nombre_cientifico),1)]),s.value.getProperties().source==="original"?(a(),n("p",xe,[d(i,{icon:["fas","hashtag"]}),_(" Número de placa: "),e("span",Be,m(s.value.getProperties().numero_placa),1)])):y("",!0),e("p",Le,[d(i,{icon:["fas","location-crosshairs"]}),_(" Coordenadas: "),e("span",Ne,m(s.value.getProperties().coordenadas),1)]),s.value.getProperties().source==="original"?(a(),n("p",De,[d(i,{icon:["fab","squarespace"]}),_(" Departamento: "),e("span",Ee,m(s.value.getProperties().departamento),1)])):y("",!0),s.value.getProperties().source==="original"?(a(),n("p",Ze,[d(i,{icon:["fab","squarespace"]}),_(" Municipio: "),e("span",ze,m(s.value.getProperties().municipio),1)])):y("",!0),s.value.getProperties().source==="original"?(a(),n("p",Oe,[d(i,{icon:["fab","squarespace"]}),_(" Vereda: "),e("span",Re,m(s.value.getProperties().vereda),1)])):y("",!0),s.value.getProperties().source==="original"?(a(),n("p",Te,[d(i,{icon:["fas","star"]}),_(" Puntaje evaluación: "),e("span",je,m(s.value.getProperties().resultado),1)])):y("",!0)])):y("",!0)],512),e("div",qe,[Ke,e("div",Ue,[e("img",{src:S(X),alt:"Árbol Corpoamazonia",class:"legend-icon"},null,8,Ae),He]),e("div",Je,[e("img",{src:S(Y),alt:"Palma Corpoamazonia",class:"legend-icon"},null,8,We),Qe]),e("div",Xe,[e("img",{src:S(ee),alt:"Árbol GBIF",class:"legend-icon"},null,8,Ye),eo]),e("div",oo,[e("img",{src:S(oe),alt:"Palma GBIF",class:"legend-icon"},null,8,to),so])])])}}},no=se(ao,[["__scopeId","data-v-79f8772e"]]);const h=w=>(re("data-v-92192131"),w=w(),ie(),w),ro={class:"contenedor"},io=h(()=>e("h1",{class:"reporte__heading"}," Mapa general de especies forestales ",-1)),lo=h(()=>e("hr",null,null,-1)),co={class:"mapa__grid"},uo={class:"mapaOpciones"},_o={class:"menu"},mo=h(()=>e("legend",{class:"menu__titulo"},"Filtrar",-1)),po=h(()=>e("option",{value:"",disabled:""}," Seleccione una fuente de datos... ",-1)),go=h(()=>e("option",{value:"gbif"},"GBIF",-1)),fo=h(()=>e("option",{value:"original"},"Proyecto Semillas",-1)),vo=[po,go,fo],ho=h(()=>e("option",{value:{code:"",name:""},disabled:""}," Seleccione un departamento... ",-1)),wo=["value"],yo={key:1},bo=h(()=>e("option",{value:"",disabled:"",selected:""}," Seleccione un municipio... ",-1)),Po=["value"],So=h(()=>e("option",{value:"",selected:"",disabled:""}," Seleccione una especie... ",-1)),ko=["value"],Co={class:"menu__botones"},Io={class:"menu"},Fo=h(()=>e("legend",{class:"menu__titulo"},"Opciones",-1)),Go={class:"menu__botones"},Vo={class:"mapa"},$o={__name:"MapGeneralView",setup(w){const V=Se(),c=le(),$=Pe(),f=v(null),s=v(""),p=v({code:"",name:""}),t=v(""),g=v(""),Z=v("");ae(async()=>{await c.fetchData()}),E(()=>g.value,b=>{Z.value=b,u()}),E(g,b=>{b==="gbif"&&(p.value={code:"",name:""},t.value="")});function z(){f.value&&f.value.onlyPerimeter&&f.value.onlyPerimeter()}const u=()=>{c.filterGeo(p.value.name,t.value,s.value,g.value),c.calculatePerimeterCoordinates(p.value.name,t.value,s.value)},M=fe(()=>p.value.code?V.cities.filter(l=>l.department===p.value.code):[]);function O(){s.value="",p.value={code:"",name:""},t.value=""}function F(){g.value="",O(),c.deleteFilterGeo()}return(b,l)=>{const r=ne("font-awesome-icon");return a(),n("div",ro,[io,lo,e("div",co,[e("div",uo,[e("fieldset",_o,[mo,B(e("select",{class:"filtro__select",id:"dataSource","onUpdate:modelValue":l[0]||(l[0]=o=>g.value=o),onChange:u},vo,544),[[L,g.value]]),g.value!=="gbif"?B((a(),n("select",{key:0,class:"filtro__select",id:"department","onUpdate:modelValue":l[1]||(l[1]=o=>p.value=o),onChange:u},[ho,(a(!0),n(T,null,j(S(V).departments,o=>(a(),n("option",{key:o.id,value:{code:o.code,name:o.name}},m(o.name),9,wo))),128))],544)),[[L,p.value]]):y("",!0),M.value.length>0&&g.value!=="gbif"?(a(),n("div",yo,[B(e("select",{class:"filtro__select",id:"city","onUpdate:modelValue":l[2]||(l[2]=o=>t.value=o),onChange:u},[bo,(a(!0),n(T,null,j(M.value,o=>(a(),n("option",{key:o.id,value:o.name},m(o.name),9,Po))),128))],544),[[L,t.value]])])):y("",!0),B(e("select",{id:"especie",class:"filtro__select",onChange:u,"onUpdate:modelValue":l[3]||(l[3]=o=>s.value=o)},[So,(a(!0),n(T,null,j(S($).uniqueNomComunes,o=>(a(),n("option",{key:o.cod_especie,value:o.cod_especie},m(o.vernacularName+" | "+o.nombre_cientifico),9,ko))),128))],544),[[L,s.value]]),e("div",Co,[e("button",{type:"submit",class:"filtro__boton",onClick:F},[d(r,{icon:["fas","filter-circle-xmark"],class:"mr-2"}),_(" Eliminar filtro ")])])]),e("fieldset",Io,[Fo,e("div",Go,[e("button",{type:"submit",class:"menu__boton",onClick:l[4]||(l[4]=o=>S(c).exportToKML(S(c).coordinatesKML))},[d(r,{icon:["fas","arrows-to-eye"],class:"mr-2"}),_(" Exportar KML/KMZ ")]),e("button",{type:"submit",class:"menu__boton",onClick:z},[d(r,{icon:["fas","draw-polygon"],class:"mr-2"}),_(" Ver Perímetro ")])])])]),e("div",Vo,[d(no,{ref_key:"renderGeoMapRef",ref:f},null,512)])])])}}},Eo=se($o,[["__scopeId","data-v-92192131"]]);export{Eo as default};
