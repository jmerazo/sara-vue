import{B as O,r as c,h as f,o as U,C as i,E as j}from"./index-58a73ee5.js";import{u as k}from"./modal-07ceaae3.js";const R=O("especies",()=>{const m=k(),l=c(!1),o=c([]),S=c([]),u=c([]),v=c([]),y=f(()=>o.value.length===0),t=c([]),h=c([]),w=c([]),n=c(1),r=c(12);U(async()=>{l.value=!0;const{data:e}=await i.getSpecies();o.value=e,t.value=e;const a=[...new Map(e.map(s=>[s.vernacularName,s])).values()];h.value=a.map(s=>({vernacularName:s.vernacularName,nombre_cientifico:s.nombre_cientifico,code_specie:s.code_specie})),l.value=!1});function E(){o.value.forEach(e=>{v.value.push(e)})}j(()=>o.value,()=>{v.value=[],E()},{deep:!0});const d=f(()=>Math.ceil(o.value.length/r.value)),F=f(()=>{const e=(n.value-1)*r.value,a=e+r.value;return o.value.slice(e,a)});function g(e){e>=1&&e<=d.value&&(n.value=e,window.scrollTo({top:0,behavior:"smooth"}))}function b(){n.value=1,window.scrollTo({top:0,behavior:"smooth"})}function I(){n.value=d.value,window.scrollTo({top:0,behavior:"smooth"})}function T(e){S.value=t.value.filter(a=>a.code_specie===e),m.handleClickModalSpecie()}function C(){t.value&&(o.value=t.value)}function P(e){g(1),o.value=t.value.filter(a=>{const s=e.toLowerCase(),p=a.vernacularName?a.vernacularName.toLowerCase():"",M=a.nombre_cientifico?a.nombre_cientifico.toLowerCase():"",q=a.family?a.family.toLowerCase():"";return p.includes(s)||q.includes(s)||M.includes(s)})}async function x(e){const a=o.value.findIndex(s=>s.ShortcutID===e);return a===-1?{message:"Especie no encontrada"}:(o.value.splice(a,1),await i.deleteSpecies(e),{message:"Especie eliminada con Ã©xito"})}function N(e){u.value=o.value.filter(a=>a.ShortcutID===e),m.handleClickModalForestSpecieUpdate(u.value)}const _=async(e,a)=>{const s=o.value.findIndex(p=>p.ShortcutID===e);s!==-1?(Object.assign(o.value[s],a),await i.updateForestSpecies(e,a)):console.error(`Especie con ID ${e} no encontrada.`)},D=async e=>{try{const a=await i.addForestSpecies(e);a.status===200?o.value.push(e):console.error("Error al agregar la especie: ",a.statusText)}catch(a){console.error("Error al comunicarse con el servidor: ",a)}};async function L(){const e=await i.getSisa();w.value=e.data}return{cargando:l,currentPage:n,itemsPerPage:r,totalPages:d,displayedEspecies:F,species:o,specie:S,noResultados:y,speciesOriginals:t,uniqueNomComunes:h,specieSelected:u,datosImport:v,selectSpecie:T,buscarTermino:P,quitarFiltroEspecie:C,changePage:g,deleteForestSpecie:x,selectedForestSpecieUpdate:N,updateForestSpecie:_,addForestSpecie:D,loadSpeciesSisa:L,sisaList:w,goToFirstPage:b,goToLastPage:I}});export{R as u};
